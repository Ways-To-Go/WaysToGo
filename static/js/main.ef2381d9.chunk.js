(this.webpackJsonpwaystogo=this.webpackJsonpwaystogo||[]).push([[0],{14:function(e,t,a){},22:function(e,t,a){e.exports=a(30)},27:function(e,t,a){},30:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(12),i=a.n(s),o=(a(27),a(4)),l=a(5),c=a(7),p=a(6),u=(a(14),a(10)),h=a(32),d=a(33),m=a(31),g=a(34),f=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"topnav"},0===this.props.active?r.a.createElement("a",{className:"active",href:"/WaysToGo/?token="+this.props.token},"WaysToGo"):r.a.createElement("a",{href:"/WaysToGo/?token="+this.props.token},"WaysToGo"),1===this.props.active?r.a.createElement("a",{className:"active",href:"?show=save&token="+this.props.token},"New trip"):r.a.createElement("a",{href:"?show=save&token="+this.props.token},"New trip"),2===this.props.active?r.a.createElement("a",{className:"active",href:"#contact",style:{backgroundColor:"red"}},"Contact"):r.a.createElement("a",{style:{backgroundColor:"red"},href:"#contact"},"Contact"),3===this.props.active?r.a.createElement("a",{className:"active",href:"#about",style:{backgroundColor:"red"}},"About"):r.a.createElement("a",{style:{backgroundColor:"red"},href:"#about"},"About"))}}]),a}(n.Component),v=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={param:e.param},n.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],n}return Object(l.a)(a,[{key:"getStageNumber",value:function(e){return e.length}},{key:"getDateDebut",value:function(e){if(e.length>0){var t=new Date(e[0].departure);return this.monthNames[t.getMonth()]}return null}},{key:"getDateFin",value:function(e){if(e.length>0){var t=new Date(e[e.length-1].arrival);return this.monthNames[t.getMonth()]}return 0}},{key:"getDureeVoyage1",value:function(e){if(e.length>0){var t=new Date(e[e.length-1].arrival)-new Date(e[0].departure);return Math.ceil(t/864e5)+1}return 0}},{key:"getDureeVoyage2",value:function(e,t){var a=new Date(t)-new Date(e);return Math.ceil(a/864e5)+1}},{key:"getMonthsDate1",value:function(e){if(e.length>0){var t=this.getDateDebut(e);return t!==this.getDateFin(e)?this.getDateDebut(e)+" - "+this.getDateFin(e):t}return""}},{key:"getMonthsDate2",value:function(e,t){var a=new Date(e),n=new Date(t);return a.getMonth()!==n.getMonth()?this.monthNames[a.getMonth()]+" - "+this.monthNames[n.getMonth()]:this.monthNames[a.getMonth()]}},{key:"render",value:function(){return r.a.createElement("div",{ref:this.state.param.refHead,id:"head"},r.a.createElement("h2",null,this.state.param.title),r.a.createElement("h5",null,this.state.param.startdate?"":this.getMonthsDate1(this.state.param.stages)),r.a.createElement("p",{class:"ladescription"},'"'+this.state.param.description+'"'),r.a.createElement("p",null,this.state.param.vegan?"Ce voyage est vegan":"Ce voyage est signal\xe9 comme non-vegan"),r.a.createElement("p",null,this.state.param.ecological?"Ce voyage est ecologique":"Ce voyage est signal\xe9 comme non-ecologique"),r.a.createElement("p",null,"auteur : ",this.state.param.author.firstName+" "+this.state.param.author.lastName),r.a.createElement("p",null,"Dur\xe9e du voyage : ",this.state.param.startdate?this.getDureeVoyage2(this.state.param.startdate,this.state.param.enddate):this.getDureeVoyage1(this.state.param.stages)," jours"),this.state.param.edit?r.a.createElement("div",null,r.a.createElement("label",{for:"files2",style:{border:"2px solid black"}},"Change cover image"),r.a.createElement("input",{id:"files2",style:{visibility:"hidden"},ref:this.state.param.refHead,type:"file",accept:"image/*",onChange:this.state.param.changeCover})):"")}}]),a}(n.Component),y=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{class:"etape"},r.a.createElement("p",{class:"nomEtape"},this.props.etape.description),r.a.createElement("p",{class:"villedate_etape"},this.props.etape.city+" \u2022 "+new Date(this.props.etape.arrival)),this.props.etape.photos.map((function(e,t){return r.a.createElement("div",null,r.a.createElement("img",{key:t,src:e.path,alt:e.title,height:"150",width:"200"}),r.a.createElement("p",{key:t},e.description))}))),this.props.etape.departureTransport?r.a.createElement("div",{class:"transition_etape"},r.a.createElement("p",{class:"transitionTexte"},"\u2022 Moyen de transport : ",this.props.etape.departureTransport.type)):"")}}]),a}(r.a.Component),b=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).loadDoc(Object(u.a)(n)),n.state={id:e.id,titre:null,toRender:r.a.createElement("h1",null,"Chargement en cours...")},n}return Object(l.a)(a,[{key:"loadDoc",value:function(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var t=JSON.parse(this.responseText);console.log("Voyage : "+t),e.setState({toRender:r.a.createElement("div",null,r.a.createElement(f,{token:e.props.token}),r.a.createElement("div",{id:"carteSide"},r.a.createElement(h.a,{id:"ShowVoyageMap",center:[40,3],zoom:1},r.a.createElement(d.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),t.stages.map((function(e){return r.a.createElement(m.a,{position:[e.lng,e.lat]},r.a.createElement(g.a,null,r.a.createElement("h1",null,e.description)))})))),r.a.createElement("div",{id:"information"},r.a.createElement(v,{param:t}),r.a.createElement("div",{id:"etapes"},console.log(t),t.stages.map((function(e){return r.a.createElement(y,{etape:e,photos:e.photos})})))))})}},t.open("GET","https://wtg.aymerik-diebold.fr/api/trips/"+e.props.id,!0),t.send()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",null,this.state.toRender))}}]),a}(n.Component),E=a(13),k=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={files:e.files,filesToShow:[]},n.handleChange=n.handleChange.bind(Object(u.a)(n)),n}return Object(l.a)(a,[{key:"handleChange",value:function(e){this.props.changeButtonState(!0),this.setState({filesToShow:[].concat(Object(E.a)(this.state.filesToShow),Object(E.a)(e.target.files))});var t=this,a=0,n=e.target.files;Object(E.a)(e.target.files).map((function(e){var r=new XMLHttpRequest,s=e;r.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=new XMLHttpRequest;e.onreadystatechange=function(){4===this.readyState&&201===this.status&&(console.log("Upload photo in API success"),t.props.addImgFile({image:s,idAPI:JSON.parse(this.responseText).id}),(a+=1)==n.length&&t.props.changeButtonState(!1))},e.open("POST","https://wtg.aymerik-diebold.fr/api/photos",!0),e.setRequestHeader("Authorization","Bearer "+t.props.token),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify({path:JSON.parse(this.responseText).data.link,isCover:!1}))}},r.open("POST","https://api.imgur.com/3/image",!0),r.setRequestHeader("Authorization","Client-ID 140f137c33f88ac");var i=new FormData;i.append("image",e),r.send(i)}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{ref:this.props.imgcontainer},this.state.filesToShow&&Object(E.a)(this.state.filesToShow).map((function(e){return r.a.createElement("img",{width:"200px",height:"200px",src:URL.createObjectURL(e),alt:"Image"})}))),r.a.createElement("input",{ref:this.props.refInput,type:"file",accept:"image/*",multiple:!0,onChange:this.handleChange}))}}]),a}(r.a.Component),w=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).researchRef=r.a.createRef(),n}return Object(l.a)(a,[{key:"hinter",value:function(e){if(this.props.getdataback(0,0),!(e.target.value.length<2)){var t=new XMLHttpRequest,a=this;t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=JSON.parse(this.responseText);a.researchRef.current.innerHTML="",e.forEach((function(e){var t=document.createElement("div");t.innerText=e.display_name,t.onclick=function(){a.props.refCity.current.value=this.innerText,a.props.getdataback(parseFloat(e.lat),parseFloat(e.lon)),a.researchRef.current.innerHTML=""},a.researchRef.current.appendChild(t)}))}},t.open("GET","https://nominatim.openstreetmap.org/?addressdetails=1&format=json&limit=3&q="+this.props.refCity.current.value,!0),t.send()}}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("input",{ref:this.props.refCity,type:"text",name:"lville",placeholder:"Place..",id:"name_input",onKeyPress:this.hinter.bind(this)}),r.a.createElement("div",{ref:this.researchRef,id:"huge_list"}))}}]),a}(r.a.Component),D=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).refLocation=r.a.createRef(),n.refName=r.a.createRef(),n.refDate=r.a.createRef(),n.refDescription=r.a.createRef(),n.refDateDepart=r.a.createRef(),n.refDepartureTransport=r.a.createRef(),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{class:"etapevoyage"},r.a.createElement("button",{type:"button",onClick:function(){return e.props.editStepLink(e.refName,e.refLocation,e.refDate,e.refDateDepart,e.refDepartureTransport,e.refDescription)}},"Edit step"),r.a.createElement("br",null),r.a.createElement("label",null,"Location : "),r.a.createElement("label",{ref:this.refLocation},this.props.arguments.location),r.a.createElement("br",null),r.a.createElement("label",null,"Step name : "),r.a.createElement("label",{ref:this.refName},this.props.arguments.name),r.a.createElement("br",null),r.a.createElement("label",null,"Arrival date : "),r.a.createElement("label",{ref:this.refDate},this.props.arguments.date),r.a.createElement("br",null),r.a.createElement("label",null,"Departure date : "),r.a.createElement("label",{ref:this.refDateDepart},this.props.arguments.dateDepart),r.a.createElement("br",null),r.a.createElement("label",null,"Moyen de transport : "),r.a.createElement("label",{ref:this.refDepartureTransport},this.props.arguments.departureTransport),r.a.createElement("br",null),r.a.createElement("label",null,"Your story : "),r.a.createElement("label",{ref:this.refDescription},this.props.arguments.description),r.a.createElement("br",null),this.props.arguments.files&&Object(E.a)(this.props.arguments.files).map((function(e,t){return r.a.createElement("img",{key:t,width:"200px",height:"200px",src:URL.createObjectURL(e.image),alt:"Image"})})))}}]),a}(r.a.Component),O=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={name:e.name,description:e.description,vegan:e.vegan,ecolo:e.ecolo,voyageId:e.voyageId,editStepBool:!1,files:[]},n.setTextInputRef=r.a.createRef(),n.inputphotoToReset=r.a.createRef(),n.imgcontainer=r.a.createRef(),n.toggleModal=n.toggleModal.bind(Object(u.a)(n)),n.getLatLnt=n.getLatLnt.bind(Object(u.a)(n)),n.editStep=n.editStep.bind(Object(u.a)(n)),n.changeEnteteBackground=n.changeEnteteBackground.bind(Object(u.a)(n)),n.newCity=r.a.createRef(),n.newName=r.a.createRef(),n.newDate=r.a.createRef(),n.newDateDepart=r.a.createRef(),n.newDepartureTransport=r.a.createRef(),n.newDescription=r.a.createRef(),n.newLat=r.a.createRef(),n.newLnt=r.a.createRef(),n.boutonOK=r.a.createRef(),n.refHead=r.a.createRef(),n}return Object(l.a)(a,[{key:"editStep",value:function(e,t,a,n,r,s){this.newDescription.current.value=this.state.stepDescription,this.newName.current.value=this.state.stepName,this.newDate.current.value=this.state.stepDate,this.newDateDepart.current.value=this.state.stepDateDepart,this.newDepartureTransport.current.value=this.state.stepDepartureTransport,this.newCity.current.value=this.state.stepCity,this.setState({editStepBool:!0,refLocation:t,stepDate:a,stepDateDepart:n,stepDepartureTransport:r,refDescription:s,refName:e}),document.querySelector(".modal").classList.toggle("show-modal")}},{key:"addEtapeVoyage",value:function(){var e=new XMLHttpRequest,t=this;e.onreadystatechange=function(){var e=this.responseText;if(4===this.readyState&&201===this.status){0==t.state.editStepBool?i.a.render(r.a.createElement(D,{arguments:{location:t.newCity.current.value,files:t.state.files,description:t.newDescription.current.value,date:t.newDate.current.value,dateDepart:t.newDateDepart.current.value,departureTransport:t.newDepartureTransport.current.value,name:t.newName.current.value},editStepLink:t.editStep}),t.setTextInputRef.current.appendChild(document.createElement("div"))):(t.state.refLocation.current.textContent=t.newCity.current.value,t.state.refDate.current.textContent=t.newDate.current.value,t.state.refDateDepart.current.textContent=t.newDateDepart.current.value,t.state.refDepartureTransport.current.textContent=t.newDepartureTransport.current.value,t.state.refDescription.current.textContent=t.newDescription.current.value,t.state.refName.current.textContent=t.newName.current.value);var a=new XMLHttpRequest;a.onreadystatechange=function(){4===this.readyState&&201===this.status&&(t.state.editStepBool=!1,t.toggleModal())},a.open("POST","https://wtg.aymerik-diebold.fr/api/transports",!0),a.setRequestHeader("Authorization","Bearer "+t.props.token),a.setRequestHeader("Content-Type","application/json"),a.send(JSON.stringify({stageFrom:"/api/stages/"+JSON.parse(e).id,type:t.newDepartureTransport.current.value,distance:0}))}},this.setState({stepDescription:this.newDescription.current.value,stepName:this.newName.current.value,stepDate:this.newDate.current.value,stepDateDepart:this.newDateDepart.current.value,stepDepartureTransport:this.newDepartureTransport.current.value,stepId:this.state.voyageId,stepLat:this.state.newLat,stepLnt:this.state.newLnt,stepCity:this.newCity.current.value,stepFiles:this.state.files});var a=[];this.state.files.forEach((function(e){a.push("/api/photos/"+e.idAPI)})),e.open("POST","https://wtg.aymerik-diebold.fr/api/stages",!0),e.setRequestHeader("Authorization","Bearer "+this.props.token),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify({city:this.newCity.current.value,country:"rien",mark:0,description:this.newDescription.current.value,arrival:this.newDate.current.value,departure:this.newDateDepart.current.value,trip:"/api/trips/"+this.state.voyageId,lng:this.state.newLat,lat:this.state.newLnt,title:this.newName.current.value,photos:a}))}},{key:"toggleModal",value:function(){document.querySelector(".modal").classList.toggle("show-modal"),this.newDescription.current.value="",this.newName.current.value="",this.newDate.current.value="",this.newDateDepart.current.value="",this.newDepartureTransport.current.value="",this.newCity.current.value="",this.inputphotoToReset.current.value="",this.imgcontainer.current.textContent="",this.setState({files:[]})}},{key:"changeButtonState",value:function(e){this.boutonOK.current.disabled=e,this.boutonOK.current.textContent=1==e?"Image upload in progress...":"Add step"}},{key:"getLatLnt",value:function(e,t){this.setState({newLnt:t,newLat:e})}},{key:"changeEnteteBackground",value:function(e){this.refHead.current.style.backgroundImage="linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('"+URL.createObjectURL(e.target.files[0])+"')"}},{key:"addImgFile",value:function(e){this.setState({files:this.state.files.concat(e)})}},{key:"render",value:function(){return r.a.createElement("div",{id:"information"},r.a.createElement(v,{param:{changeCover:this.changeEnteteBackground,edit:!0,refHead:this.refHead,title:this.state.name,description:this.state.description,vegan:this.state.vegan,ecolo:this.state.ecolo,stages:[],author:{firstName:"Nicolas",lastName:"Dupond"}}}),r.a.createElement("div",{ref:this.setTextInputRef}),r.a.createElement("div",{class:"modal"},r.a.createElement("div",{class:"modal-content"},r.a.createElement("span",{class:"close-button",onClick:this.toggleModal},"\xd7"),r.a.createElement("label",{for:"lville"},"Location"),r.a.createElement(w,{refCity:this.newCity,getdataback:this.getLatLnt,newLat:this.newLat,newLnt:this.newLnt}),r.a.createElement("label",{for:"nometape"},"Step name"),r.a.createElement("input",{ref:this.newName,type:"text",id:"nometape",name:"nometape",placeholder:"ex. Promenade dans Paris"}),r.a.createElement("label",{for:"larrivee"},"Arrival date"),r.a.createElement("input",{ref:this.newDate,type:"text",id:"larrivee",name:"larrivee",placeholder:"Arriv\xe9e.."}),r.a.createElement("label",{for:"ldepart"},"Departure date"),r.a.createElement("input",{ref:this.newDateDepart,type:"text",id:"ldepart",name:"ldepart",placeholder:"Arriv\xe9e.."}),r.a.createElement("label",{for:"ltransport"},"Moyen de transport entre \xe9tapes"),r.a.createElement("input",{ref:this.newDepartureTransport,type:"text",id:"ltransport",name:"ltransport",placeholder:"Moyen transport.."}),r.a.createElement("label",{for:"ldescription"},"Your story"),r.a.createElement("textarea",{ref:this.newDescription,id:"ldescription",name:"ldescription",placeholder:"Ce que vous voulez..."}),r.a.createElement(k,{token:this.props.token,addImgFile:this.addImgFile.bind(this),files:this.state.files,changeButtonState:this.changeButtonState.bind(this),imgcontainer:this.imgcontainer,refInput:this.inputphotoToReset}),r.a.createElement("button",{type:"button",ref:this.boutonOK,onClick:this.addEtapeVoyage.bind(this)},"Add step"))),r.a.createElement("button",{class:"trigger",onClick:this.toggleModal},"Add a step"))}}]),a}(r.a.Component),j=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{class:"modal_chargement"},r.a.createElement("div",{class:"modal-content"},r.a.createElement("p",null,"Chargement")))}}]),a}(r.a.Component),C=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).description=r.a.createRef(),n.name=r.a.createRef(),n.vegan=r.a.createRef(),n.ecolo=r.a.createRef(),n}return Object(l.a)(a,[{key:"addVoyageCheck",value:function(){this.description.current.validity.valid&&this.name.current.validity.valid?this.props.addMyVoyage(this.name.current.value,this.description.current.value,this.vegan.current.checked,this.ecolo.current.checked):alert("Please complete the Details section")}},{key:"render",value:function(){return r.a.createElement("div",{className:"formulaire"},r.a.createElement("h3",null,"New trip"),r.a.createElement("div",{className:"partie"},r.a.createElement("h4",null,"D\xe9tails"),r.a.createElement("div",{className:"partiedetails"},r.a.createElement("p",{className:"partieLabel"},"Trip name:"),r.a.createElement("input",{required:!0,type:"text",ref:this.name,id:"fname",name:"firstname",placeholder:"ex. A grand tour of France"}),r.a.createElement("p",{className:"partieLabel"},"Trip summary:"),r.a.createElement("textarea",{required:!0,ref:this.description,id:"lname",name:"lastname",placeholder:"ex. A bucolic journey through the French countryside: old relics and local specialities"}))),r.a.createElement("div",{className:"partie"},r.a.createElement("h4",null,"Parameters"),r.a.createElement("div",{className:"partiedetails"},r.a.createElement("div",null,r.a.createElement("input",{ref:this.vegan,type:"checkbox",id:"voyagevegan",name:"voyagevegan",value:"newsletter"}),r.a.createElement("label",{htmlFor:"voyagevegan"},"Is this trip vegan?")),r.a.createElement("div",null,r.a.createElement("input",{ref:this.ecolo,type:"checkbox",id:"voyageecolo",name:"voyageecolo",value:"newsletter"}),r.a.createElement("label",{htmlFor:"voyageecolo"},"Is this trip environmentally friendly?")))),r.a.createElement("button",{type:"button",className:"boutonsend",onClick:this.addVoyageCheck.bind(this)},"Add my trip"))}}]),a}(r.a.Component),S=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={token:e.token,startNewVoyage:!0,chargement:!1,name:"",description:"",vegan:!1,ecolo:!1},n.renouvelerToken=n.renouvelerToken.bind(Object(u.a)(n)),n.addMyVoyage=n.addMyVoyage.bind(Object(u.a)(n)),n}return Object(l.a)(a,[{key:"renouvelerToken",value:function(){var e=new XMLHttpRequest,t=this;e.onreadystatechange=function(){4===this.readyState&&200===this.status&&(t.state.token=JSON.parse(this.responseText).token,t.props.updateToken(t.state.token),t.addMyVoyage(t.state.name,t.state.description,t.state.vegan,t.state.ecolo))},e.open("POST","http://wtg.aymerik-diebold.fr/login_check",!0),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify({username:"mailleon@gmail.com",password:"monmdp111A!"}))}},{key:"addMyVoyage",value:function(e,t,a,n){this.setState({name:e,description:t,vegan:a,ecolo:n,chargement:!0});var r=new XMLHttpRequest,s=this;r.onreadystatechange=function(){if(4===this.readyState&&201===this.status){var e=JSON.parse(this.responseText);s.setState({chargement:!1,startNewVoyage:!1,voyageId:e.id})}else 4===this.readyState&&401===this.status&&(console.log("Token non valide, renouvellement..."),s.renouvelerToken())},r.open("POST","https://wtg.aymerik-diebold.fr/api/trips",!0),r.setRequestHeader("Authorization","Bearer "+s.state.token),r.setRequestHeader("Content-Type","application/json"),r.send(JSON.stringify({title:e,description:t,vegan:a,ecological:n,author:"api/users/10",keywords:"paris plage"}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(f,{active:1,token:this.props.token}),this.state.startNewVoyage?this.state.chargement?r.a.createElement(j,null):r.a.createElement(C,{token:this.state.token,addMyVoyage:this.addMyVoyage.bind(this)}):r.a.createElement(O,{token:this.state.token,voyageId:this.state.voyageId,name:this.state.name,vegan:this.state.vegan,ecolo:this.state.ecolo,description:this.state.description}))}}]),a}(n.Component),T=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={voyages:[],lat:48.856614,lng:2.3522219,zoom:2},n.loadTrips(Object(u.a)(n)),n}return Object(l.a)(a,[{key:"loadTrips",value:function(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4===this.readyState&&200===this.status&&(e.setState({voyages:JSON.parse(this.response)["hydra:member"]}),console.log(JSON.parse(this.response)))},t.open("GET","https://wtg.aymerik-diebold.fr/api/trips",!0),t.send()}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(f,{active:0,token:this.props.token}),r.a.createElement(h.a,{id:"principalMap",center:[this.state.lat,this.state.lng],zoom:this.state.zoom},r.a.createElement(d.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),this.state.voyages.map((function(e){return e.stages.map((function(t){return r.a.createElement(m.a,{position:[t.lng,t.lat]},r.a.createElement(g.a,null,r.a.createElement("h1",null,e.title),r.a.createElement("a",{href:"?show=trip&id="+e.id},"Cliquez")))}))}))))}}]),a}(n.Component),R=function(e){Object(c.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(o.a)(this,a),n=t.call(this,e);var r=new URLSearchParams(window.location.search);return n.state={pageActuelle:r.get("show"),trip:r.get("id"),token:r.get("token")},n}return Object(l.a)(a,[{key:"setToken",value:function(e){console.log("update token with : "+e),this.setState({token:e})}},{key:"render",value:function(){return"trip"===this.state.pageActuelle?r.a.createElement(b,{token:this.state.token,id:this.state.trip}):"save"===this.state.pageActuelle?r.a.createElement(S,{token:this.state.token,updateToken:this.setToken.bind(this)}):r.a.createElement(T,{token:this.state.token})}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(R,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[22,1,2]]]);
//# sourceMappingURL=main.ef2381d9.chunk.js.map