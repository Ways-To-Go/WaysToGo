{"version":3,"sources":["NavigationBar.js","Upload.js","ResearchBarCity.js","editStep.js","addStep.js","ShowVoyage.js","AddVoyage.js","ShowCarte.js","Profile.js","SearchResult.js","About.js","Popup.js","Settings.js","App.js","serviceWorker.js","index.js"],"names":["NavigationBar","state","showLogin","showRegister","email","password","password2","firstname","lastname","registerSuccess","registerMessage","e","setState","onChange","target","name","value","onSubmitLogin","preventDefault","console","log","Axios","post","username","headers","then","res","props","connect","data","token","get","Authorization","Cookies","set","id","path","catch","err","onSubmitRegister","success","getStyleLogin","display","getStyleRegister","class","this","active","href","connected","onClick","style","type","placeholder","Component","Upload","files","filesToShow","handleChange","bind","Math","random","event","changeButtonState","parentUpload","totalEndUpload","images","map","file","xhttp","XMLHttpRequest","img","onreadystatechange","readyState","status","addImgFile","image","image_URL_BDD","JSON","parse","responseText","length","open","setRequestHeader","send","stringify","link","isCover","FormData","append","ref","imgcontainer","i","key","width","height","src","URL","createObjectURL","alt","uploadID","refInput","accept","multiple","for","React","ResearchBarCity","researchRef","createRef","getdataback","parentV","response","current","innerHTML","forEach","item","option","document","createElement","innerText","display_name","onclick","refCity","parseFloat","lat","lon","appendChild","onKeyPress","hinter","ButtonDeleteTrip","window","confirm","location","deleteTrip","EditStep","step","photos","departureTransport","editFunction","getLatLnt","newCity","newName","newDate","newDateDepart","newDepartureTransport","newDescription","newLat","newLnt","boutonOK","modal","refHead","inputphotoToReset","toggleModal","listformat","reload","push","parentVoyage","callback","city","description","arrival","departure","title","etape","closeModal","stageFrom","distance","country","mark","lng","lnt","etat","disabled","textContent","classList","toggle","stepKey","boutonDelete","deleteFunction","AddStep","addFunction","boutonOK2","imgcontainer2","transport","trip","tripId","alert","EnteteVoyage","param","saveTripButton","verifIfTripAlreadySaved","monthNames","etapes","d","Date","getMonth","ceil","date1","date2","getDateDebut","getDateFin","a","cname","ca","decodeURIComponent","cookie","split","c","charAt","substring","indexOf","superThis","visibility","recordedTrips","getCookie","xhttp2","index","splice","startdate","getMonthsDate1","stages","vegan","ecological","author","firstName","lastName","getDureeVoyage2","enddate","getDureeVoyage1","edit","border","changeCover","myTrip","saveTrip","EtapeVoyage","photo","editStepKey","toString","ShowVoyage","loadDoc","verifTripIsMine","trips","parseInt","Map","center","zoom","TileLayer","attribution","url","Marker","position","UneEtape","refLocation","refName","refDate","refDescription","refDateDepart","refDepartureTransport","editEtapeVoyage","parameters","arguments","date","dateDepart","CreationVoyageAjoutEtapes","ecolo","voyageId","allEtapes","setTextInputRef","changeEnteteBackground","addEtapeVoyage","backgroundImage","concat","CreationVoyage","validity","valid","addMyVoyage","checked","className","required","htmlFor","addVoyageCheck","AddVoyage","startNewVoyage","chargement","newname","newdescription","newvegan","newecolo","ShowCarte","voyages","loadTrips","parentThis","voyage","Profile","getUserInfo","getTrips","tripTitles","containerStyle","backgroundColor","boxStyle","color","textAlign","margin","justifyContent","SearchForm","keyword","chercher","ResultList","firstParam","lastNqme","SearchResult","startNewSearch","toRender","About","Popup","showPopup","getPopupStyle","zIndex","top","left","getInnerPopupStyle","borderRadius","padding","fontWeight","fontSize","componentDidMount","setTimeout","message","Settings","currentPassword","newPassword","newPassword2","showPersonal","showPrivacy","goPersonal","goPrivacy","onSubmit","patch","mainStyle","navStyle","navButton","info","listStyle","App","disconnect","remove","cookies","urlParams","URLSearchParams","search","pageActuelle","Boolean","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister","error"],"mappings":"kVAKqBA,E,4MACnBC,MAAQ,CACNC,WAAW,EACXC,cAAc,EACdC,MAAO,GACPC,SAAU,GACVC,UAAW,GACXC,UAAW,GACXC,SAAU,GACVC,gBAAiB,GACjBC,gBAAiB,I,EAGnBR,UAAY,SAACS,GACX,EAAKC,SAAS,CAAEV,WAAY,EAAKD,MAAMC,UAAWC,cAAc,K,EAGlEA,aAAe,SAACQ,GACd,EAAKC,SAAS,CAAET,cAAe,EAAKF,MAAME,aAAcD,WAAW,K,EAGrEW,SAAW,SAACF,GACV,EAAKC,SAAL,eAAiBD,EAAEG,OAAOC,KAAOJ,EAAEG,OAAOE,S,EAG5CC,cAAgB,SAACN,GACfA,EAAEO,iBACFC,QAAQC,IAAI,iBAKZC,IAAMC,KACJ,6CACA,CACEC,SAAU,EAAKtB,MAAMG,MACrBC,SAAU,EAAKJ,MAAMI,UAEvB,CAAEmB,QATY,CACd,eAAgB,sBAUfC,MAAK,SAACC,GACLP,QAAQC,IAAIM,GACZ,EAAKC,MAAMC,QAAQF,EAAIG,KAAKC,OAC5B,EAAKlB,SAAS,CAAEV,WAAW,IAE3BmB,IAAMU,IAAI,wCAAyC,CACjDP,QAAS,CAAEQ,cAAe,UAAYN,EAAIG,KAAKC,SAE9CL,MAAK,SAACC,GACLP,QAAQC,IAAIM,IACI,IAAIO,KACZC,IAAI,KAAMR,EAAIG,KAAKM,GAAI,CAAEC,KAAM,SAExCC,OAAM,SAACC,GAEN,MADAnB,QAAQC,IAAI,+BACNkB,QAGXD,OAAM,SAACC,GAKN,MAJAnB,QAAQC,IAAI,gBACZ,EAAKR,SAAS,CACZH,gBAAiB,4CAEb6B,M,EAIZC,iBAAmB,SAAC5B,GAClBA,EAAEO,iBACFC,QAAQC,IAAI,oBAKR,EAAKnB,MAAMI,WAAa,EAAKJ,MAAMK,UACrC,EAAKM,SAAS,CAAEF,gBAAiB,mCAEZ,KAArB,EAAKT,MAAMG,OACa,KAAxB,EAAKH,MAAMI,UACc,KAAzB,EAAKJ,MAAMK,UAEX,EAAKM,SAAS,CAAEF,gBAAiB,oCAEjCW,IAAMC,KACJ,0CACA,CACElB,MAAO,EAAKH,MAAMG,MAClBC,SAAU,EAAKJ,MAAMI,SACrBE,UAAW,EAAKN,MAAMM,UACtBC,SAAU,EAAKP,MAAMO,UAEvB,CAAEgB,QApBU,CACd,eAAgB,sBAqBbC,MAAK,SAACC,IACoB,IAArBA,EAAIG,KAAKW,SACXrB,QAAQC,IAAI,4BACZ,EAAKR,SAAS,CACZH,gBACE,oDACFL,MAAO,GACPC,SAAU,GACVC,UAAW,GACXC,UAAW,GACXC,SAAU,GACVL,cAAc,EACdD,WAAW,MAGbiB,QAAQC,IAAI,0BACZ,EAAKR,SAAS,CACZF,gBAAiB,iDAItB2B,OAAM,SAACC,GAEN,MADAnB,QAAQC,IAAI,SACNkB,M,EAKdG,cAAgB,WACd,MAAO,CACLC,QAAS,EAAKzC,MAAMC,UAAY,QAAU,S,EAI9CyC,iBAAmB,WACjB,MAAO,CACLD,QAAS,EAAKzC,MAAME,aAAe,QAAU,S,uDAK/C,OACE,yBAAKyC,MAAM,UACa,GAArBC,KAAKlB,MAAMmB,OACV,uBAAGF,MAAM,SAASG,KAAK,cAAvB,YAIA,uBAAGA,KAAK,cAAR,YASoB,GAArBF,KAAKlB,MAAMmB,OACV,uBAAGF,MAAM,SAASG,KAAK,eAAvB,SAIA,uBAAGA,KAAK,eAAR,SAEDF,KAAKlB,MAAMqB,UACV,uBAAGJ,MAA4B,GAArBC,KAAKlB,MAAMmB,OAAc,SAAW,GAAIC,KAAK,cAAvD,cAIA,+BAEDF,KAAKlB,MAAMqB,UACV,uBACEJ,MAA4B,GAArBC,KAAKlB,MAAMmB,OAAc,SAAW,GAC3CC,KAAK,iBAFP,WAOA,6BACE,uBAAGH,MAAM,aAAaK,QAASJ,KAAK3C,WAApC,SAIA,uBAAG0C,MAAM,aAAaK,QAASJ,KAAK1C,cAApC,aAKH0C,KAAKlB,MAAMqB,UACV,uBAAGD,KAAK,gBAAR,UAEA,+BAEoB,GAArBF,KAAKlB,MAAMmB,OACV,uBAAGF,MAAM,SAASG,KAAM,kBACrB,IADH,YAEY,KAGZ,uBAAGA,KAAM,kBAAT,aAEDF,KAAKlB,MAAMqB,UACV,uBACEJ,MAA4B,GAArBC,KAAKlB,MAAMmB,OAAc,SAAW,GAC3CC,KAAK,kBAFP,YAOA,+BAGF,yBAAKZ,GAAG,QAAQe,MAAOL,KAAKJ,iBAC1B,2BAAII,KAAK5C,MAAMQ,iBACf,oCACA,2BACE0C,KAAK,OACLpC,KAAK,QACLF,SAAUgC,KAAKhC,SACfG,MAAO6B,KAAK5C,MAAMG,MAClBgD,YAAY,sBAGd,uCACA,2BACED,KAAK,WACLpC,KAAK,WACLF,SAAUgC,KAAKhC,SACfG,MAAO6B,KAAK5C,MAAMI,WAGpB,2BACE8C,KAAK,SACLpC,KAAK,SACLC,MAAM,QACNiC,QAASJ,KAAK5B,iBAIlB,yBAAKkB,GAAG,WAAWe,MAAOL,KAAKF,oBAC7B,2BAAIE,KAAK5C,MAAMS,iBACf,oCACA,2BACEyC,KAAK,OACLpC,KAAK,QACLF,SAAUgC,KAAKhC,SACfG,MAAO6B,KAAK5C,MAAMG,MAClBgD,YAAY,0BAGd,wCACA,2BACED,KAAK,OACLpC,KAAK,YACLF,SAAUgC,KAAKhC,SACfG,MAAO6B,KAAK5C,MAAMM,UAClB6C,YAAY,aAGd,uCACA,2BACED,KAAK,OACLpC,KAAK,WACLF,SAAUgC,KAAKhC,SACfG,MAAO6B,KAAK5C,MAAMO,SAClB4C,YAAY,YAGd,uCACA,2BACED,KAAK,WACLpC,KAAK,WACLF,SAAUgC,KAAKhC,SACfG,MAAO6B,KAAK5C,MAAMI,WAGpB,+CACA,2BACE8C,KAAK,WACLpC,KAAK,YACLF,SAAUgC,KAAKhC,SACfG,MAAO6B,KAAK5C,MAAMK,YAGpB,2BACE6C,KAAK,SACLpC,KAAK,SACLC,MAAM,QACNiC,QAASJ,KAAKN,yB,GA1RiBc,a,QCDtBC,E,kDACpB,WAAY3B,GAAQ,IAAD,8BAClB,cAAMA,IACD1B,MAAQ,CACZsD,MAAO5B,EAAM4B,MACbC,YAAa,IAGd,EAAKC,aAAe,EAAKA,aAAaC,KAAlB,gBACpB,EAAKvB,GAAKwB,KAAKC,SARG,E,yDAYNC,GACZhB,KAAKlB,MAAMmC,mBAAkB,GAC7BjB,KAAKjC,SAAS,CACb4C,YAAY,GAAD,mBAAMX,KAAK5C,MAAMuD,aAAjB,YAAiCK,EAAM/C,OAAOyC,UAG1D,IAAIQ,EAAelB,KACfmB,EAAiB,EACjBC,EAASJ,EAAM/C,OAAOyC,MAC1B,YAAIM,EAAM/C,OAAOyC,OAAOW,KAAI,SAAUC,GAErC,IAAIC,EAAQ,IAAIC,eACZC,EAAMH,EACVC,EAAMG,mBAAqB,WAC1B,GAAwB,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,OAAgB,CAEjD,IAAIL,EAAQ,IAAIC,eAChBD,EAAMG,mBAAqB,WACF,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,SACjCtD,QAAQC,IAAI,iCAEZ2C,EAAapC,MAAM+C,WAAW,CAAEC,MAAOL,EAAKM,cAAe,eAAiBC,KAAKC,MAAMjC,KAAKkC,cAAc5C,MAC1G6B,GAAkB,IACIC,EAAOe,QAC5BjB,EAAapC,MAAMmC,mBAAkB,KAIxCM,EAAMa,KAAK,OAAQ,6CAA6C,GAChEb,EAAMc,iBAAiB,gBAAiB,UAAYnB,EAAapC,MAAMG,OACvEsC,EAAMc,iBAAiB,eAAgB,oBACvCd,EAAMe,KAAKN,KAAKO,UAAU,CACzBhD,KAAMyC,KAAKC,MAAMjC,KAAKkC,cAAclD,KAAKwD,KAEzCC,SAAS,OAKZlB,EAAMa,KAAK,OAAQ,iCAAiC,GACpDb,EAAMc,iBAAiB,gBAAiB,6BAExC,IAAIrD,EAAO,IAAI0D,SACf1D,EAAK2D,OAAO,QAASrB,GACrBC,EAAMe,KAAKtD,Q,+BAKZ,OACC,6BACC,yBAAK4D,IAAK5C,KAAKlB,MAAM+D,cAEnB7C,KAAK5C,MAAMuD,aAAe,YAAIX,KAAK5C,MAAMuD,aAAaU,KAAI,SAACC,EAAMwB,GAAP,OAC1D,yBAAKC,IAAKD,EAAGE,MAAM,QAAQC,OAAO,QAAQC,IAAKC,IAAIC,gBAAgB9B,GAAO+B,IAAI,cAGhF,2BAAO/D,GAAIU,KAAKlB,MAAMwE,SAAWtD,KAAKV,GAAIe,MAAO,CAAER,QAAS,QAAS+C,IAAK5C,KAAKlB,MAAMyE,SAAUjD,KAAK,OAAOkD,OAAO,UAAUC,UAAQ,EAACzF,SAAUgC,KAAKY,eACpJ,2BAAO8C,IAAK1D,KAAKlB,MAAMwE,SAAWtD,KAAKV,GAAIS,MAAM,sBAAjD,gC,GAvEgC4D,IAAMnD,WCArBoD,E,kDACpB,WAAY9E,GAAQ,IAAD,8BAClB,cAAMA,IAED+E,YAAcF,IAAMG,YAHP,E,mDAOZ9C,GAKN,GAHAhB,KAAKlB,MAAMiF,YAAY,EAAG,KAGtB/C,EAAM/C,OAAOE,MAAMgE,OAAS,GAAhC,CAGC,IAAIZ,EAAQ,IAAIC,eACZwC,EAAUhE,KAEduB,EAAMG,mBAAqB,WAC1B,GAAwB,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,OAAgB,CAGjD,IAAIqC,EAAWjC,KAAKC,MAAMjC,KAAKkC,cAG/B8B,EAAQH,YAAYK,QAAQC,UAAY,GAExCF,EAASG,SAAQ,SAAUC,GAC1B,IAAIC,EAASC,SAASC,cAAc,OAEpCF,EAAOG,UAAYJ,EAAKK,aAExBJ,EAAOK,QAAU,WAChBX,EAAQlF,MAAM8F,QAAQV,QAAQ/F,MAAQ6B,KAAKyE,UAC3CT,EAAQlF,MAAMiF,YAAYc,WAAWR,EAAKS,KAAMD,WAAWR,EAAKU,MAChEf,EAAQH,YAAYK,QAAQC,UAAY,IAIzCH,EAAQH,YAAYK,QAAQc,YAAYV,QAM3C/C,EAAMa,KAAK,MAAO,+EAAiFpC,KAAKlB,MAAM8F,QAAQV,QAAQ/F,OAAO,GACrIoD,EAAMe,U,+BAKP,OACC,6BACC,2BAAOM,IAAK5C,KAAKlB,MAAM8F,QAAStE,KAAK,OAAOpC,KAAK,SAASqC,YAAY,UAAUjB,GAAG,aAAa2F,WAAYjF,KAAKkF,OAAOrE,KAAKb,QAC7H,yBAAK4C,IAAK5C,KAAK6D,YAAavE,GAAG,mB,GAvDUqE,IAAMnD,WCKtC2E,EAAb,2KAGE,GAAgB,GADDC,OAAOC,QAAQ,YACR,CACrB,IAAI9D,EAAQ,IAAIC,eAChBD,EAAMG,mBAAqB,WAEF,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,SACjCwD,OAAOE,SAAW,2CAKpB/D,EAAMa,KAAK,SAAU,4CAA8CpC,KAAKlB,MAAMQ,IAAI,GAClFiC,EAAMc,iBAAiB,gBAAiB,UAAYrC,KAAKlB,MAAMG,OAC/DsC,EAAMc,iBAAiB,eAAgB,oBACvCd,EAAMe,UAhBT,+BAqBE,OACC,4BAAQhC,KAAK,SAASF,QAASJ,KAAKuF,WAAW1E,KAAKb,OAApD,mBAtBH,GAAsCQ,aA0PvBgF,E,kDA9Nd,WAAY1G,GAAQ,IAAD,8BAClB,cAAMA,IAED1B,MAAQ,CACZsD,MAAO,GAOPpB,GAAIR,EAAM2G,KAAKnG,GACfoG,OAAQ5G,EAAM2G,KAAKC,QAEhB5G,EAAM2G,KAAKE,oBAAwD,cAAlC7G,EAAM2G,KAAKE,qBAC/C,EAAKvI,MAAMuI,mBAAqB7G,EAAM2G,KAAKE,mBAAmBrF,MAE/D,EAAKsF,aAAe,EAAKA,aAAa/E,KAAlB,gBACpB,EAAKgF,UAAY,EAAKA,UAAUhF,KAAf,gBACjB,EAAKgB,WAAa,EAAKA,WAAWhB,KAAhB,gBAElB,EAAKiF,QAAUnC,IAAMG,YACrB,EAAKiC,QAAUpC,IAAMG,YACrB,EAAKkC,QAAUrC,IAAMG,YACrB,EAAKmC,cAAgBtC,IAAMG,YAC3B,EAAKoC,sBAAwBvC,IAAMG,YACnC,EAAKqC,eAAiBxC,IAAMG,YAE5B,EAAKsC,OAASzC,IAAMG,YACpB,EAAKuC,OAAS1C,IAAMG,YACpB,EAAKwC,SAAW3C,IAAMG,YACtB,EAAKyC,MAAQ5C,IAAMG,YAEnB,EAAK0C,QAAU7C,IAAMG,YAErB,EAAKjB,aAAec,IAAMG,YAC1B,EAAK2C,kBAAoB9C,IAAMG,YAE/B,EAAK4C,YAAc,EAAKA,YAAY7F,KAAjB,gBAtCD,E,2DA2ClB,IAAI8F,EAAa,GACb3G,KAAKlB,MAAM8H,OACmBD,EAA7B3G,KAAK5C,MAAMsD,MAAMyB,OAAS,EAAgBnC,KAAK5C,MAAMsD,MACvCV,KAAKlB,MAAM4G,OAEzB1F,KAAK5C,MAAMsD,MAAMyB,OAAS,EAC7BnC,KAAK5C,MAAMsD,MAAM0D,SAAQ,SAAUC,GAClCsC,EAAWE,KAAKxC,EAAKtC,kBAElB4E,EAAa3G,KAAKlB,MAAM4G,OAQ9B,IAAInE,EAAQ,IAAIC,eACZsF,EAAe9G,KACnBuB,EAAMG,mBAAqB,WAE1B,IAAI7C,EAAMmB,KAAKkC,aACf,GAAwB,IAApBlC,KAAK2B,YAAoC,MAAhB3B,KAAK4B,OAAgB,CAEjD,IAAIL,EAAQ,IAAIC,eAChBD,EAAMG,mBAAqB,WAEF,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,UAEjC/C,EAAMmD,KAAKC,MAAMpD,IACb8G,mBAAqB,CAAE,KAAQmB,EAAaZ,sBAAsBhC,QAAQ/F,OAG1E2I,EAAahI,MAAM8H,OAAQrC,SAASe,SAASsB,QAAO,GACnDE,EAAahI,MAAMiI,SAAS,CAChCC,KAAMF,EAAahB,QAAQ5B,QAAQ/F,MACnC8I,YAAaH,EAAaX,eAAejC,QAAQ/F,MACjD+I,QAASJ,EAAad,QAAQ9B,QAAQ/F,MACtCgJ,UAAWL,EAAab,cAAc/B,QAAQ/F,MAC9CiJ,MAAON,EAAaf,QAAQ7B,QAAQ/F,MACpCwH,mBAAoB,CAAE,KAAQmB,EAAaZ,sBAAsBhC,QAAQ/F,OACzEuH,OAAQoB,EAAa1J,MAAMsD,MAC3B2G,MAAOxI,IAGRiI,EAAaQ,eAKf/F,EAAMa,KAAK,QAAS,iCAAmCJ,KAAKC,MAAMpD,GAAK8G,oBAAoB,GAC3FpE,EAAMc,iBAAiB,gBAAiB,UAAYyE,EAAahI,MAAMG,OACvEsC,EAAMc,iBAAiB,eAAgB,gCACvCd,EAAMe,KAAKN,KAAKO,UAAU,CACzBgF,UAAW,eAAiBvF,KAAKC,MAAMpD,GAAKS,GAC5CgB,KAAMwG,EAAaZ,sBAAsBhC,QAAQ/F,MACjDqJ,SAAU,OAMbjG,EAAMa,KAAK,QAAS,6CAA+CpC,KAAK5C,MAAMkC,IAAI,GAClFiC,EAAMc,iBAAiB,gBAAiB,UAAYrC,KAAKlB,MAAMG,OAC/DsC,EAAMc,iBAAiB,eAAgB,gCACvCd,EAAMe,KAAKN,KAAKO,UAAU,CACzByE,KAAMhH,KAAK8F,QAAQ5B,QAAQ/F,MAC3BsJ,QAAS,OACTC,KAAM,EACNT,YAAajH,KAAKmG,eAAejC,QAAQ/F,MACzC+I,QAASlH,KAAKgG,QAAQ9B,QAAQ/F,MAC9BgJ,UAAWnH,KAAKiG,cAAc/B,QAAQ/F,MACtCwJ,IAAK3H,KAAK5C,MAAMgJ,OAChBtB,IAAK9E,KAAK5C,MAAMiJ,OAChBe,MAAOpH,KAAK+F,QAAQ7B,QAAQ/F,MAC5BuH,OAAQiB,O,uCAKT,IAAIpF,EAAQ,IAAIC,eACZsF,EAAe9G,KACnBuB,EAAMG,mBAAqB,WAGF,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,SAC7BkF,EAAahI,MAAM8H,QAAQrC,SAASe,SAASsB,QAAO,GAExDE,EAAaJ,gBAMfnF,EAAMa,KAAK,SAAU,6CAA+CpC,KAAK5C,MAAMkC,IAAI,GACnFiC,EAAMc,iBAAiB,gBAAiB,UAAYrC,KAAKlB,MAAMG,OAC/DsC,EAAMc,iBAAiB,eAAgB,oBACvCd,EAAMe,S,gCAGGwC,EAAK8C,GACd5H,KAAKjC,SAAS,CACbsI,OAAQuB,EACRxB,OAAQtB,M,iCAQCrD,GACNzB,KAAKlB,MAAM8H,OAAQ5G,KAAK5C,MAAMsD,MAAMmG,KAAKpF,EAAIM,eAC5C/B,KAAK5C,MAAMsD,MAAMmG,KAAKpF,K,wCAEVoG,GACjB7H,KAAKsG,SAASpC,QAAQ4D,SAAWD,EACd7H,KAAKsG,SAASpC,QAAQ6D,aAA5B,IAATF,EAAmD,8BACd,c,mCAIzC7H,KAAKuG,MAAMrC,QAAQ8D,UAAUC,OAAO,gB,oCAMpCjI,KAAK+F,QAAQ7B,QAAQ/F,MAAQ6B,KAAKlB,MAAM2G,KAAK2B,MAC7CpH,KAAK8F,QAAQ5B,QAAQ/F,MAAQ6B,KAAKlB,MAAM2G,KAAKuB,KAC7ChH,KAAKgG,QAAQ9B,QAAQ/F,MAAQ6B,KAAKlB,MAAM2G,KAAKyB,QAC7ClH,KAAKiG,cAAc/B,QAAQ/F,MAAQ6B,KAAKlB,MAAM2G,KAAK0B,UACnDnH,KAAKkG,sBAAsBhC,QAAQ/F,MAAQ6B,KAAKlB,MAAM2G,KAAKE,mBAAmBrF,KAC9EN,KAAKmG,eAAejC,QAAQ/F,MAAQ6B,KAAKlB,MAAM2G,KAAKwB,YAKpDjH,KAAKuG,MAAMrC,QAAQ8D,UAAUC,OAAO,gB,+BAKpC,OACC,6BACC,yBAAKrF,IAAK5C,KAAKuG,MAAOxG,MAAM,UAC3B,yBAAKA,MAAM,iBACV,0BAAMA,MAAM,eAAeK,QAASJ,KAAK0G,aAAzC,QAEA,2BAAOhD,IAAI,UAAX,YACA,kBAAC,EAAD,CAAiBkB,QAAS5E,KAAK8F,QAAS/B,YAAa/D,KAAK6F,UAAWO,OAAQpG,KAAKoG,OAAQC,OAAQrG,KAAKqG,SAEvG,2BAAO3C,IAAI,YAAX,aACA,2BAAOd,IAAK5C,KAAK+F,QAASzF,KAAK,OAAOhB,GAAG,WAAWpB,KAAK,WAAWqC,YAAY,kCAEhF,2BAAOmD,IAAI,YAAX,gBACA,2BAAOd,IAAK5C,KAAKgG,QAAS1F,KAAK,OAAOhB,GAAG,WAAWpB,KAAK,WAAWqC,YAAY,2BAEhF,2BAAOmD,IAAI,WAAX,kBACA,2BAAOd,IAAK5C,KAAKiG,cAAe3F,KAAK,OAAOhB,GAAG,UAAUpB,KAAK,UAAUqC,YAAY,6BAEpF,2BAAOmD,IAAI,cAAX,sCACA,2BAAOd,IAAK5C,KAAKkG,sBAAuB5F,KAAK,OAAOhB,GAAG,aAAapB,KAAK,aAAaqC,YAAY,oCAElG,2BAAOmD,IAAI,gBAAX,cACA,8BAAUd,IAAK5C,KAAKmG,eAAgB7G,GAAG,eAAepB,KAAK,eAAeqC,YAAY,oBAEtF,kBAAC,EAAD,CAAQwC,IAAK,WAAa/C,KAAKlB,MAAMoJ,QAAS5E,SAAU,WAAatD,KAAKlB,MAAMoJ,QAASjJ,MAAOe,KAAKlB,MAAMG,MAAO4C,WAAY7B,KAAK6B,WAAYnB,MAAOV,KAAK5C,MAAMsD,MAAOO,kBAAmBjB,KAAKiB,kBAAkBJ,KAAKb,MAAO6C,aAAc7C,KAAK6C,aAAcU,SAAUvD,KAAKyG,oBAE9Q,4BAAQnG,KAAK,SAASsC,IAAK5C,KAAKsG,SAAUlG,QAASJ,KAAK4F,aAAa/E,KAAKb,OAA1E,aACA,4BAAQM,KAAK,SAASsC,IAAK5C,KAAKmI,aAAc/H,QAASJ,KAAKoI,eAAevH,KAAKb,OAAhF,iBAGF,4BAAQM,KAAK,SAASF,QAASJ,KAAK0G,aAApC,kB,GAzNmBlG,aC1BF6H,E,kDACpB,WAAYvJ,GAAQ,IAAD,8BAClB,cAAMA,IACD1B,MAAQ,CACZsD,MAAO,IAGR,EAAK4H,YAAc,EAAKA,YAAYzH,KAAjB,gBACnB,EAAKgF,UAAY,EAAKA,UAAUhF,KAAf,gBACjB,EAAKgB,WAAa,EAAKA,WAAWhB,KAAhB,gBAClB,EAAK6F,YAAc,EAAKA,YAAY7F,KAAjB,gBAEnB,EAAKiF,QAAUnC,IAAMG,YACrB,EAAKiC,QAAUpC,IAAMG,YACrB,EAAKkC,QAAUrC,IAAMG,YACrB,EAAKmC,cAAgBtC,IAAMG,YAC3B,EAAKoC,sBAAwBvC,IAAMG,YACnC,EAAKqC,eAAiBxC,IAAMG,YAE5B,EAAKsC,OAASzC,IAAMG,YACpB,EAAKuC,OAAS1C,IAAMG,YACpB,EAAKyE,UAAY5E,IAAMG,YACvB,EAAKyC,MAAQ5C,IAAMG,YACnB,EAAK0E,cAAgB7E,IAAMG,YAC3B,EAAK2C,kBAAoB9C,IAAMG,YAvBb,E,0DA6BlB,GAAkC,IAA9B9D,KAAK+F,QAAQ7B,QAAQ/F,OAA6C,IAA9B6B,KAAKgG,QAAQ9B,QAAQ/F,OACrB,IAApC6B,KAAKiG,cAAc/B,QAAQ/F,OAA6C,IAA9B6B,KAAK8F,QAAQ5B,QAAQ/F,MAAa,CAG/E,IAAIwI,EAAa,GACb3G,KAAKlB,MAAM8H,OACmBD,EAA7B3G,KAAK5C,MAAMsD,MAAMyB,OAAS,EAAgBnC,KAAK5C,MAAMsD,MACvCV,KAAKlB,MAAM4G,OAEzB1F,KAAK5C,MAAMsD,MAAMyB,OAAS,EAC7BnC,KAAK5C,MAAMsD,MAAM0D,SAAQ,SAAUC,GAClCsC,EAAWE,KAAKxC,EAAKtC,kBAElB4E,EAAa3G,KAAKlB,MAAM4G,OAG9B,IAAInE,EAAQ,IAAIC,eACZsF,EAAe9G,KACnBuB,EAAMG,mBAAqB,WAE1B,IAAI7C,EAAMmB,KAAKkC,aACf,GAAwB,IAApBlC,KAAK2B,YAAoC,MAAhB3B,KAAK4B,OAAgB,CACjD,IAAIL,EAAQ,IAAIC,eAEhBD,EAAMG,mBAAqB,WAEF,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,SAC7BkF,EAAahI,MAAM8H,OAAQrC,SAASe,SAASsB,QAAO,GACnDE,EAAahI,MAAMiI,SAAS,CAChCC,KAAMF,EAAahB,QAAQ5B,QAAQ/F,MACnC8I,YAAaH,EAAaX,eAAejC,QAAQ/F,MACjD+I,QAASJ,EAAad,QAAQ9B,QAAQ/F,MACtCgJ,UAAWL,EAAab,cAAc/B,QAAQ/F,MAC9CiJ,MAAON,EAAaf,QAAQ7B,QAAQ/F,MACpCsK,UAAW3B,EAAaZ,sBAAsBhC,QAAQ/F,MACtDuH,OAAQoB,EAAa1J,MAAMsD,MAC3B2G,MAAOxI,IAERiI,EAAaJ,gBAIfnF,EAAMa,KAAK,OAAQ,iDAAiD,GACpEb,EAAMc,iBAAiB,gBAAiB,UAAYyE,EAAahI,MAAMG,OACvEsC,EAAMc,iBAAiB,eAAgB,oBACvCd,EAAMe,KAAKN,KAAKO,UAAU,CACzBgF,UAAW,eAAiBvF,KAAKC,MAAMpD,GAAKS,GAC5CgB,KAAMwG,EAAaZ,sBAAsBhC,QAAQ/F,MACjDqJ,SAAU,OAMbjG,EAAMa,KAAK,OAAQ,6CAA6C,GAChEb,EAAMc,iBAAiB,gBAAiB,UAAYrC,KAAKlB,MAAMG,OAC/DsC,EAAMc,iBAAiB,eAAgB,oBACvCd,EAAMe,KAAKN,KAAKO,UAAU,CACzByE,KAAMhH,KAAK8F,QAAQ5B,QAAQ/F,MAC3BsJ,QAAS,OACTC,KAAM,EACNT,YAAajH,KAAKmG,eAAejC,QAAQ/F,MACzC+I,QAASlH,KAAKgG,QAAQ9B,QAAQ/F,MAC9BgJ,UAAWnH,KAAKiG,cAAc/B,QAAQ/F,MACtCuK,KAAM,cAAgB1I,KAAKlB,MAAM6J,OACjChB,IAAK3H,KAAK5C,MAAMgJ,OAChBtB,IAAK9E,KAAK5C,MAAMiJ,OAChBe,MAAOpH,KAAK+F,QAAQ7B,QAAQ/F,MAC5BuH,OAAQiB,UAEHiC,MAAM,yD,gCAGJ9D,EAAK8C,GACd5H,KAAKjC,SAAS,CACbsI,OAAQuB,EACRxB,OAAQtB,M,iCAKCrD,GACVnD,QAAQC,IAAIkD,GACRzB,KAAKlB,MAAM8H,OAAQ5G,KAAK5C,MAAMsD,MAAMmG,KAAKpF,EAAIM,eAC5C/B,KAAK5C,MAAMsD,MAAMmG,KAAKpF,K,wCAEVoG,GACjB7H,KAAKuI,UAAUrE,QAAQ4D,SAAWD,EACf7H,KAAKuI,UAAUrE,QAAQ6D,aAA7B,IAATF,EAAoD,8BACd,a,oCAK1CvJ,QAAQC,IAAI,qBAGZyB,KAAK+F,QAAQ7B,QAAQ/F,MAAQ,GAC7B6B,KAAK8F,QAAQ5B,QAAQ/F,MAAQ,GAC7B6B,KAAKgG,QAAQ9B,QAAQ/F,MAAQ,GAC7B6B,KAAKiG,cAAc/B,QAAQ/F,MAAQ,GACnC6B,KAAKkG,sBAAsBhC,QAAQ/F,MAAQ,GAC3C6B,KAAKmG,eAAejC,QAAQ/F,MAAQ,GACpC6B,KAAK5C,MAAMsD,MAAQ,GAGnBV,KAAKuG,MAAMrC,QAAQ8D,UAAUC,OAAO,iB,+BAIpC,OACC,6BACC,yBAAKrF,IAAK5C,KAAKuG,MAAOxG,MAAM,UAC3B,yBAAKA,MAAM,iBACV,wCACA,0BAAMA,MAAM,eAAeK,QAASJ,KAAK0G,aAAzC,QAEA,2BAAOhD,IAAI,UAAX,YACA,kBAAC,EAAD,CAAiBkB,QAAS5E,KAAK8F,QAAS/B,YAAa/D,KAAK6F,UAAWO,OAAQpG,KAAKoG,OAAQC,OAAQrG,KAAKqG,SAEvG,2BAAO3C,IAAI,YAAX,aACA,2BAAOd,IAAK5C,KAAK+F,QAASzF,KAAK,OAAOhB,GAAG,WAAWpB,KAAK,WAAWqC,YAAY,kCAEhF,2BAAOmD,IAAI,YAAX,gBACA,2BAAOd,IAAK5C,KAAKgG,QAAS1F,KAAK,OAAOhB,GAAG,WAAWpB,KAAK,WAAWqC,YAAY,2BAEhF,2BAAOmD,IAAI,WAAX,kBACA,2BAAOd,IAAK5C,KAAKiG,cAAe3F,KAAK,OAAOhB,GAAG,UAAUpB,KAAK,UAAUqC,YAAY,6BAEpF,2BAAOmD,IAAI,cAAX,oCACA,2BAAOd,IAAK5C,KAAKkG,sBAAuB5F,KAAK,OAAOhB,GAAG,aAAapB,KAAK,aAAaqC,YAAY,oCAElG,2BAAOmD,IAAI,gBAAX,cACA,8BAAUd,IAAK5C,KAAKmG,eAAgB7G,GAAG,eAAepB,KAAK,eAAeqC,YAAY,oBAEtF,kBAAC,EAAD,CAAQwC,IAAK,UAAY/C,KAAKlB,MAAMoJ,QAAS5E,SAAU,UAAWrE,MAAOe,KAAKlB,MAAMG,MAAO4C,WAAY7B,KAAK6B,WAAYnB,MAAOV,KAAK5C,MAAMsD,MAAOO,kBAAmBjB,KAAKiB,kBAAkBJ,KAAKb,MAAO6C,aAAc7C,KAAKwI,cAAejF,SAAUvD,KAAKyG,oBAExP,4BAAQnG,KAAK,SAASsC,IAAK5C,KAAKuI,UAAWnI,QAASJ,KAAKsI,YAAYzH,KAAKb,OAA1E,cAGF,4BAAQM,KAAK,SAASF,QAASJ,KAAK0G,aAApC,iB,GA1KiClG,aCYxBqI,EAAb,kDACC,WAAY/J,GAAQ,IAAD,8BAClB,cAAMA,IACD1B,MAAQ,CACZ0L,MAAOhK,EAAMgK,OAGd,EAAKC,eAAiBpF,IAAMG,YAC5B,EAAKkF,wBAA0B,EAAKA,wBAAwBnI,KAA7B,gBAE/B,EAAKoI,WAAa,CACjB,UACA,WACA,QACA,QACA,MACA,OACA,OACA,SACA,YACA,UACA,WACA,YArBiB,EADpB,2DAgCgBC,GACd,OAAOA,EAAO/G,SAjChB,mCAqCc+G,GACZ,GAAIA,EAAO/G,OAAS,EAAG,CACtB,IAAIgH,EAAI,IAAIC,KAAKF,EAAO,GAAG/B,WAC3B,OAAOnH,KAAKiJ,WAAWE,EAAEE,YACnB,OAAO,OAzChB,iCA6CYH,GACV,GAAIA,EAAO/G,OAAS,EAAG,CACtB,IAAIgH,EAAI,IAAIC,KAAKF,EAAOA,EAAO/G,OAAS,GAAG+E,SAC3C,OAAOlH,KAAKiJ,WAAWE,EAAEE,YACnB,OAAO,IAjDhB,sCAqDiBH,GACf,GAAIA,EAAO/G,OAAS,EAAG,CACtB,IAAIgH,EACH,IAAIC,KAAKF,EAAOA,EAAO/G,OAAS,GAAG+E,SACnC,IAAIkC,KAAKF,EAAO,GAAG/B,WAEpB,OADiBrG,KAAKwI,KAAKH,EAAC,OAA4B,EAElD,OAAO,IA5DhB,sCA+DiBI,EAAOC,GACtB,IAAIL,EAAI,IAAIC,KAAKI,GAAS,IAAIJ,KAAKG,GAEnC,OADiBzI,KAAKwI,KAAKH,EAAC,OAA4B,IAjE1D,qCAsEgBD,GACd,GAAIA,EAAO/G,OAAS,EAAG,CACtB,IAAIgH,EAAInJ,KAAKyJ,aAAaP,GAE1B,OAAIC,IADInJ,KAAK0J,WAAWR,GAEhBlJ,KAAKyJ,aAAaP,GAAU,MAAQlJ,KAAK0J,WAAWR,GAChDC,EACN,MAAO,KA7EhB,qCAgFgBI,EAAOC,GACrB,IAAIL,EAAI,IAAIC,KAAKG,GACbI,EAAI,IAAIP,KAAKI,GACjB,OAAIL,EAAEE,aAAeM,EAAEN,WAErBrJ,KAAKiJ,WAAWE,EAAEE,YAAc,MAAQrJ,KAAKiJ,WAAWU,EAAEN,YAEhDrJ,KAAKiJ,WAAWE,EAAEE,cAvFhC,gCA2FWO,GAIT,IAHA,IAAI1L,EAAO0L,EAAQ,IAEfC,EADgBC,mBAAmBvF,SAASwF,QACzBC,MAAM,KACpBlH,EAAI,EAAGA,EAAI+G,EAAG1H,OAAQW,IAAK,CAEnC,IADA,IAAImH,EAAIJ,EAAG/G,GACW,KAAfmH,EAAEC,OAAO,IACfD,EAAIA,EAAEE,UAAU,GAEjB,GAAuB,GAAnBF,EAAEG,QAAQlM,GACb,OAAO+L,EAAEE,UAAUjM,EAAKiE,OAAQ8H,EAAE9H,QAGpC,MAAO,KAxGT,gDA6GE,GAAInC,KAAKlB,MAAMqB,UAAW,CACzB,IAAIoB,EAAQ,IAAIC,eACZ6I,EAAYrK,KAChBuB,EAAMG,mBAAqB,WAE1B,GAAwB,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,OAAgB,CACjDyI,EAAUtB,eAAe7E,QAAQ7D,MAAMiK,WAAa,UAEpD,IAAI3D,EAAa,GAEjB3E,KAAKC,MAAMjC,KAAKkC,cAAcqI,cAAcnG,SAAQ,SAAUC,GAC7DsC,EAAWE,KAAKxC,EAAK,YAGgD,IAAlEsC,EAAWyD,QAAQ,cAAgBC,EAAUvL,MAAMgK,MAAMxJ,IAC5D+K,EAAUtB,eAAe7E,QAAQC,UAAY,iBAG7CkG,EAAUtB,eAAe7E,QAAQC,UAAY,0CAKhD5C,EAAMa,KAAK,MAAO,4CAA8CiI,EAAUG,UAAU,OAAO,GAC3FjJ,EAAMc,iBAAiB,eAAgB,oBACvCd,EAAMc,iBAAiB,gBAAiB,UAAYgI,EAAUvL,MAAMG,OACpEsC,EAAMe,UAvIT,0CA4IEtC,KAAKgJ,4BA5IP,iCAmJE,IAAIzH,EAAQ,IAAIC,eACZ6I,EAAYrK,KAChBuB,EAAMG,mBAAqB,WAE1B,GAAwB,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,OAAgB,CAGjD,IAAI/C,EAAMmD,KAAKC,MAAMjC,KAAKkC,cACtByE,EAAa,GACjB9H,EAAI0L,cAAcnG,SAAQ,SAAUC,GACnCsC,EAAWE,KAAKxC,EAAK,WAItB,IA6BKoG,EA7BDC,EAAQ/D,EAAWyD,QAAQ,cAAgBC,EAAUvL,MAAMgK,MAAMxJ,IACrE,IAAe,IAAXoL,EACCA,GAAS,GACZ/D,EAAWgE,OAAOD,EAAO,IAItBD,EAAS,IAAIjJ,gBACVE,mBAAqB,WAEH,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,SACjCyI,EAAUtB,eAAe7E,QAAQC,UAAY,mBAG/CsG,EAAOrI,KAAK,QAAS,4CAA8CiI,EAAUG,UAAU,OAAO,GAC9FC,EAAOpI,iBAAiB,eAAgB,gCACxCoI,EAAOpI,iBAAiB,gBAAiB,UAAYgI,EAAUvL,MAAMG,OAGrEwL,EAAOnI,KAAKN,KAAKO,UAAU,CAC1B,cAAiBoE,UASd8D,EAAS,IAAIjJ,gBACVE,mBAAqB,WAEH,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,SACjCyI,EAAUtB,eAAe7E,QAAQC,UAAY,kCAI/CsG,EAAOrI,KAAK,QAAS,4CAA8CiI,EAAUG,UAAU,OAAO,GAC9FC,EAAOpI,iBAAiB,eAAgB,gCACxCoI,EAAOpI,iBAAiB,gBAAiB,UAAYgI,EAAUvL,MAAMG,OAErE0H,EAAWE,KAAK,cAAgBwD,EAAUvL,MAAMgK,MAAMxJ,IAEtDmL,EAAOnI,KAAKN,KAAKO,UAAU,CAC1B,cAAiBoE,OAKrBpF,EAAMa,KAAK,MAAO,4CAA8CpC,KAAKwK,UAAU,OAAO,GACtFjJ,EAAMc,iBAAiB,eAAgB,gCACvCd,EAAMc,iBAAiB,gBAAiB,UAAYrC,KAAKlB,MAAMG,OAC/DsC,EAAMe,SArNR,+BAwNW,IAAD,OACR,OACC,yBAAKM,IAAK5C,KAAK5C,MAAM0L,MAAMtC,QAASlH,GAAG,QACtC,4BAAKU,KAAK5C,MAAM0L,MAAM1B,OACtB,4BACEpH,KAAK5C,MAAM0L,MAAM8B,UACf,GACA5K,KAAK6K,eAAe7K,KAAK5C,MAAM0L,MAAMgC,SAEzC,uBAAG/K,MAAM,iBAAiB,IAAMC,KAAK5C,MAAM0L,MAAM7B,YAAc,KAC/D,2BACEjH,KAAK5C,MAAM0L,MAAMiC,MACf,qBACA,0BAEJ,2BACE/K,KAAK5C,MAAM0L,MAAMkC,WACf,0BACA,yCAEJ,sCACU,IACRhL,KAAK5C,MAAM0L,MAAMmC,OAAOC,UACxB,IACAlL,KAAK5C,MAAM0L,MAAMmC,OAAOE,UAE1B,kDACmB,IACjBnL,KAAK5C,MAAM0L,MAAM8B,UACf5K,KAAKoL,gBACNpL,KAAK5C,MAAM0L,MAAM8B,UACjB5K,KAAK5C,MAAM0L,MAAMuC,SAEhBrL,KAAKsL,gBAAgBtL,KAAK5C,MAAM0L,MAAMgC,QAAS,IAPnD,SAUC9K,KAAK5C,MAAM0L,MAAMyC,KACjB,6BACC,2BAAO7H,IAAI,SAASrD,MAAO,CAAEmL,OAAQ,oBAArC,sBAGA,2BACClM,GAAG,SACHe,MAAO,CAAEiK,WAAY,UACrB1H,IAAK5C,KAAK5C,MAAM0L,MAAMtC,QACtBlG,KAAK,OACLkD,OAAO,UACPxF,SAAUgC,KAAK5C,MAAM0L,MAAM2C,eAI5B,6BACEzL,KAAKlB,MAAM4M,OACX,kBAAC,EAAD,CAAkBpM,GAAIU,KAAK5C,MAAM0L,MAAMxJ,GAAIL,MAAOe,KAAKlB,MAAMG,QAE7D,GAED,4BAAQ2D,IAAK5C,KAAK+I,eAAgB1I,MAAO,CAAEiK,WAAY,UAAYhK,KAAK,SAASF,QAAS,kBAAM,EAAKuL,aAArG,wBAjRP,GAAkCnL,aA0RrBoL,EAAb,uKACW,IAAD,OACR,OACC,6BACC,yBAAK7L,MAAM,SACV,uBAAGA,MAAM,YAAYC,KAAKlB,MAAMuI,MAAMD,OACrC9I,QAAQC,IAAIyB,KAAKlB,MAAMuI,OACxB,uBAAGtH,MAAM,mBACPC,KAAKlB,MAAMuI,MAAML,KAAO,WAAQ,IAAIoC,KAAKpJ,KAAKlB,MAAMuI,MAAMH,UAE5D,2BAAIlH,KAAKlB,MAAMuI,MAAMJ,aACpBjH,KAAKlB,MAAMuI,MAAM3B,OAAOrE,KAAI,SAACwK,EAAO/I,GAAR,OAC5B,6BACC,yBACCC,IAAK,EAAKjE,MAAMgN,YAAYC,WAAajJ,EAAEiJ,WAC3C7I,IAAK2I,EAAMtM,KACX8D,IAAKwI,EAAMzE,MACXnE,OAAO,MACPD,MAAM,QAGP,uBAAGD,IAAKD,GAAI+I,EAAM5E,iBAInBjH,KAAKlB,MAAM4M,OACX,kBAAC,EAAD,CAAU9E,QAAS,EAAO7D,IAAK/C,KAAKlB,MAAMgN,YAAYC,SAAW,MAAO7D,QAASlI,KAAKlB,MAAMgN,YAAarG,KAAMzF,KAAKlB,MAAMuI,MAAOpI,MAAOe,KAAKlB,MAAMG,QAGnJ,IAIDe,KAAKlB,MAAMuI,MAAM1B,mBACjB,yBAAK5F,MAAM,oBACV,uBAAGA,MAAM,mBAAT,+BACyBC,KAAKlB,MAAMuI,MAAM1B,mBAAmBrF,OAI7D,QAxCN,GAAiCqD,IAAMnD,WAgKxBwL,E,kDA1Gd,WAAYlN,GAAQ,IAAD,8BAClB,cAAMA,IAEDmN,QAAL,gBACA,EAAKC,gBAAL,gBAEA,EAAK9O,MAAQ,CACZ0L,OAAO,EACP4C,QAAQ,GARS,E,8DAYA,IAAD,OACjBlN,IAAMU,IAAI,wCAAyC,CAClDP,QAAS,CAAEQ,cAAe,UAAYa,KAAKlB,MAAMG,SAC/CL,MAAK,SAACC,GAKR,IAAI8H,EAAa,GACjB9H,EAAIG,KAAKmN,MAAM/H,SAAQ,SAAUC,GAChCsC,EAAWE,KAAKuF,SAAS/H,EAAK/E,SAKjB,GADFqH,EAAWyD,QAAQgC,SAAS,EAAKtN,MAAMQ,MAElD,EAAKvB,SAAS,CAAE2N,QAAQ,OAIxBlM,OAAM,SAACC,GAEP,MADAnB,QAAQC,IAAI,+BACNkB,O,8BAIDqH,GACP,IAAIvF,EAAQ,IAAIC,eAChBD,EAAMG,mBAAqB,WAC1B,GAAwB,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,OAAgB,CACjD,IAAMkH,EAAQ9G,KAAKC,MAAMjC,KAAKkC,cAC9B4E,EAAa/I,SAAS,CAAE+K,MAAOA,MAGjCvH,EAAMa,KACL,MACA,4CAA8C0E,EAAahI,MAAMQ,IACjE,GAEDiC,EAAMe,S,+BAGG,IAAD,OAgDR,OA9CKtC,KAAK5C,MAAM0L,MAMd,6BACC,kBAAC,EAAD,CACC3I,UAAWH,KAAKlB,MAAMqB,UACtBpB,QAASiB,KAAKlB,MAAMC,UAErB,yBAAKO,GAAG,aACP,kBAAC+M,EAAA,EAAD,CAAK/M,GAAG,gBAAgBgN,OAAQ,CAAC,GAAM,GAAMC,KAAM,GAClD,kBAACC,EAAA,EAAD,CACCC,YAAY,0EACZC,IAAI,uDAGJ1M,KAAK5C,MAAM0L,MAAMgC,OAAOzJ,KAAI,SAACgG,GAAD,OAC5B,kBAACsF,EAAA,EAAD,CAAQC,SAAU,CAACvF,EAAMM,IAAKN,EAAMvC,MACnC,kBAAC,IAAD,KACC,4BAAKuC,EAAMJ,oBAOhB,yBAAK3H,GAAG,eACP,kBAAC,EAAD,CAAcwJ,MAAO9I,KAAK5C,MAAM0L,MAAO4C,OAAQ1L,KAAK5C,MAAMsO,OAAQzM,MAAOe,KAAKlB,MAAMG,MAAOF,QAASiB,KAAKlB,MAAMC,QAASoB,UAAWH,KAAKlB,MAAMqB,YAC7IH,KAAK5C,MAAMsO,OACX,kBAAC,EAAD,CAAS9E,QAAS,EAAO+B,OAAQ3I,KAAK5C,MAAM0L,MAAMxJ,GAAIyD,IAAK,eAAgBmF,QAAS,eAAgBjJ,MAAOe,KAAKlB,MAAMG,QAItH,GAED,yBAAKK,GAAG,UACNU,KAAK5C,MAAM0L,MAAMgC,OAAOzJ,KAAI,SAACgG,EAAOvE,GAAR,OAC5B,kBAAC,EAAD,CAAaC,IAAKD,EAAG6F,OAAQ,EAAKvL,MAAM0L,MAAMxJ,GAAI+H,MAAOA,EAAOyE,YAAahJ,EAAG4C,OAAQ2B,EAAM3B,OAAQgG,OAAQ,EAAKtO,MAAMsO,OAAQzM,MAAO,EAAKH,MAAMG,cArCvJ,0D,GA3DqBuB,aC9VnBqM,E,kDACL,WAAY/N,GAAQ,IAAD,8BAClB,cAAMA,IACD1B,MAAQ,CACZqI,KAAMzD,KAAKC,MAAMnD,EAAMuI,QAExB,EAAKjK,MAAMqI,KAAKE,mBAAqB,CAAE,KAAQ7G,EAAM2J,WAErD,EAAKqE,YAAcnJ,IAAMG,YACzB,EAAKiJ,QAAUpJ,IAAMG,YACrB,EAAKkJ,QAAUrJ,IAAMG,YACrB,EAAKmJ,eAAiBtJ,IAAMG,YAC5B,EAAKoJ,cAAgBvJ,IAAMG,YAC3B,EAAKqJ,sBAAwBxJ,IAAMG,YAEnC,EAAKsJ,gBAAkB,EAAKA,gBAAgBvM,KAArB,gBAdL,E,4DAiBHwM,GAEfrN,KAAKjC,SAAS,CACb0H,KAAM4H,EAAWhG,QAElBrH,KAAK8M,YAAY5I,QAAQC,UAAYkJ,EAAWrG,KAChDhH,KAAK+M,QAAQ7I,QAAQC,UAAYkJ,EAAWjG,MAC5CpH,KAAKgN,QAAQ9I,QAAQC,UAAYkJ,EAAWnG,QAC5ClH,KAAKiN,eAAe/I,QAAQC,UAAYkJ,EAAWpG,YACnDjH,KAAKkN,cAAchJ,QAAQC,UAAYkJ,EAAWlG,UAClDnH,KAAKmN,sBAAsBjJ,QAAQC,UAAYkJ,EAAW1H,mBAAmBrF,O,+BAKpE,IAAD,OACR,OACC,yBAAKP,MAAM,eACV,kBAAC,EAAD,CAAUgD,IAAK/C,KAAKlB,MAAMgN,YAAalF,QAAQ,EAAOG,SAAU/G,KAAKoN,gBAAiBlF,QAASlI,KAAK5C,MAAM0O,YAAarG,KAAMzF,KAAK5C,MAAMqI,KAAMxG,MAAOe,KAAKlB,MAAMG,QAChK,6BAEA,8CACA,2BAAO2D,IAAK5C,KAAK8M,aAAc9M,KAAKlB,MAAMwO,UAAUhI,UACpD,6BAEA,+CACA,2BAAO1C,IAAK5C,KAAK+M,SAAU/M,KAAKlB,MAAMwO,UAAUpP,MAChD,6BAEA,kDACA,2BAAO0E,IAAK5C,KAAKgN,SAAUhN,KAAKlB,MAAMwO,UAAUC,MAChD,6BAEA,oDACA,2BAAO3K,IAAK5C,KAAKkN,eAAgBlN,KAAKlB,MAAMwO,UAAUE,YACtD,6BAEA,wDACA,2BAAO5K,IAAK5C,KAAKmN,uBAAwBnN,KAAKlB,MAAMwO,UAAU3H,oBAC9D,6BAEA,gDACA,2BAAO/C,IAAK5C,KAAKiN,gBAAiBjN,KAAKlB,MAAMwO,UAAUrG,aACvD,6BAECjH,KAAKlB,MAAMwO,UAAU5M,OAAS,YAAIV,KAAKlB,MAAMwO,UAAU5M,OAAOW,KAAI,SAACC,EAAMwB,GAAP,OAClE,yBAAKC,IAAK,EAAKjE,MAAMgN,YAAchJ,EAAGE,MAAM,QAAQC,OAAO,QAAQC,IAAKC,IAAIC,gBAAgB9B,EAAKQ,OAAQuB,IAAI,kB,GAhE3FM,IAAMnD,WAwEvBiN,E,kDACL,WAAY3O,GAAQ,IAAD,8BAClB,cAAMA,IACD1B,MAAQ,CACZc,KAAMY,EAAMZ,KACZ+I,YAAanI,EAAMmI,YACnB8D,MAAOjM,EAAMiM,MACb2C,MAAO5O,EAAM4O,MACbC,SAAU7O,EAAM6O,SAChBjN,MAAO,GACPkN,UAAW,IAGZ,EAAKC,gBAAkBlK,IAAMG,YAE7B,EAAK2C,kBAAoB9C,IAAMG,YAC/B,EAAKjB,aAAec,IAAMG,YAE1B,EAAKgK,uBAAyB,EAAKA,uBAAuBjN,KAA5B,gBAC9B,EAAKkN,eAAiB,EAAKA,eAAelN,KAApB,gBAEtB,EAAKiF,QAAUnC,IAAMG,YACrB,EAAKiC,QAAUpC,IAAMG,YACrB,EAAKkC,QAAUrC,IAAMG,YACrB,EAAKmC,cAAgBtC,IAAMG,YAC3B,EAAKoC,sBAAwBvC,IAAMG,YACnC,EAAKqC,eAAiBxC,IAAMG,YAE5B,EAAKsC,OAASzC,IAAMG,YACpB,EAAKuC,OAAS1C,IAAMG,YACpB,EAAKwC,SAAW3C,IAAMG,YAEtB,EAAK0C,QAAU7C,IAAMG,YA/BH,E,2DAoCJuJ,GAEdrN,KAAKjC,SAAS,CACb6P,UAAU,GAAD,mBAAM5N,KAAK5C,MAAMwQ,WAAjB,CAA4B,CACpC,MAASP,EAAW3H,OACpB,YAAe2H,EAAWpG,YAC1B,KAAQoG,EAAWnG,QACnB,WAAcmG,EAAWlG,UACzB,SAAYkG,EAAWrG,KACvB,mBAAsBqG,EAAW5E,UACjC,KAAQ4E,EAAWjG,MACnB,MAASiG,EAAWhG,a,6CAiBArG,GAEtBhB,KAAKwG,QAAQtC,QAAQ7D,MAAM2N,gBAAkB,2DAA6D7K,IAAIC,gBAAgBpC,EAAM/C,OAAOyC,MAAM,IAAM,O,iCAG7Ie,GACVzB,KAAKjC,SAAS,CACb2C,MAAOV,KAAK5C,MAAMsD,MAAMuN,OAAOxM,O,+BAIvB,IAAD,OACR,OACC,yBAAKnC,GAAG,eACP,kBAAC,EAAD,CAAcwJ,MAAO,CAAE2C,YAAazL,KAAK8N,uBAAwBvC,MAAM,EAAM/E,QAASxG,KAAKwG,QAASY,MAAOpH,KAAK5C,MAAMc,KAAM+I,YAAajH,KAAK5C,MAAM6J,YAAa8D,MAAO/K,KAAK5C,MAAM2N,MAAO2C,MAAO1N,KAAK5C,MAAMsQ,MAAO5C,OAAQ,GAAIG,OAAQ,CAAEC,UAAW,UAAWC,SAAU,aAEzQ,yBAAKvI,IAAK5C,KAAK6N,kBACd7N,KAAK5C,MAAMwQ,UAAUvM,KAAI,SAACgG,EAAOvE,GAAR,OACzB,kBAAC,EAAD,CAAUwK,UAAWjG,EAAOtE,IAAK,WAAaD,EAAG2F,UAAWpB,EAAM1B,mBAAoBmG,YAAa,YAAchJ,EAAGuE,MAAOA,EAAMA,MAAOpI,MAAO,EAAKH,MAAMG,WAG3J,kBAAC,EAAD,CAAS2H,QAAQ,EAAOG,SAAU/G,KAAK+N,eAAgBpF,OAAQ3I,KAAKlB,MAAM6O,SAAU5K,IAAK,YAAamF,QAAS,YAAajJ,MAAOe,KAAKlB,MAAMG,a,GAtF1G0E,IAAMnD,WA6FxC0N,E,kDACL,WAAYpP,GAAQ,IAAD,8BAClB,cAAMA,IAEDmI,YAActD,IAAMG,YACzB,EAAK5F,KAAOyF,IAAMG,YAClB,EAAKiH,MAAQpH,IAAMG,YACnB,EAAK4J,MAAQ/J,IAAMG,YAND,E,6DAUd9D,KAAKiH,YAAY/C,QAAQiK,SAASC,OAASpO,KAAK9B,KAAKgG,QAAQiK,SAASC,MACzEpO,KAAKlB,MAAMuP,YAAYrO,KAAK9B,KAAKgG,QAAQ/F,MAAO6B,KAAKiH,YAAY/C,QAAQ/F,MAAO6B,KAAK+K,MAAM7G,QAAQoK,QAAStO,KAAK0N,MAAMxJ,QAAQoK,SACzH1F,MAAM,yC,+BAIb,OACC,yBAAK2F,UAAU,cACd,wCAEA,yBAAKA,UAAU,UACd,0CACA,yBAAKA,UAAU,iBACd,uBAAGA,UAAU,eAAb,cACA,2BAAOC,UAAQ,EAAClO,KAAK,OAAOsC,IAAK5C,KAAK9B,KAAMoB,GAAG,QAAQpB,KAAK,YAAYqC,YAAY,+BAEpF,uBAAGgO,UAAU,eAAb,iBACA,8BAAUC,UAAQ,EAAC5L,IAAK5C,KAAKiH,YAAa3H,GAAG,QAAQpB,KAAK,WAAWqC,YAAY,8FAKnF,yBAAKgO,UAAU,UACd,0CACA,yBAAKA,UAAU,iBACd,6BACC,2BAAO3L,IAAK5C,KAAK+K,MAAOzK,KAAK,WAAWhB,GAAG,cAAcpB,KAAK,cAAcC,MAAM,eAClF,2BAAOsQ,QAAQ,eAAf,wBAGD,6BACC,2BAAO7L,IAAK5C,KAAK0N,MAAOpN,KAAK,WAAWhB,GAAG,cAAcpB,KAAK,cAAcC,MAAM,eAClF,2BAAOsQ,QAAQ,eAAf,6CAMH,4BAAQnO,KAAK,SAASiO,UAAU,aAAanO,QAASJ,KAAK0O,eAAe7N,KAAKb,OAA/E,oB,GAjDyB2D,IAAMnD,WAuDdmO,E,kDACpB,WAAY7P,GAAQ,IAAD,8BAClB,cAAMA,IAED1B,MAAQ,CACZ6B,MAAOH,EAAMG,MACb2P,gBAAgB,EAChBC,YAAY,EAEZ3Q,KAAM,GACN+I,YAAa,GACb8D,OAAO,EACP2C,OAAO,GAGR,EAAKW,YAAc,EAAKA,YAAYxN,KAAjB,gBAdD,E,wDAiBPiO,EAASC,EAAgBC,EAAUC,GAC9CjP,KAAKjC,SAAS,CACbG,KAAM4Q,EACN7H,YAAa8H,EACbhE,MAAOiE,EACPtB,MAAOuB,EACPJ,YAAY,IAEb,IAAItN,EAAQ,IAAIC,eACZsF,EAAe9G,KACnBuB,EAAMG,mBAAqB,WAE1B,GAAwB,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,OAAgB,CACjD,IAAI/C,EAAMmD,KAAKC,MAAMjC,KAAKkC,cAC1B4E,EAAa/I,SAAS,CACrB8Q,YAAY,EACZD,gBAAgB,EAChBjB,SAAU9O,EAAIS,UAEe,IAApBU,KAAK2B,YAAoC,MAAhB3B,KAAK4B,QACxCgH,MAAM,0CAMRrH,EAAMa,KAAK,OAAQ,4CAA4C,GAC/Db,EAAMc,iBAAiB,gBAAiB,UAAYyE,EAAa1J,MAAM6B,OACvEsC,EAAMc,iBAAiB,eAAgB,oBACvCd,EAAMe,KAAKN,KAAKO,UAAU,CACzB,MAASuM,EACT,YAAeC,EACf,MAASC,EACT,WAAcC,EACd,OAAU,aAAenI,EAAahI,MAAMqB,UAC5C,SAAY,mB,+BAMb,OACC,6BACC,kBAAC,EAAD,CAAeF,OAAQ,EAAGhB,MAAOe,KAAKlB,MAAMG,MAAOkB,UAAWH,KAAKlB,MAAMqB,UAAWpB,QAASiB,KAAKlB,MAAMC,UAEvGiB,KAAK5C,MAAMwR,eACV5O,KAAK5C,MAAMyR,WAGX,0CAFA,kBAAC,EAAD,CAAgB5P,MAAOe,KAAK5C,MAAM6B,MAAOoP,YAAarO,KAAKqO,YAAYxN,KAAKb,QAI7E,kBAAC,EAAD,CAA2Bf,MAAOe,KAAK5C,MAAM6B,MAAO0O,SAAU3N,KAAK5C,MAAMuQ,SAAUzP,KAAM8B,KAAK5C,MAAMc,KAAM6M,MAAO/K,KAAK5C,MAAM2N,MAAO2C,MAAO1N,KAAK5C,MAAMsQ,MAAOzG,YAAajH,KAAK5C,MAAM6J,mB,GArElJzG,aC9NlB0O,E,kDACnB,WAAYpQ,GAAQ,IAAD,8BACjB,cAAMA,IAED1B,MAAQ,CACX+R,QAAS,GAETrK,IAAK,UACL6C,IAAK,UACL4E,KAAM,GAGR,EAAK6C,UAAL,gBAXiB,E,sDAcTC,GAER,IAAI9N,EAAQ,IAAIC,eAChBD,EAAMG,mBAAqB,WACD,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,SAChCyN,EAAWtR,SAAS,CAClBoR,QAASnN,KAAKC,MAAMjC,KAAKiE,UAAU,kBAErC3F,QAAQC,IAAIyD,KAAKC,MAAMjC,KAAKiE,aAGhC1C,EAAMa,KAAK,MAAO,4CAA4C,GAC9Db,EAAMe,S,+BAgBN,OACE,yBAAKiM,UAAU,OACb,kBAAC,EAAD,CACEtO,OAAQ,EACRhB,MAAOe,KAAKlB,MAAMG,MAClBkB,UAAWH,KAAKlB,MAAMqB,UACtBpB,QAASiB,KAAKlB,MAAMC,UAGtB,kBAACsN,EAAA,EAAD,CACE/M,GAAG,eACHgN,OAAQ,CAACtM,KAAK5C,MAAM0H,IAAK9E,KAAK5C,MAAMuK,KACpC4E,KAAMvM,KAAK5C,MAAMmP,MAEjB,kBAACC,EAAA,EAAD,CACEC,YAAY,0EACZC,IAAI,uDAGL1M,KAAK5C,MAAM+R,QAAQ9N,KAAI,SAACiO,GAAD,OACtBA,EAAOxE,OAAOzJ,KAAI,SAACgG,GAAD,OAChB,kBAACsF,EAAA,EAAD,CAAQC,SAAU,CAACvF,EAAMM,IAAKN,EAAMvC,MAClC,kBAAC,IAAD,KACE,4BAAKwK,EAAOlI,OACZ,uBAAGlH,KAAM,iBAAmBoP,EAAOhQ,IAAnC,wC,GAnEqBkB,aCD1B+O,EAAb,4MACEnS,MAAQ,CACNG,MAAO,GACPG,UAAW,GACXC,SAAU,GACV2B,GAAI,GACJ6M,MAAO,GACP5B,cAAe,IAPnB,EAUEiF,YAAc,WAEZhR,IAAMU,IAAI,wCAAyC,CACjDP,QAAS,CAAEQ,cAAe,UAAY,EAAKL,MAAMG,SAEhDL,MAAK,SAACC,GACLP,QAAQC,IAAIM,GACZ,EAAKd,SAAS,CACZR,MAAOsB,EAAIG,KAAKzB,MAChBG,UAAWmB,EAAIG,KAAKkM,UACpBvN,SAAUkB,EAAIG,KAAKmM,SACnB7L,GAAIT,EAAIG,KAAKM,GACb6M,MAAOtN,EAAIG,KAAKmN,MAChB5B,cAAe1L,EAAIG,KAAKuL,mBAG3B/K,OAAM,SAACC,GAEN,MADAnB,QAAQC,IAAI,iBACNkB,MA5Bd,EAgCEgQ,SAAW,WAETnR,QAAQC,IAAI,aACZD,QAAQC,IAAI,EAAKnB,MAAM+O,OACvB,IAAK,IAAIrJ,EAAI,EAAGA,EAAI,EAAK1F,MAAM+O,MAAMhK,OAAQW,IAC3CtE,IAAMU,IACJ,4CACE,EAAK9B,MAAM+O,MAAMrJ,GAAGkH,MAAM,KAAK,IAEhCpL,MAAK,SAACC,GACLP,QAAQC,IAAIM,GACZ,EAAKd,SAAS,CACZ2R,WAAW,GAAD,mBACL,EAAKtS,MAAMsS,YADN,CAER,CAAEpQ,GAAIT,EAAIG,KAAKM,GAAI8H,MAAOvI,EAAIG,KAAKoI,cAIxC5H,OAAM,SAACC,GACN,MAAMA,MAnDhB,kEAyDIO,KAAKwP,gBAzDT,+BA6DI,OACE,yBAAKjB,UAAU,WACb,kBAAC,EAAD,CACEtO,OAAO,IACPE,UAAWH,KAAKlB,MAAMqB,UACtBpB,QAASiB,KAAKlB,MAAMC,UAErBiB,KAAKlB,MAAMqB,UACV,yBAAKoO,UAAU,mBAAmBlO,MAAOsP,GACvC,0CACA,wBAAItP,MAAO,CAAEuP,gBAAiB,YAA9B,iBACA,yBAAKrB,UAAU,aAAalO,MAAOwP,GACjC,6BACE,oCACA,wCACA,wCAEF,6BACE,2BAAI7P,KAAK5C,MAAMG,OACf,2BAAIyC,KAAK5C,MAAMM,WACf,2BAAIsC,KAAK5C,MAAMO,YAGnB,yBAAK0C,MAAO8L,GACV,yBAAKoC,UAAU,YACb,wBAAIlO,MAAO,CAAEuP,gBAAiB,YAA9B,YACC5P,KAAK5C,MAAM+O,MAAM9K,KAAI,SAACqH,GAAD,OACpB,2BACE,uBAAGxI,KAAM,iBAAmBwI,EAAKpJ,IAAKoJ,EAAKtB,WAG/C,uBAAGlH,KAAK,aAAaG,MAAO,CAAEyP,MAAO,QAArC,cAIF,yBAAKvB,UAAU,kBACb,wBAAIlO,MAAO,CAAEuP,gBAAiB,YAA9B,kBACqC,IAApC5P,KAAK5C,MAAMmN,cAAcpI,OACxBnC,KAAK5C,MAAMmN,cAAclJ,KAAI,SAACqH,GAAD,OAC3B,2BACE,uBAAGxI,KAAM,iBAAmBwI,EAAKpJ,IAAKoJ,EAAKtB,WAI/C,iEAEE,uBAAGlH,KAAK,YAAYG,MAAO,CAAER,QAAS,UAAtC,2CASV,iDApHV,GAA6BW,aA2HvBmP,EAAiB,CACrBI,UAAW,SACXH,gBAAiB,UACjB5M,MAAO,MACPgN,OAAQ,QAGJH,EAAW,CACfhQ,QAAS,OACToQ,eAAgB,gBAGZ9D,EAAQ,CACZtM,QAAS,OACToQ,eAAgB,gBAGHV,ICvITW,E,kDACF,WAAYpR,GAAQ,IAAD,8BACf,cAAMA,IACD1B,MAAQ,CACT4J,KAAMlI,EAAMkI,KACZI,MAAOtI,EAAMsI,MACb+I,QAASrR,EAAMqR,QACfC,SAAUtR,EAAMsR,SAChBrF,MAAOjM,EAAMiM,MACb2C,MAAO5O,EAAM4O,OARF,E,qDAaf,OACI,yBAAK3N,MAAM,cAEP,yBAAKA,MAAM,iBACP,uBAAGA,MAAM,eAAT,UACA,2BAAOyO,UAAQ,EAAClO,KAAK,OAAOsC,IAAK5C,KAAK5C,MAAMgK,MAAO9H,GAAG,QAAQpB,KAAK,QAAQqC,YAAY,MAG3F,yBAAKR,MAAM,iBACP,uBAAGA,MAAM,eAAT,YACA,2BAAOyO,UAAQ,EAAClO,KAAK,OAAOsC,IAAK5C,KAAK5C,MAAM+S,QAAS7Q,GAAG,UAAUpB,KAAK,UAAUqC,YAAY,eAGjG,yBAAKR,MAAM,iBACP,uBAAGA,MAAM,eAAT,SACA,2BAAOyO,UAAQ,EAAClO,KAAK,OAAOsC,IAAK5C,KAAK5C,MAAM4J,KAAM1H,GAAG,QAAQpB,KAAK,OAAOqC,YAAY,cAGzF,yBAAKR,MAAM,iBACP,6BACI,2BAAO6C,IAAK5C,KAAK5C,MAAM2N,MAAOzK,KAAK,WAAWhB,GAAG,cAAcpB,KAAK,cAAcC,MAAM,eACxF,2BAAOsQ,QAAQ,eAAf,WAGJ,6BACI,2BAAO7L,IAAK5C,KAAK5C,MAAMsQ,MAAOpN,KAAK,WAAWhB,GAAG,cAAcpB,KAAK,cAAcC,MAAM,eACxF,2BAAOsQ,QAAQ,eAAf,+BAIR,4BAAQnO,KAAK,SAASP,MAAM,aAAaK,QAASJ,KAAK5C,MAAMgT,UAA7D,iB,GA5CSzM,IAAMnD,WAkDzB6P,E,kDACF,WAAYvR,GAAQ,IAAD,8BACf,cAAMA,IAED1B,MAAQ,CACT4J,KAAMlI,EAAMkI,KACZmJ,QAASrR,EAAMqR,QACf/I,MAAOtI,EAAMsI,MACb2D,MAAOjM,EAAMiM,MACb2C,MAAO5O,EAAM4O,MACbyB,QAAS,IAEb,EAAKlD,QAAL,gBAXe,E,oDAcXoD,GACJ,IAAI9N,EAAQ,IAAIC,eAChBD,EAAMG,mBAAqB,WACC,IAApB1B,KAAK2B,YAAoC,MAAhB3B,KAAK4B,QAC9ByN,EAAWtR,SAAS,CAChBoR,QAASnN,KAAKC,MAAMjC,KAAKiE,UAAU,mBAM/C,IAAIyI,EAAM,4CACN4D,GAAa,EACbjB,EAAWjS,MAAMgK,MAAMjF,OAAS,IAChCuK,EAAMA,EAAIuB,OAAO,SAAUoB,EAAWjS,MAAMgK,OAC5CkJ,GAAa,GAEbjB,EAAWjS,MAAM+S,QAAQhO,OAAS,IAC7BmO,IACD5D,EAAMA,EAAIuB,OAAO,MAErBvB,EAAMA,EAAIuB,OAAO,YAAaoB,EAAWjS,MAAM+S,SAC/CG,GAAa,GAEbjB,EAAWjS,MAAM4J,KAAK7E,OAAS,IAC1BmO,IACD5D,EAAMA,EAAIuB,OAAO,MAErBvB,EAAMA,EAAIuB,OAAO,eAAgBoB,EAAWjS,MAAM4J,MAClDsJ,GAAa,GAGbjB,EAAWjS,MAAM2N,QACjBzM,QAAQC,IAAI8Q,EAAWjS,MAAM2N,MAAOuF,GAC/BA,IACD5D,EAAMA,EAAIuB,OAAO,MAErBvB,EAAMA,EAAIuB,OAAO,cACjBqC,GAAa,GAGbjB,EAAWjS,MAAMsQ,QACZ4C,IACD5D,EAAMA,EAAIuB,OAAO,MAErBvB,EAAMA,EAAIuB,OAAO,oBAGrB3P,QAAQC,IAAImO,GACZnL,EAAMa,KAAK,MAAMsK,GAAK,GACtBnL,EAAMe,S,+BAIN,OACI,6BACI,yBAAKhD,GAAG,aACJ,0CACA,4BACQ,uCAAaU,KAAK5C,MAAMgK,MAAxB,MACA,yCAAepH,KAAK5C,MAAM+S,QAA1B,MACA,sCAAYnQ,KAAK5C,MAAM4J,KAAvB,MACA,uCAAahH,KAAK5C,MAAM2N,MAAQ,OAAS,GAAzC,MACA,4CAAkB/K,KAAK5C,MAAMsQ,MAAQ,OAAS,GAA9C,SAKZ,yBAAKpO,GAAG,SAEHU,KAAK5C,MAAM+R,QAAQhN,OAAS,EACzB,+BACI,+BACI,4BACI,qCACA,sCACA,2CACA,sCAIR,+BACKnC,KAAK5C,MAAM+R,QAAQ9N,KAAI,SAACiO,GAAD,OACpB,4BACI,4BAAKA,EAAOlI,OACZ,4BAAKkI,EAAOrE,OAAOC,UAAnB,IAA+BoE,EAAOrE,OAAOsF,UAC7C,4BAAKjB,EAAOrI,aACZ,4BAAI,uBAAG/G,KAAM,iBAAmBoP,EAAOhQ,IAAnC,kBAMhB,6BACI,wCACA,uBAAGY,KAAK,kBAAR,iB,GA9GPyD,IAAMnD,WA+HVgQ,E,kDACjB,WAAY1R,GAAQ,IAAD,8BACf,cAAMA,IAED1B,MAAQ,CACTkC,GAAIR,EAAMQ,GACVmR,gBAAgB,EAChB1F,OAAO,EACP2C,OAAO,EACPgD,SAAU,uDAGd,EAAK1J,KAAOrD,IAAMG,YAClB,EAAKsD,MAAQzD,IAAMG,YACnB,EAAKqM,QAAUxM,IAAMG,YACrB,EAAKiH,MAAQpH,IAAMG,YACnB,EAAK4J,MAAQ/J,IAAMG,YAGnB,EAAKsM,SAAW,EAAKA,SAASvP,KAAd,gBAlBD,E,uDAsBXb,KAAKgH,KAAK9C,QAAQiK,SAASC,OAASpO,KAAKoH,MAAMlD,QAAQiK,SAASC,OAChEpO,KAAKmQ,QAAQjM,QAAQiK,SAASC,MAC9BpO,KAAKjC,SAAS,CACViJ,KAAMhH,KAAKgH,KAAK9C,QAAQ/F,MACxBgS,QAASnQ,KAAKmQ,QAAQjM,QAAQ/F,MAC9BiJ,MAAOpH,KAAKoH,MAAMlD,QAAQ/F,MAC1B4M,MAAO/K,KAAK+K,MAAM7G,QAAQoK,QAC1BZ,MAAO1N,KAAK0N,MAAMxJ,QAAQoK,QAC1BmC,gBAAgB,IAGnB7H,MAAM,uD,+BAIX,OACI,6BACI,kBAAC,EAAD,CAAe3I,OAAO,MAErBD,KAAK5C,MAAMqT,eACR,kBAAC,EAAD,CAAYzJ,KAAMhH,KAAKgH,KAAMI,MAAOpH,KAAKoH,MAAO+I,QAASnQ,KAAKmQ,QAASpF,MAAO/K,KAAK+K,MAAO2C,MAAO1N,KAAK0N,MAAO0C,SAAUpQ,KAAKoQ,WAE5H,kBAAC,EAAD,CAAYpJ,KAAMhH,KAAKgH,KAAK9C,QAAQ/F,MAAOiJ,MAAOpH,KAAKoH,MAAMlD,QAAQ/F,MAAOgS,QAASnQ,KAAKmQ,QAAQjM,QAAQ/F,MAAO4M,MAAO/K,KAAK+K,MAAM7G,QAAQoK,QAASZ,MAAO1N,KAAK0N,MAAMxJ,QAAQoK,e,GA7CxJ9N,aCtLrBmQ,E,uKAEnB,OACC,6BACC,kBAAC,EAAD,CACC1Q,OAAQ,EACRhB,MAAOe,KAAKlB,MAAMG,MAClBkB,UAAWH,KAAKlB,MAAMqB,UACtBpB,QAASiB,KAAKlB,MAAMC,UAGrB,wCACA,yDACA,mFAAwD,6BAAxD,6CACA,4EACA,8HACA,6BACA,4K,GAjB+ByB,aC6CpBoQ,EA9Cf,4MACExT,MAAQ,CACNyT,WAAW,GAFf,EAKEC,cAAgB,WACd,MAAO,CACLjR,QAAS,EAAKzC,MAAMyT,UAAY,QAAU,OAC1CjE,SAAU,WACVmE,OAAQ,IACRC,IAAK,OACLC,KAAM,MACNjO,MAAO,QAZb,EAgBEkO,mBAAqB,WACnB,MAAO,CACLtE,SAAU,WACVqE,KAAM,OACNrB,gBAAiB,UACjBuB,aAAc,OACdC,QAAS,OACTC,WAAY,OACZC,SAAU,UAxBhB,EA4BEC,kBAAoB,WAClB,EAAKxT,SAAS,CAAE8S,WAAW,IAC3BW,YAAW,kBAAM,EAAKzT,SAAS,CAAE8S,WAAW,MAAU,MA9B1D,uDAkCI,OACE,6BACE,yBAAKxQ,MAAOL,KAAK8Q,iBACf,yBAAKzQ,MAAOL,KAAKkR,sBACf,2BAAIlR,KAAKlB,MAAM2S,gBAtC3B,GAA2BjR,aCEdkR,EAAb,4MACEtU,MAAQ,CACNG,MAAO,GACPG,UAAW,GACXC,SAAU,GACVgU,gBAAiB,GACjBC,YAAa,GACbC,aAAc,GACdvS,GAAI,GACJwS,cAAc,EACdC,aAAa,EACbN,QAAS,IAXb,EAcEO,WAAa,SAAClU,GACZ,EAAKC,SAAS,CAAE+T,cAAc,EAAMC,aAAa,KAfrD,EAkBEE,UAAY,SAACnU,GACX,EAAKC,SAAS,CAAE+T,cAAc,EAAOC,aAAa,KAnBtD,EAsBE/T,SAAW,SAACF,GACV,EAAKC,SAAL,eAAiBD,EAAEG,OAAOC,KAAOJ,EAAEG,OAAOE,SAvB9C,EA0BE+T,SAAW,SAACpU,GACVA,EAAEO,iBACFC,QAAQC,IAAI,oBAEuB,KAA/B,EAAKnB,MAAMuU,gBAEbnT,IAAMC,KACJ,8CACA,CACEjB,SAAU,EAAKJ,MAAMuU,iBAEvB,CACEhT,QAAS,CACPQ,cAAe,UAAY,EAAKL,MAAMG,MACtC,eAAgB,sBAInBL,MAAK,SAACC,GACLP,QAAQC,IAAIM,EAAIG,MACZH,EAAIG,KAAKoP,QACX9P,QAAQC,IAAI,oBACR,EAAKnB,MAAMwU,cAAgB,EAAKxU,MAAMyU,aACxCrT,IAAM2T,MACJ,4CACE,EAAKrT,MAAMqB,UACb,CACE3C,SAAU,EAAKJ,MAAMwU,YACrB1G,UAAW,EAAK9N,MAAMM,UACtByN,SAAU,EAAK/N,MAAMO,UAEvB,CACEgB,QAAS,CACPQ,cAAe,UAAY,EAAKL,MAAMG,MACtC,eAAgB,kCAInBL,MAAK,SAACC,GACLP,QAAQC,IAAI,oCAEbiB,OAAM,SAACC,GAEN,MADAnB,QAAQC,IAAI,iCACNkB,MAGVnB,QAAQC,IAAI,0BACZ,EAAKR,SAAS,CAAE0T,QAAS,gCAI9BjS,OAAM,SAACC,GAEN,MADAnB,QAAQC,IAAI,iCACNkB,MAGVnB,QAAQC,IAAI,iCACZC,IAAM2T,MACJ,4CAA8C,EAAKrT,MAAMqB,UACzD,CACE+K,UAAW,EAAK9N,MAAMM,UACtByN,SAAU,EAAK/N,MAAMO,UAEvB,CACEgB,QAAS,CACPQ,cAAe,UAAY,EAAKL,MAAMG,MACtC,eAAgB,kCAInBL,MAAK,SAACC,GACLP,QAAQC,IAAI,2CAEbiB,OAAM,SAACC,GAEN,MADAnB,QAAQC,IAAI,4BACNkB,OArGhB,EA0GE+P,YAAc,WAEZhR,IAAMU,IAAI,wCAAyC,CACjDP,QAAS,CAAEQ,cAAe,UAAY,EAAKL,MAAMG,SAEhDL,MAAK,SAACC,GACLP,QAAQC,IAAIM,GACZ,EAAKd,SAAS,CACZR,MAAOsB,EAAIG,KAAKzB,MAChBG,UAAWmB,EAAIG,KAAKkM,UACpBvN,SAAUkB,EAAIG,KAAKmM,SACnB7L,GAAIT,EAAIG,KAAKM,QAGhBE,OAAM,SAACC,GAEN,MADAnB,QAAQC,IAAI,iBACNkB,MA1Hd,kEA+HIO,KAAKwP,gBA/HT,+BAmII,OACE,yBAAKjB,UAAU,YACkB,IAA9BvO,KAAK5C,MAAMqU,QAAQtP,OAClB,kBAAC,EAAD,CAAOsP,QAASzR,KAAK5C,MAAMqU,UAE3B,+BAEF,kBAAC,EAAD,CACExR,OAAO,IACPE,UAAWH,KAAKlB,MAAMqB,UACtBpB,QAASiB,KAAKlB,MAAMC,UAEtB,yBAAKsB,MAAO+R,GACV,wCACA,yBAAK/R,MAAOsP,GACV,yBAAKtP,MAAOgS,GACV,wBAAIhS,MAAOiS,EAAWlS,QAASJ,KAAKgS,YAApC,aAGA,wBAAI3R,MAAOiS,EAAWlS,QAASJ,KAAKiS,WAApC,YAIDjS,KAAK5C,MAAM0U,aACV,yBAAKzR,MAAOwP,GACV,6BACE,oCACA,wCACA,uCACA,+CACA,2CACA,yDAEF,yBAAKxP,MAAOkS,GACV,2BAAIvS,KAAK5C,MAAMG,OACf,2BACE+C,KAAK,OACLpC,KAAK,YACLoB,GAAG,YACHtB,SAAUgC,KAAKhC,SACfG,MAAO6B,KAAK5C,MAAMM,YAEpB,2BACE4C,KAAK,OACLpC,KAAK,WACLoB,GAAG,WACHtB,SAAUgC,KAAKhC,SACfG,MAAO6B,KAAK5C,MAAMO,WAEpB,2BACE2C,KAAK,WACLpC,KAAK,kBACLC,MAAO6B,KAAK5C,MAAMuU,gBAClB3T,SAAUgC,KAAKhC,WAEjB,2BACEsC,KAAK,WACLpC,KAAK,cACLC,MAAO6B,KAAK5C,MAAMwU,YAClB5T,SAAUgC,KAAKhC,WAEjB,2BACEsC,KAAK,WACLpC,KAAK,eACLC,MAAO6B,KAAK5C,MAAMyU,aAClB7T,SAAUgC,KAAKhC,WAEjB,2BACEqC,MAAO,CAAE2C,MAAO,OAChB1C,KAAK,SACLnC,MAAM,eACNiC,QAASJ,KAAKkS,aAKpB,yBAAK7R,MAAOwP,GACV,mEAhNhB,GAA8BrP,aA0NxB4R,EAAY,CAChBrC,UAAW,SACX/M,MAAO,MACPgN,OAAQ,QAGJL,EAAiB,CACrB9P,QAAS,OACToQ,eAAgB,gBAGZoC,EAAW,CACfG,UAAW,QAEPF,EAAY,CAChBlB,QAAS,OACT5F,OAAQ,kBACRoE,gBAAiB,WAGbC,EAAW,CACfhQ,QAAS,OACTmD,MAAO,MACPiN,eAAgB,eAChBzE,OAAQ,kBACRoE,gBAAiB,WAGb2C,EAAO,CACXvP,MAAO,OAGM0O,ICnPMe,E,kDACnB,WAAY3T,GAAQ,IAAD,uBACjB,cAAMA,IAwCRC,QAAU,SAACE,GACTX,QAAQC,IAAI,cACZ,EAAKR,SAAS,CAAEoC,WAAW,EAAMlB,WACjB,IAAIG,KACZC,IAAI,QAASJ,EAAO,CAAEM,KAAM,OA7CnB,EAgDnBmT,WAAa,YACK,IAAItT,KACZuT,OAAO,QAAS,CAAEpT,KAAM,MAChC,EAAKxB,SAAS,CAAEoC,WAAW,EAAOlB,MAAO,KACzCX,QAAQC,IAAI,iBAjDZ,IAAMqU,EAAU,IAAIxT,IACdyT,EAAY,IAAIC,gBAAgB1N,OAAOE,SAASyN,QAClD9T,IAAQ2T,EAAQ1T,IAAI,UAAW0T,EAAQ1T,IAAI,SAL9B,OAOb2T,EAAU3T,IAAI,YAChB,EAAKwT,aACLzT,GAAQ,GAGV,EAAK7B,MAAQ,CACX4V,aAAcH,EAAU3T,IAAI,QAC5BwJ,KAAMmK,EAAU3T,IAAI,MACpBiB,YAAWlB,EACXA,MAAOA,GAAgB,IAhBR,E,gEAoBE,IAAD,OACde,KAAK5C,MAAM6B,QACbX,QAAQC,IAAI,cACZC,IAAMU,IAAI,wCAAyC,CACjDP,QAAS,CAAEQ,cAAe,UAAYa,KAAK5C,MAAM6B,SAEhDL,MAAK,SAACC,GACL,EAAKd,SAAS,CAAEoC,UAAWtB,EAAIG,KAAKM,QAGrCE,OAAM,SAACC,GAMN,MALAnB,QAAQC,IAAI,OACZD,QAAQC,IAAI,EAAKnB,MAAM6B,OACvB,EAAKlB,SAAS,CAAEoC,WAAW,EAAOlB,MAAO,MACzB,IAAIG,KACZuT,OAAO,QAAS,CAAEpT,KAAM,MAC1BE,Q,+BAoBZ,MAAgC,SAA5BO,KAAK5C,MAAM4V,aAEX,kBAAC,EAAD,CACE1T,GAAIU,KAAK5C,MAAMsL,KACfvI,UAAWH,KAAK5C,MAAM+C,UACtBpB,QAASiB,KAAKjB,QACdE,MAAOe,KAAK5C,MAAM6B,QAGe,SAA5Be,KAAK5C,MAAM4V,aAElB,kBAAC,EAAD,CACE/T,MAAOe,KAAK5C,MAAM6B,MAClBkB,UAAWH,KAAK5C,MAAM+C,UACtBpB,QAASiB,KAAKjB,UAGmB,YAA5BiB,KAAK5C,MAAM4V,aAElB,kBAAC,EAAD,CACE7S,UAAWH,KAAK5C,MAAM+C,UACtBlB,MAAOe,KAAK5C,MAAM6B,MAClBF,QAASiB,KAAKjB,UAGmB,aAA5BiB,KAAK5C,MAAM4V,aACb,kBAAC,EAAD,MAC8B,UAA5BhT,KAAK5C,MAAM4V,aAElB,kBAAC,EAAD,CACE/T,MAAOe,KAAK5C,MAAM6B,MAClBkB,UAAWH,KAAK5C,MAAM+C,UACtBpB,QAASiB,KAAKjB,UAGmB,aAA5BiB,KAAK5C,MAAM4V,aAElB,kBAAC,EAAD,CAAU7S,UAAWH,KAAK5C,MAAM+C,UAAWlB,MAAOe,KAAK5C,MAAM6B,QAIjE,kBAAC,EAAD,CAAWkB,UAAWH,KAAK5C,MAAM+C,UAAWpB,QAASiB,KAAKjB,QAASE,MAAOe,KAAK5C,MAAM6B,Y,GAlGxDuB,aCAbyS,QACW,cAA7B7N,OAAOE,SAAS4N,UAEe,UAA7B9N,OAAOE,SAAS4N,UAEhB9N,OAAOE,SAAS4N,SAASC,MACvB,2DCZNC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEF/O,SAASgP,eAAe,SDyHpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrB9U,MAAK,SAAA+U,GACJA,EAAaC,gBAEdpU,OAAM,SAAAqU,GACLvV,QAAQuV,MAAMA,EAAMpC,c","file":"static/js/main.c1b27ac9.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport Axios from \"axios\";\r\nimport Cookies from \"universal-cookie\";\r\n\r\nexport default class NavigationBar extends Component {\r\n  state = {\r\n    showLogin: false,\r\n    showRegister: false,\r\n    email: \"\",\r\n    password: \"\",\r\n    password2: \"\",\r\n    firstname: \"\",\r\n    lastname: \"\",\r\n    registerSuccess: \"\",\r\n    registerMessage: \"\",\r\n  };\r\n\r\n  showLogin = (e) => {\r\n    this.setState({ showLogin: !this.state.showLogin, showRegister: false });\r\n  };\r\n\r\n  showRegister = (e) => {\r\n    this.setState({ showRegister: !this.state.showRegister, showLogin: false });\r\n  };\r\n\r\n  onChange = (e) => {\r\n    this.setState({ [e.target.name]: e.target.value });\r\n  };\r\n\r\n  onSubmitLogin = (e) => {\r\n    e.preventDefault();\r\n    console.log(\"Login attempt\");\r\n    //get token from api\r\n    const headers = {\r\n      \"Content-Type\": \"application/json\",\r\n    };\r\n    Axios.post(\r\n      \"https://wtg.aymerik-diebold.fr/login_check\",\r\n      {\r\n        username: this.state.email,\r\n        password: this.state.password,\r\n      },\r\n      { headers }\r\n    )\r\n      .then((res) => {\r\n        console.log(res);\r\n        this.props.connect(res.data.token);\r\n        this.setState({ showLogin: false });\r\n\r\n        Axios.get(\"https://wtg.aymerik-diebold.fr/api/me\", {\r\n          headers: { Authorization: \"Bearer \" + res.data.token },\r\n        })\r\n          .then((res) => {\r\n            console.log(res);\r\n            const cookies = new Cookies();\r\n            cookies.set(\"id\", res.data.id, { path: \"/\" });\r\n          })\r\n          .catch((err) => {\r\n            console.log(\"Error when retrieve user id\");\r\n            throw err;\r\n          });\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"Login failed\");\r\n        this.setState({\r\n          registerSuccess: \"Email/password combination not found :(\",\r\n        });\r\n        throw err;\r\n      });\r\n  };\r\n\r\n  onSubmitRegister = (e) => {\r\n    e.preventDefault();\r\n    console.log(\"Register attempt\");\r\n    //todo: register to api\r\n    const headers = {\r\n      \"Content-Type\": \"application/json\",\r\n    };\r\n    if (this.state.password !== this.state.password2) {\r\n      this.setState({ registerMessage: \"Your passwords do not match :(\" });\r\n    } else if (\r\n      this.state.email === \"\" ||\r\n      this.state.password === \"\" ||\r\n      this.state.password2 === \"\"\r\n    ) {\r\n      this.setState({ registerMessage: \"Email and Password are required\" });\r\n    } else {\r\n      Axios.post(\r\n        \"https://wtg.aymerik-diebold.fr/register\",\r\n        {\r\n          email: this.state.email,\r\n          password: this.state.password,\r\n          firstname: this.state.firstname,\r\n          lastname: this.state.lastname,\r\n        },\r\n        { headers }\r\n      )\r\n        .then((res) => {\r\n          if (res.data.success === true) {\r\n            console.log(\"Registration successful!\");\r\n            this.setState({\r\n              registerSuccess:\r\n                \"Your account has been created! You can now log in\",\r\n              email: \"\",\r\n              password: \"\",\r\n              password2: \"\",\r\n              firstname: \"\",\r\n              lastname: \"\",\r\n              showRegister: false,\r\n              showLogin: true,\r\n            });\r\n          } else {\r\n            console.log(\"Registration failed :(\");\r\n            this.setState({\r\n              registerMessage: \"This email address is already registered\",\r\n            });\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(\"error\");\r\n          throw err;\r\n        });\r\n    }\r\n  };\r\n\r\n  getStyleLogin = () => {\r\n    return {\r\n      display: this.state.showLogin ? \"block\" : \"none\",\r\n    };\r\n  };\r\n\r\n  getStyleRegister = () => {\r\n    return {\r\n      display: this.state.showRegister ? \"block\" : \"none\",\r\n    };\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div class=\"topnav\">\r\n        {this.props.active == 0 ? (\r\n          <a class=\"active\" href=\"/WaysToGo/\">\r\n            WaysToGo\r\n          </a>\r\n        ) : (\r\n          <a href=\"/WaysToGo/\">WaysToGo</a>\r\n        )}\r\n        {/*this.props.active == 2 ? (\r\n          <a class=\"active\" href=\"#contact\">\r\n            Contact\r\n          </a>\r\n        ) : (\r\n          <a href=\"#contact\">Contact</a>\r\n        )*/}\r\n        {this.props.active == 3 ? (\r\n          <a class=\"active\" href=\"?show=about\">\r\n            About\r\n          </a>\r\n        ) : (\r\n          <a href=\"?show=about\">About</a>\r\n        )}\r\n        {this.props.connected ? (\r\n          <a class={this.props.active == 1 ? \"active\" : \"\"} href=\"?show=save\">\r\n            Add a Trip\r\n          </a>\r\n        ) : (\r\n          <span></span>\r\n        )}\r\n        {this.props.connected ? (\r\n          <a\r\n            class={this.props.active == 4 ? \"active\" : \"\"}\r\n            href=\"?show=profile\"\r\n          >\r\n            Profile\r\n          </a>\r\n        ) : (\r\n          <div>\r\n            <a class=\"connection\" onClick={this.showLogin}>\r\n              Login\r\n            </a>\r\n\r\n            <a class=\"connection\" onClick={this.showRegister}>\r\n              Register\r\n            </a>\r\n          </div>\r\n        )}\r\n        {this.props.connected ? (\r\n          <a href=\"?logout=true\">Logout</a>\r\n        ) : (\r\n          <span></span>\r\n        )}\r\n        {this.props.active == 5 ? (\r\n          <a class=\"active\" href={\"?show=research\"}>\r\n            {\" \"}\r\n            Recherche{\" \"}\r\n          </a>\r\n        ) : (\r\n          <a href={\"?show=research\"}>Recherche</a>\r\n        )}\r\n        {this.props.connected ? (\r\n          <a\r\n            class={this.props.active == 6 ? \"active\" : \"\"}\r\n            href=\"?show=settings\"\r\n          >\r\n            Settings\r\n          </a>\r\n        ) : (\r\n          <span></span>\r\n        )}\r\n\r\n        <div id=\"login\" style={this.getStyleLogin()}>\r\n          <p>{this.state.registerSuccess}</p>\r\n          <p>Email</p>\r\n          <input\r\n            type=\"text\"\r\n            name=\"email\"\r\n            onChange={this.onChange}\r\n            value={this.state.email}\r\n            placeholder=\"john.doe@mail.com\"\r\n          />\r\n\r\n          <p>Password</p>\r\n          <input\r\n            type=\"password\"\r\n            name=\"password\"\r\n            onChange={this.onChange}\r\n            value={this.state.password}\r\n          />\r\n\r\n          <input\r\n            type=\"submit\"\r\n            name=\"submit\"\r\n            value=\"Login\"\r\n            onClick={this.onSubmitLogin}\r\n          />\r\n        </div>\r\n\r\n        <div id=\"register\" style={this.getStyleRegister()}>\r\n          <p>{this.state.registerMessage}</p>\r\n          <p>Email</p>\r\n          <input\r\n            type=\"text\"\r\n            name=\"email\"\r\n            onChange={this.onChange}\r\n            value={this.state.email}\r\n            placeholder=\"ex. john.doe@mail.com\"\r\n          />\r\n\r\n          <p>Firstname</p>\r\n          <input\r\n            type=\"text\"\r\n            name=\"firstname\"\r\n            onChange={this.onChange}\r\n            value={this.state.firstname}\r\n            placeholder=\"ex. John\"\r\n          />\r\n\r\n          <p>Lastname</p>\r\n          <input\r\n            type=\"text\"\r\n            name=\"lastname\"\r\n            onChange={this.onChange}\r\n            value={this.state.lastname}\r\n            placeholder=\"ex. Doe\"\r\n          />\r\n\r\n          <p>Password</p>\r\n          <input\r\n            type=\"password\"\r\n            name=\"password\"\r\n            onChange={this.onChange}\r\n            value={this.state.password}\r\n          />\r\n\r\n          <p>Confirm Password</p>\r\n          <input\r\n            type=\"password\"\r\n            name=\"password2\"\r\n            onChange={this.onChange}\r\n            value={this.state.password2}\r\n          />\r\n\r\n          <input\r\n            type=\"submit\"\r\n            name=\"submit\"\r\n            value=\"Login\"\r\n            onClick={this.onSubmitRegister}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport \"./App.css\";\r\n\r\n// Gere l'ajout d'image et l'affichage. https://stackoverflow.com/questions/38049966/get-image-preview-before-uploading-in-react\r\nexport default class Upload extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props)\r\n\t\tthis.state = {\r\n\t\t\tfiles: props.files, // contient l'ensemble des images. Vide initialement. On passe la rfrence\r\n\t\t\tfilesToShow: []\r\n\t\t}\r\n\r\n\t\tthis.handleChange = this.handleChange.bind(this);\r\n\t\tthis.id = Math.random();\r\n\t}\r\n\r\n\t// when we get images\r\n\thandleChange(event) {\r\n\t\tthis.props.changeButtonState(true);\r\n\t\tthis.setState({\r\n\t\t\tfilesToShow: [...this.state.filesToShow, ...event.target.files] // ajout des nouvelles images a ceux deja existantes\r\n\t\t});\r\n\r\n\t\tvar parentUpload = this;\r\n\t\tvar totalEndUpload = 0; // on desactive le bouton d'envoi. Quand toutes les images sont uploades en ligne (totalEndUpload == images.length) on r-active le bouton\r\n\t\tvar images = event.target.files;\r\n\t\t[...event.target.files].map(function (file) {\r\n\t\t\t// senf img to imgbb for saving\r\n\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\tvar img = file;\r\n\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\r\n\t\t\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\t\t\tif (this.readyState === 4 && this.status === 201) {\r\n\t\t\t\t\t\t\tconsole.log(\"Upload photo in API : success\");\r\n\r\n\t\t\t\t\t\t\tparentUpload.props.addImgFile({ image: img, image_URL_BDD: \"/api/photos/\" + JSON.parse(this.responseText).id });\r\n\t\t\t\t\t\t\ttotalEndUpload += 1;\r\n\t\t\t\t\t\t\tif (totalEndUpload == images.length) {\r\n\t\t\t\t\t\t\t\tparentUpload.props.changeButtonState(false);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\txhttp.open(\"POST\", \"https://wtg.aymerik-diebold.fr/api/photos\", true);\r\n\t\t\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + parentUpload.props.token);\r\n\t\t\t\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\t\t\txhttp.send(JSON.stringify({\r\n\t\t\t\t\t\tpath: JSON.parse(this.responseText).data.link,\r\n\t\t\t\t\t\t//stage: parentVoyage.newDepartureTransport.current.value,\r\n\t\t\t\t\t\tisCover: false\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\txhttp.open(\"POST\", \"https://api.imgur.com/3/image\", true);\r\n\t\t\txhttp.setRequestHeader('Authorization', 'Client-ID 140f137c33f88ac');\r\n\r\n\t\t\tvar data = new FormData();\r\n\t\t\tdata.append('image', file);\r\n\t\t\txhttp.send(data);\r\n\t\t})\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<div ref={this.props.imgcontainer}>\r\n\t\t\t\t\t{/* Display all selected images. */}\r\n\t\t\t\t\t{this.state.filesToShow && [...this.state.filesToShow].map((file, i) => (\r\n\t\t\t\t\t\t<img key={i} width=\"200px\" height=\"200px\" src={URL.createObjectURL(file)} alt=\"Image\" />\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t\t<input id={this.props.uploadID + this.id} style={{ display: \"none\"}} ref={this.props.refInput} type=\"file\" accept=\"image/*\" multiple onChange={this.handleChange} />\r\n\t\t\t\t<label for={this.props.uploadID + this.id} class=\"custom-file-upload\">\r\n\t\t\t\t\tAdd images to this step\r\n\t\t\t\t</label>\r\n\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\n\r\n// Gere la recherche des villes/adresses dans la popup add new Voyage\r\nexport default class ResearchBarCity extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props)\r\n\r\n\t\tthis.researchRef = React.createRef();\r\n\t}\r\n\r\n\t// Autocomplete for form\r\n\thinter(event) {\r\n\t\t// save change\r\n\t\tthis.props.getdataback(0, 0);\r\n\r\n\t\t// minimum number of characters before we start to generate suggestions\r\n\t\tif (event.target.value.length < 2) return;\r\n\t\telse {\r\n\r\n\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\tvar parentV = this;\r\n\r\n\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\r\n\t\t\t\t\t// We're expecting a json response so we convert it to an object\r\n\t\t\t\t\tvar response = JSON.parse(this.responseText);\r\n\r\n\t\t\t\t\t// clear any previously loaded options in the datalist\r\n\t\t\t\t\tparentV.researchRef.current.innerHTML = \"\";\r\n\r\n\t\t\t\t\tresponse.forEach(function (item) {\r\n\t\t\t\t\t\tvar option = document.createElement('div');\r\n\r\n\t\t\t\t\t\toption.innerText = item.display_name;\r\n\t\t\t\t\t\t// add onclick event : we fill the input\r\n\t\t\t\t\t\toption.onclick = function () {\r\n\t\t\t\t\t\t\tparentV.props.refCity.current.value = this.innerText;\r\n\t\t\t\t\t\t\tparentV.props.getdataback(parseFloat(item.lat), parseFloat(item.lon));\r\n\t\t\t\t\t\t\tparentV.researchRef.current.innerHTML = \"\";\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t// attach the div to the list div\r\n\t\t\t\t\t\tparentV.researchRef.current.appendChild(option);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// we use nominatim from openstreetmap to resolve adress\r\n\t\t\txhttp.open(\"GET\", \"https://nominatim.openstreetmap.org/?addressdetails=1&format=json&limit=3&q=\" + this.props.refCity.current.value, true);\r\n\t\t\txhttp.send()\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<input ref={this.props.refCity} type=\"text\" name=\"lville\" placeholder=\"Place..\" id=\"name_input\" onKeyPress={this.hinter.bind(this)} />\r\n\t\t\t\t<div ref={this.researchRef} id=\"huge_list\"></div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport Upload from \"./Upload\";\r\nimport ResearchBarCity from \"./ResearchBarCity\";\r\n\r\n\r\n// show a button : delete trip when clicked\r\n// parameters : id (the id of trip to be delete) + token\r\n// return to the main page after deletion\r\nexport class ButtonDeleteTrip extends Component {\r\n\tdeleteTrip() {\r\n\t\tvar response = window.confirm(\"Delete ?\");\r\n\t\tif (response == true) {\r\n\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\tif (this.readyState === 4 && this.status === 204) {\r\n\t\t\t\t\twindow.location = \"https://ways-to-go.github.io/WaysToGo/\"; // return to hostpage\r\n\t\t\t\t\t//window.location = window.location.hostname;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\txhttp.open(\"DELETE\", \"https://wtg.aymerik-diebold.fr/api/trips/\" + this.props.id, true);\r\n\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + this.props.token);\r\n\t\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\txhttp.send();\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<button type=\"button\" onClick={this.deleteTrip.bind(this)}>Delete step</button>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nclass EditStep extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t//console.log(props);\r\n\t\tthis.state = {\r\n\t\t\tfiles: [],\r\n\t\t\t//title: props.step.title,\r\n\t\t\t//city: props.step.city,\r\n\t\t\t//arrival: props.step.arrival,\r\n\t\t\t//departure: props.step.departure,\r\n\t\t\t//departureTransport: props.step.departureTransport.type,\r\n\t\t\t//description: props.step.description,\r\n\t\t\tid: props.step.id,\r\n\t\t\tphotos: props.step.photos\r\n\t\t};\r\n\t\tif (props.step.departureTransport && props.step.departureTransport !== 'undefined')\r\n\t\t\tthis.state.departureTransport = props.step.departureTransport.type;\r\n\r\n\t\tthis.editFunction = this.editFunction.bind(this);\r\n\t\tthis.getLatLnt = this.getLatLnt.bind(this);\r\n\t\tthis.addImgFile = this.addImgFile.bind(this)\r\n\r\n\t\tthis.newCity = React.createRef();\r\n\t\tthis.newName = React.createRef();\r\n\t\tthis.newDate = React.createRef();\r\n\t\tthis.newDateDepart = React.createRef();\r\n\t\tthis.newDepartureTransport = React.createRef();\r\n\t\tthis.newDescription = React.createRef();\r\n\r\n\t\tthis.newLat = React.createRef();\r\n\t\tthis.newLnt = React.createRef();\r\n\t\tthis.boutonOK = React.createRef();\r\n\t\tthis.modal = React.createRef();\r\n\r\n\t\tthis.refHead = React.createRef();\r\n\r\n\t\tthis.imgcontainer = React.createRef();\r\n\t\tthis.inputphotoToReset = React.createRef();\r\n\r\n\t\tthis.toggleModal = this.toggleModal.bind(this);\r\n\t}\r\n\r\n\teditFunction() {\r\n\t\t// si l'utilisateur met de nouvelles photos, on change tout. Si il n'en met pas de nouvelles, on laisse les anciennes\r\n\t\tvar listformat = [];\r\n\t\tif (this.props.reload) {\r\n\t\t\tif (this.state.files.length > 0) listformat = this.state.files;\r\n\t\t\telse listformat = this.props.photos;\r\n\t\t} else {\r\n\t\t\tif (this.state.files.length > 0)\r\n\t\t\t\tthis.state.files.forEach(function (item) {\r\n\t\t\t\t\tlistformat.push(item.image_URL_BDD);\r\n\t\t\t\t});\r\n\t\t\telse listformat = this.props.photos;\r\n\t\t}\r\n\r\n\t\t// si l'utilisateur met de nouvelles photos, on change tout. Si il n'en met pas de nouvelles, on laisse les anciennes\r\n\t\t/*var listformat = [];\r\n\t\tif (this.state.files.length > 0) listformat = this.state.files;\r\n\t\telse listformat = this.props.photos;*/\r\n\r\n\t\tvar xhttp = new XMLHttpRequest();\r\n\t\tvar parentVoyage = this;\r\n\t\txhttp.onreadystatechange = function () {\r\n\t\t\t//console.log(this.responseText);\r\n\t\t\tvar res = this.responseText;\r\n\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\t// maintenant on envoi le transport\r\n\t\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\t\t\t//console.log(\"here\");\r\n\t\t\t\t\t\tres = JSON.parse(res);\r\n\t\t\t\t\t\tres.departureTransport = { \"type\": parentVoyage.newDepartureTransport.current.value };\r\n\t\t\t\t\t\t//console.log(parentVoyage.newDepartureTransport.current.value);\r\n\t\t\t\t\t\t//console.log(parentVoyage.newDepartureTransport);\r\n\t\t\t\t\t\tif (parentVoyage.props.reload) document.location.reload(true); //reload page to see modifications\r\n\t\t\t\t\t\telse parentVoyage.props.callback({\r\n\t\t\t\t\t\t\tcity: parentVoyage.newCity.current.value,\r\n\t\t\t\t\t\t\tdescription: parentVoyage.newDescription.current.value,\r\n\t\t\t\t\t\t\tarrival: parentVoyage.newDate.current.value,\r\n\t\t\t\t\t\t\tdeparture: parentVoyage.newDateDepart.current.value,\r\n\t\t\t\t\t\t\ttitle: parentVoyage.newName.current.value,\r\n\t\t\t\t\t\t\tdepartureTransport: { 'type': parentVoyage.newDepartureTransport.current.value },\r\n\t\t\t\t\t\t\tphotos: parentVoyage.state.files,\r\n\t\t\t\t\t\t\tetape: res\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t//parentVoyage.toggleModal();\r\n\t\t\t\t\t\tparentVoyage.closeModal();\r\n\t\t\t\t\t\t//document.location.reload(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\txhttp.open(\"PATCH\", \"https://wtg.aymerik-diebold.fr\" + JSON.parse(res).departureTransport, true);\r\n\t\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + parentVoyage.props.token);\r\n\t\t\t\txhttp.setRequestHeader('Content-Type', 'application/merge-patch+json');\r\n\t\t\t\txhttp.send(JSON.stringify({\r\n\t\t\t\t\tstageFrom: \"/api/stages/\" + JSON.parse(res).id,\r\n\t\t\t\t\ttype: parentVoyage.newDepartureTransport.current.value,\r\n\t\t\t\t\tdistance: 0\r\n\t\t\t\t}));\r\n\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\txhttp.open(\"PATCH\", \"https://wtg.aymerik-diebold.fr/api/stages/\" + this.state.id, true);\r\n\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + this.props.token);\r\n\t\txhttp.setRequestHeader('Content-Type', 'application/merge-patch+json');\r\n\t\txhttp.send(JSON.stringify({\r\n\t\t\tcity: this.newCity.current.value,\r\n\t\t\tcountry: \"rien\",\r\n\t\t\tmark: 0,\r\n\t\t\tdescription: this.newDescription.current.value,\r\n\t\t\tarrival: this.newDate.current.value,\r\n\t\t\tdeparture: this.newDateDepart.current.value,\r\n\t\t\tlng: this.state.newLat,\r\n\t\t\tlat: this.state.newLnt,\r\n\t\t\ttitle: this.newName.current.value,\r\n\t\t\tphotos: listformat\r\n\t\t}));\r\n\t}\r\n\r\n\tdeleteFunction() {\r\n\t\tvar xhttp = new XMLHttpRequest();\r\n\t\tvar parentVoyage = this;\r\n\t\txhttp.onreadystatechange = function () {\r\n\t\t\t//console.log(this.responseText);\r\n\t\t\t//var res = this.responseText;\r\n\t\t\tif (this.readyState === 4 && this.status === 204) {\r\n\t\t\t\tif (parentVoyage.props.reload) document.location.reload(true); //reload page to see modifications\r\n\t\t\t\t//else parentVoyage.props.callback(true);\r\n\t\t\t\tparentVoyage.toggleModal();\r\n\t\t\t\t//document.location.reload(true);\r\n\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\txhttp.open(\"DELETE\", \"https://wtg.aymerik-diebold.fr/api/stages/\" + this.state.id, true);\r\n\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + this.props.token);\r\n\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\txhttp.send();\r\n\t}\r\n\r\n\tgetLatLnt(lat, lnt) {\r\n\t\tthis.setState({\r\n\t\t\tnewLnt: lnt,\r\n\t\t\tnewLat: lat\r\n\t\t})\r\n\t}\r\n\r\n\r\n\r\n\t// to edit pictures\r\n\r\n\taddImgFile(img) {\r\n\t\tif (this.props.reload) this.state.files.push(img.image_URL_BDD);\r\n\t\telse this.state.files.push(img);\r\n\t}\r\n\tchangeButtonState(etat) {\r\n\t\tthis.boutonOK.current.disabled = etat;\r\n\t\tif (etat === true) this.boutonOK.current.textContent = \"Image upload in progress...\"\r\n\t\telse this.boutonOK.current.textContent = \"Edit step\"\r\n\t}\r\n\tcloseModal() {\r\n\t\t// toggle modal\r\n\t\tthis.modal.current.classList.toggle(\"show-modal\");\r\n\t}\r\n\r\n\ttoggleModal() {\r\n\t\t// change values inside the modal\r\n\t\t//console.log(this.props.step);\r\n\t\tthis.newName.current.value = this.props.step.title;\r\n\t\tthis.newCity.current.value = this.props.step.city;\r\n\t\tthis.newDate.current.value = this.props.step.arrival;\r\n\t\tthis.newDateDepart.current.value = this.props.step.departure;\r\n\t\tthis.newDepartureTransport.current.value = this.props.step.departureTransport.type;\r\n\t\tthis.newDescription.current.value = this.props.step.description;\r\n\r\n\t\t//console.log(this.newCity.current.value);\r\n\r\n\t\t// toggle modal\r\n\t\tthis.modal.current.classList.toggle(\"show-modal\");\r\n\t}\r\n\r\n\t// render the modal\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<div ref={this.modal} class=\"modal2\">\r\n\t\t\t\t\t<div class=\"modal-content\">\r\n\t\t\t\t\t\t<span class=\"close-button\" onClick={this.toggleModal}></span>\r\n\r\n\t\t\t\t\t\t<label for=\"lville\">Location</label>\r\n\t\t\t\t\t\t<ResearchBarCity refCity={this.newCity} getdataback={this.getLatLnt} newLat={this.newLat} newLnt={this.newLnt} />\r\n\r\n\t\t\t\t\t\t<label for=\"nometape\">Step name</label>\r\n\t\t\t\t\t\t<input ref={this.newName} type=\"text\" id=\"nometape\" name=\"nometape\" placeholder=\"ex. visit of the Eiffel tower\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"larrivee\">Arrival date</label>\r\n\t\t\t\t\t\t<input ref={this.newDate} type=\"text\" id=\"larrivee\" name=\"larrivee\" placeholder=\"Arrival.. (YYYY-MM-DD)\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ldepart\">Departure date</label>\r\n\t\t\t\t\t\t<input ref={this.newDateDepart} type=\"text\" id=\"ldepart\" name=\"ldepart\" placeholder=\"Departure.. (YYYY-MM-DD)\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ltransport\">Moyen de transport entre tapes</label>\r\n\t\t\t\t\t\t<input ref={this.newDepartureTransport} type=\"text\" id=\"ltransport\" name=\"ltransport\" placeholder=\"Train, car, tuk-tuk, on foot ..\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ldescription\">Your story</label>\r\n\t\t\t\t\t\t<textarea ref={this.newDescription} id=\"ldescription\" name=\"ldescription\" placeholder=\"What you want..\"></textarea>\r\n\r\n\t\t\t\t\t\t<Upload key={\"editStep\" + this.props.stepKey} uploadID={\"editStep\" + this.props.stepKey} token={this.props.token} addImgFile={this.addImgFile} files={this.state.files} changeButtonState={this.changeButtonState.bind(this)} imgcontainer={this.imgcontainer} refInput={this.inputphotoToReset} />\r\n\r\n\t\t\t\t\t\t<button type=\"button\" ref={this.boutonOK} onClick={this.editFunction.bind(this)}>Edit step</button>\r\n\t\t\t\t\t\t<button type=\"button\" ref={this.boutonDelete} onClick={this.deleteFunction.bind(this)}>Delete step</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<button type=\"button\" onClick={this.toggleModal}>Edit step</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default EditStep;\r\n","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport Upload from \"./Upload\";\r\nimport ResearchBarCity from \"./ResearchBarCity\";\r\n\r\n// affiche une popup permettant de modifier un voyage donn/\r\n// reload la page si modification\r\n/*\r\n * si parametre reload=false, alors il faut fournir une methode callback qui renverra les parametres\r\n */\r\nexport default class AddStep extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tfiles: []\r\n\t\t};\r\n\r\n\t\tthis.addFunction = this.addFunction.bind(this);\r\n\t\tthis.getLatLnt = this.getLatLnt.bind(this);\r\n\t\tthis.addImgFile = this.addImgFile.bind(this);\r\n\t\tthis.toggleModal = this.toggleModal.bind(this);\r\n\r\n\t\tthis.newCity = React.createRef();\r\n\t\tthis.newName = React.createRef();\r\n\t\tthis.newDate = React.createRef();\r\n\t\tthis.newDateDepart = React.createRef();\r\n\t\tthis.newDepartureTransport = React.createRef();\r\n\t\tthis.newDescription = React.createRef();\r\n\r\n\t\tthis.newLat = React.createRef();\r\n\t\tthis.newLnt = React.createRef();\r\n\t\tthis.boutonOK2 = React.createRef();\r\n\t\tthis.modal = React.createRef();\r\n\t\tthis.imgcontainer2 = React.createRef();\r\n\t\tthis.inputphotoToReset = React.createRef();\r\n\t}\r\n\r\n\t// add a new step to a trip.\r\n\t// create the step, then add the transportation\r\n\taddFunction() {\r\n\t\tif (this.newName.current.value != \"\" && this.newDate.current.value != \"\"\r\n\t\t\t&& this.newDateDepart.current.value != \"\" && this.newCity.current.value != \"\") {\r\n\r\n\t\t\t// si l'utilisateur met de nouvelles photos, on change tout. Si il n'en met pas de nouvelles, on laisse les anciennes\r\n\t\t\tvar listformat = [];\r\n\t\t\tif (this.props.reload) {\r\n\t\t\t\tif (this.state.files.length > 0) listformat = this.state.files;\r\n\t\t\t\telse listformat = this.props.photos;\r\n\t\t\t} else {\r\n\t\t\t\tif (this.state.files.length > 0)\r\n\t\t\t\t\tthis.state.files.forEach(function (item) {\r\n\t\t\t\t\t\tlistformat.push(item.image_URL_BDD);\r\n\t\t\t\t\t});\r\n\t\t\t\telse listformat = this.props.photos;\r\n\t\t\t}\r\n\r\n\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\tvar parentVoyage = this;\r\n\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\tvar res = this.responseText;\r\n\t\t\t\tif (this.readyState === 4 && this.status === 201) {\r\n\t\t\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\t\t\t//console.log(res);\r\n\t\t\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\t\t\tif (this.readyState === 4 && this.status === 201) {\r\n\t\t\t\t\t\t\tif (parentVoyage.props.reload) document.location.reload(true); //reload page to see modifications\r\n\t\t\t\t\t\t\telse parentVoyage.props.callback({\r\n\t\t\t\t\t\t\t\tcity: parentVoyage.newCity.current.value,\r\n\t\t\t\t\t\t\t\tdescription: parentVoyage.newDescription.current.value,\r\n\t\t\t\t\t\t\t\tarrival: parentVoyage.newDate.current.value,\r\n\t\t\t\t\t\t\t\tdeparture: parentVoyage.newDateDepart.current.value,\r\n\t\t\t\t\t\t\t\ttitle: parentVoyage.newName.current.value,\r\n\t\t\t\t\t\t\t\ttransport: parentVoyage.newDepartureTransport.current.value,\r\n\t\t\t\t\t\t\t\tphotos: parentVoyage.state.files,\r\n\t\t\t\t\t\t\t\tetape: res\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tparentVoyage.toggleModal();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\txhttp.open(\"POST\", \"https://wtg.aymerik-diebold.fr/api/transports\", true);\r\n\t\t\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + parentVoyage.props.token);\r\n\t\t\t\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\t\t\txhttp.send(JSON.stringify({\r\n\t\t\t\t\t\tstageFrom: \"/api/stages/\" + JSON.parse(res).id,\r\n\t\t\t\t\t\ttype: parentVoyage.newDepartureTransport.current.value,\r\n\t\t\t\t\t\tdistance: 0\r\n\t\t\t\t\t}));\r\n\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\txhttp.open(\"POST\", \"https://wtg.aymerik-diebold.fr/api/stages\", true);\r\n\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + this.props.token);\r\n\t\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\txhttp.send(JSON.stringify({\r\n\t\t\t\tcity: this.newCity.current.value,\r\n\t\t\t\tcountry: \"rien\",\r\n\t\t\t\tmark: 0,\r\n\t\t\t\tdescription: this.newDescription.current.value,\r\n\t\t\t\tarrival: this.newDate.current.value,\r\n\t\t\t\tdeparture: this.newDateDepart.current.value,\r\n\t\t\t\ttrip: \"/api/trips/\" + this.props.tripId,\r\n\t\t\t\tlng: this.state.newLat,\r\n\t\t\t\tlat: this.state.newLnt,\r\n\t\t\t\ttitle: this.newName.current.value,\r\n\t\t\t\tphotos: listformat\r\n\t\t\t}));\r\n\t\t} else alert(\"Location, name, arrival and departure date required\");\r\n\t}\r\n\r\n\tgetLatLnt(lat, lnt) {\r\n\t\tthis.setState({\r\n\t\t\tnewLnt: lnt,\r\n\t\t\tnewLat: lat\r\n\t\t})\r\n\t}\r\n\r\n\t// to edit pictures\r\n\taddImgFile(img) {\r\n\t\tconsole.log(img);\r\n\t\tif (this.props.reload) this.state.files.push(img.image_URL_BDD);\r\n\t\telse this.state.files.push(img);\r\n\t}\r\n\tchangeButtonState(etat) {\r\n\t\tthis.boutonOK2.current.disabled = etat; // disable button when upload, prevent button to be push until we have the ling of the image\r\n\t\tif (etat === true) this.boutonOK2.current.textContent = \"Image upload in progress...\"\r\n\t\telse this.boutonOK2.current.textContent = \"Add step\"\r\n\t}\r\n\r\n\t// show or hide modal\r\n\ttoggleModal() {\r\n\t\tconsole.log(\"toggle modal edit\");\r\n\r\n\t\t// change values inside the modal\r\n\t\tthis.newName.current.value = \"\";\r\n\t\tthis.newCity.current.value = \"\";\r\n\t\tthis.newDate.current.value = \"\";\r\n\t\tthis.newDateDepart.current.value = \"\";\r\n\t\tthis.newDepartureTransport.current.value = \"\";\r\n\t\tthis.newDescription.current.value = \"\";\r\n\t\tthis.state.files = [];\r\n\r\n\t\t// toggle modal\r\n\t\tthis.modal.current.classList.toggle(\"show-modal3\");\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<div ref={this.modal} class=\"modal3\">\r\n\t\t\t\t\t<div class=\"modal-content\">\r\n\t\t\t\t\t\t<h5>Add Step</h5>\r\n\t\t\t\t\t\t<span class=\"close-button\" onClick={this.toggleModal}></span>\r\n\r\n\t\t\t\t\t\t<label for=\"lville\">Location</label>\r\n\t\t\t\t\t\t<ResearchBarCity refCity={this.newCity} getdataback={this.getLatLnt} newLat={this.newLat} newLnt={this.newLnt} />\r\n\r\n\t\t\t\t\t\t<label for=\"nometape\">Step name</label>\r\n\t\t\t\t\t\t<input ref={this.newName} type=\"text\" id=\"nometape\" name=\"nometape\" placeholder=\"ex. visit of the Eiffel tower\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"larrivee\">Arrival date</label>\r\n\t\t\t\t\t\t<input ref={this.newDate} type=\"text\" id=\"larrivee\" name=\"larrivee\" placeholder=\"Arrival.. (YYYY-MM-DD)\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ldepart\">Departure date</label>\r\n\t\t\t\t\t\t<input ref={this.newDateDepart} type=\"text\" id=\"ldepart\" name=\"ldepart\" placeholder=\"Departure.. (YYYY-MM-DD)\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ltransport\">Means of transport between steps</label>\r\n\t\t\t\t\t\t<input ref={this.newDepartureTransport} type=\"text\" id=\"ltransport\" name=\"ltransport\" placeholder=\"Train, car, tuk-tuk, on foot ..\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ldescription\">Your story</label>\r\n\t\t\t\t\t\t<textarea ref={this.newDescription} id=\"ldescription\" name=\"ldescription\" placeholder=\"What you want..\"></textarea>\r\n\r\n\t\t\t\t\t\t<Upload key={\"addStep\" + this.props.stepKey} uploadID={\"addStep\"} token={this.props.token} addImgFile={this.addImgFile} files={this.state.files} changeButtonState={this.changeButtonState.bind(this)} imgcontainer={this.imgcontainer2} refInput={this.inputphotoToReset} />\r\n\r\n\t\t\t\t\t\t<button type=\"button\" ref={this.boutonOK2} onClick={this.addFunction.bind(this)}>Add step</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<button type=\"button\" onClick={this.toggleModal}>Add step</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport { Map, TileLayer, Marker, Popup } from \"react-leaflet\";\r\nimport NavigationBar from \"./NavigationBar\";\r\nimport Axios from \"axios\";\r\nimport EditStep, { ButtonDeleteTrip } from \"./editStep.js\";\r\nimport AddStep from \"./addStep.js\";\r\n\r\n// show the head of the trip\r\n/* Need a parameter param like :\r\n * param = {\r\n * title = string\r\n * ?startdate = string in a good date format (aaaa-mm-dd)\r\n * vegan = bool\r\n * ecological = bool\r\n * author {\r\n *\t\tfirstName = string\r\n *\t\tlastName = string\r\n *\t}\r\n *\tstages = list of stage\r\n * }\r\n */\r\nexport class EnteteVoyage extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tparam: props.param,\r\n\t\t};\r\n\r\n\t\tthis.saveTripButton = React.createRef();\r\n\t\tthis.verifIfTripAlreadySaved = this.verifIfTripAlreadySaved.bind(this);\r\n\r\n\t\tthis.monthNames = [\r\n\t\t\t\"January\",\r\n\t\t\t\"February\",\r\n\t\t\t\"March\",\r\n\t\t\t\"April\",\r\n\t\t\t\"May\",\r\n\t\t\t\"June\",\r\n\t\t\t\"July\",\r\n\t\t\t\"August\",\r\n\t\t\t\"September\",\r\n\t\t\t\"October\",\r\n\t\t\t\"November\",\r\n\t\t\t\"December\",\r\n\t\t];\r\n\r\n\t}\r\n\r\n\t/* TODO :\r\n\t * qui retourne le nombre de photos\r\n\t * qui retourne le nombre de pays ou passe le voyage\r\n\t */\r\n\r\n\tgetStageNumber(etapes) {\r\n\t\treturn etapes.length;\r\n\t}\r\n\r\n\t// retourne le mois de debut\r\n\tgetDateDebut(etapes) {\r\n\t\tif (etapes.length > 0) {\r\n\t\t\tvar d = new Date(etapes[0].departure);\r\n\t\t\treturn this.monthNames[d.getMonth()];\r\n\t\t} else return null;\r\n\t}\r\n\r\n\t// retourne le mois de fin\r\n\tgetDateFin(etapes) {\r\n\t\tif (etapes.length > 0) {\r\n\t\t\tvar d = new Date(etapes[etapes.length - 1].arrival);\r\n\t\t\treturn this.monthNames[d.getMonth()];\r\n\t\t} else return 0;\r\n\t}\r\n\r\n\t// retourne le nombre de jours\r\n\tgetDureeVoyage1(etapes) {\r\n\t\tif (etapes.length > 0) {\r\n\t\t\tvar d =\r\n\t\t\t\tnew Date(etapes[etapes.length - 1].arrival) -\r\n\t\t\t\tnew Date(etapes[0].departure);\r\n\t\t\tconst diffDays = Math.ceil(d / (1000 * 60 * 60 * 24)) + 1;\r\n\t\t\treturn diffDays;\r\n\t\t} else return 0;\r\n\t}\r\n\r\n\tgetDureeVoyage2(date1, date2) {\r\n\t\tvar d = new Date(date2) - new Date(date1);\r\n\t\tconst diffDays = Math.ceil(d / (1000 * 60 * 60 * 24)) + 1;\r\n\t\treturn diffDays;\r\n\t}\r\n\r\n\t// renvoi la date a afficher (mois - mois)\r\n\tgetMonthsDate1(etapes) {\r\n\t\tif (etapes.length > 0) {\r\n\t\t\tvar d = this.getDateDebut(etapes);\r\n\t\t\tvar a = this.getDateFin(etapes);\r\n\t\t\tif (d !== a)\r\n\t\t\t\treturn this.getDateDebut(etapes) + \" - \" + this.getDateFin(etapes);\r\n\t\t\telse return d;\r\n\t\t} else return \"\";\r\n\t}\r\n\r\n\tgetMonthsDate2(date1, date2) {\r\n\t\tvar d = new Date(date1);\r\n\t\tvar a = new Date(date2);\r\n\t\tif (d.getMonth() !== a.getMonth())\r\n\t\t\treturn (\r\n\t\t\t\tthis.monthNames[d.getMonth()] + \" - \" + this.monthNames[a.getMonth()]\r\n\t\t\t);\r\n\t\telse return this.monthNames[d.getMonth()];\r\n\t}\r\n\r\n\t// from StackOverflow\r\n\tgetCookie(cname) {\r\n\t\tvar name = cname + \"=\";\r\n\t\tvar decodedCookie = decodeURIComponent(document.cookie);\r\n\t\tvar ca = decodedCookie.split(';');\r\n\t\tfor (var i = 0; i < ca.length; i++) {\r\n\t\t\tvar c = ca[i];\r\n\t\t\twhile (c.charAt(0) == ' ') {\r\n\t\t\t\tc = c.substring(1);\r\n\t\t\t}\r\n\t\t\tif (c.indexOf(name) == 0) {\r\n\t\t\t\treturn c.substring(name.length, c.length);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tverifIfTripAlreadySaved() {\r\n\t\t// if I'm connected : show the button save/de-save.\r\n\t\tif (this.props.connected) {\r\n\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\tvar superThis = this;\r\n\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\t\tsuperThis.saveTripButton.current.style.visibility = \"visible\";\r\n\r\n\t\t\t\t\tvar listformat = [];\r\n\t\t\t\t\t//console.log(JSON.parse(this.responseText));\r\n\t\t\t\t\tJSON.parse(this.responseText).recordedTrips.forEach(function (item) {\r\n\t\t\t\t\t\tlistformat.push(item[\"@id\"]);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (listformat.indexOf(\"/api/trips/\" + superThis.props.param.id) === -1) {\r\n\t\t\t\t\t\tsuperThis.saveTripButton.current.innerHTML = \"Save this trip\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tsuperThis.saveTripButton.current.innerHTML = \"Trip already saved :) Click to cancel\";\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\txhttp.open(\"GET\", \"https://wtg.aymerik-diebold.fr/api/users/\" + superThis.getCookie(\"id\"), true);\r\n\t\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + superThis.props.token);\r\n\t\t\txhttp.send();\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.verifIfTripAlreadySaved();\r\n\t};\r\n\r\n\tsaveTrip() {\r\n\t\t//console.log(document.cookie);\r\n\r\n\t\t// we first retrieve user already saved Trips\r\n\t\tvar xhttp = new XMLHttpRequest();\r\n\t\tvar superThis = this;\r\n\t\txhttp.onreadystatechange = function () {\r\n\t\t\t//console.log(this.responseText);\r\n\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\t//console.log(\"SUCCESS\");\r\n\r\n\t\t\t\tvar res = JSON.parse(this.responseText);\r\n\t\t\t\tvar listformat = [];\r\n\t\t\t\tres.recordedTrips.forEach(function (item) {\r\n\t\t\t\t\tlistformat.push(item[\"@id\"]);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// if trip is already saved, we delete it, else we saved it\r\n\t\t\t\tvar index = listformat.indexOf(\"/api/trips/\" + superThis.props.param.id);\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\tif (index > -1) {\r\n\t\t\t\t\t\tlistformat.splice(index, 1);\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tvar xhttp2 = new XMLHttpRequest();\r\n\t\t\t\t\txhttp2.onreadystatechange = function () {\r\n\t\t\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\t\t\t\tsuperThis.saveTripButton.current.innerHTML = \"Save this trip\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\txhttp2.open(\"PATCH\", \"https://wtg.aymerik-diebold.fr/api/users/\" + superThis.getCookie(\"id\"), true);\r\n\t\t\t\t\txhttp2.setRequestHeader('Content-Type', 'application/merge-patch+json');\r\n\t\t\t\t\txhttp2.setRequestHeader('Authorization', 'Bearer ' + superThis.props.token);\r\n\r\n\t\t\t\t\t//console.log([...new Set(listformat)]);\r\n\t\t\t\t\txhttp2.send(JSON.stringify({\r\n\t\t\t\t\t\t\"recordedTrips\": listformat // to onsure each trip is saved only one time\r\n\t\t\t\t\t}));\r\n\r\n\r\n\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t// then we add the new trip to the olders\r\n\t\t\t\t\tvar xhttp2 = new XMLHttpRequest();\r\n\t\t\t\t\txhttp2.onreadystatechange = function () {\r\n\t\t\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\t\t\t\tsuperThis.saveTripButton.current.innerHTML = \"Trip saved :) Click to cancel\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\t//console.log(\"https://wtg.aymerik-diebold.fr/api/users/\" + superThis.getCookie(\"id\"));\r\n\t\t\t\t\txhttp2.open(\"PATCH\", \"https://wtg.aymerik-diebold.fr/api/users/\" + superThis.getCookie(\"id\"), true);\r\n\t\t\t\t\txhttp2.setRequestHeader('Content-Type', 'application/merge-patch+json');\r\n\t\t\t\t\txhttp2.setRequestHeader('Authorization', 'Bearer ' + superThis.props.token);\r\n\r\n\t\t\t\t\tlistformat.push(\"/api/trips/\" + superThis.props.param.id);\r\n\t\t\t\t\t//console.log([...new Set(listformat)]);\r\n\t\t\t\t\txhttp2.send(JSON.stringify({\r\n\t\t\t\t\t\t\"recordedTrips\": listformat // to onsure each trip is saved only one time\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\txhttp.open(\"GET\", \"https://wtg.aymerik-diebold.fr/api/users/\" + this.getCookie(\"id\"), true);\r\n\t\txhttp.setRequestHeader('Content-Type', 'application/merge-patch+json');\r\n\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + this.props.token);\r\n\t\txhttp.send();\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div ref={this.state.param.refHead} id=\"head\">\r\n\t\t\t\t<h2>{this.state.param.title}</h2>\r\n\t\t\t\t<h5>\r\n\t\t\t\t\t{this.state.param.startdate\r\n\t\t\t\t\t\t? \"\"\r\n\t\t\t\t\t\t: this.getMonthsDate1(this.state.param.stages)}\r\n\t\t\t\t</h5>\r\n\t\t\t\t<p class=\"ladescription\">{'\"' + this.state.param.description + '\"'}</p>\r\n\t\t\t\t<p>\r\n\t\t\t\t\t{this.state.param.vegan\r\n\t\t\t\t\t\t? \"This trip is vegan\"\r\n\t\t\t\t\t\t: \"This trip is non-vegan\"}\r\n\t\t\t\t</p>\r\n\t\t\t\t<p>\r\n\t\t\t\t\t{this.state.param.ecological\r\n\t\t\t\t\t\t? \"This trip is ecological\"\r\n\t\t\t\t\t\t: \"This trip is marked as non-ecological\"}\r\n\t\t\t\t</p>\r\n\t\t\t\t<p>\r\n\t\t\t\t\tauteur :{\" \"}\r\n\t\t\t\t\t{this.state.param.author.firstName +\r\n\t\t\t\t\t\t\" \" +\r\n\t\t\t\t\t\tthis.state.param.author.lastName}\r\n\t\t\t\t</p>\r\n\t\t\t\t<p>\r\n\t\t\t\t\tDure du voyage :{\" \"}\r\n\t\t\t\t\t{this.state.param.startdate\r\n\t\t\t\t\t\t? this.getDureeVoyage2(\r\n\t\t\t\t\t\t\tthis.state.param.startdate,\r\n\t\t\t\t\t\t\tthis.state.param.enddate\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t: this.getDureeVoyage1(this.state.param.stages)}{\" \"}\r\n\t\t\t\t\tjours\r\n        </p>\r\n\t\t\t\t{this.state.param.edit ? (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<label for=\"files2\" style={{ border: \"2px solid black\" }}>\r\n\t\t\t\t\t\t\tChange cover image\r\n            </label>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tid=\"files2\"\r\n\t\t\t\t\t\t\tstyle={{ visibility: \"hidden\" }}\r\n\t\t\t\t\t\t\tref={this.state.param.refHead}\r\n\t\t\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\t\t\taccept=\"image/*\"\r\n\t\t\t\t\t\t\tonChange={this.state.param.changeCover}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t{this.props.myTrip ?\r\n\t\t\t\t\t\t\t\t<ButtonDeleteTrip id={this.state.param.id} token={this.props.token} />\r\n\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t<button ref={this.saveTripButton} style={{ visibility: \"hidden\" }} type=\"button\" onClick={() => this.saveTrip()}>Save this trip</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n// render a step\r\nexport class EtapeVoyage extends React.Component {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<div class=\"etape\">\r\n\t\t\t\t\t<p class=\"nomEtape\">{this.props.etape.title}</p>\r\n\t\t\t\t\t{console.log(this.props.etape)}\r\n\t\t\t\t\t<p class=\"villedate_etape\">\r\n\t\t\t\t\t\t{this.props.etape.city + \"  \" + new Date(this.props.etape.arrival)}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p>{this.props.etape.description}</p>\r\n\t\t\t\t\t{this.props.etape.photos.map((photo, i) => (\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\tkey={this.props.editStepKey.toString() + i.toString()}\r\n\t\t\t\t\t\t\t\tsrc={photo.path}\r\n\t\t\t\t\t\t\t\talt={photo.title}\r\n\t\t\t\t\t\t\t\theight=\"150\"\r\n\t\t\t\t\t\t\t\twidth=\"200\"\r\n\t\t\t\t\t\t\t></img>\r\n\r\n\t\t\t\t\t\t\t<p key={i}>{photo.description}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\r\n\t\t\t\t\t{this.props.myTrip ?\r\n\t\t\t\t\t\t<EditStep reload={ true } key={this.props.editStepKey.toString + \"add\"} stepKey={this.props.editStepKey} step={this.props.etape} token={this.props.token} />\r\n\t\t\t\t\t\t//console.log(\"here\")\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{this.props.etape.departureTransport ? (\r\n\t\t\t\t\t<div class=\"transition_etape\">\r\n\t\t\t\t\t\t<p class=\"transitionTexte\">\r\n\t\t\t\t\t\t\t Moyen de transport : {this.props.etape.departureTransport.type}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t)}\r\n\t\t\t\t{/*this.props.myTrip ?\r\n\t\t\t\t\t<AddStep tripId={this.props.tripId} key={this.props.editStepKey} stepKey={this.props.editStepKey} token={this.props.token} />\r\n\t\t\t\t\t//console.log(\"here\")\r\n\t\t\t\t\t:\r\n\t\t\t\t\tconsole.log(\"not here\")\r\n\t\t\t\t*/}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nclass ShowVoyage extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.loadDoc(this); // on recupere le voyage souhaite avec une requete ajax\r\n\t\tthis.verifTripIsMine(this);\r\n\r\n\t\tthis.state = {\r\n\t\t\tparam: false,\r\n\t\t\tmyTrip: false\r\n\t\t};\r\n\t}\r\n\r\n\tverifTripIsMine() {\r\n\t\tAxios.get(\"https://wtg.aymerik-diebold.fr/api/me\", {\r\n\t\t\theaders: { Authorization: \"Bearer \" + this.props.token },\r\n\t\t}).then((res) => {\r\n\r\n\r\n\t\t\t//var res2 = res.data.trips;\r\n\t\t\t//console.log(res2);\r\n\t\t\tvar listformat = [];\r\n\t\t\tres.data.trips.forEach(function (item) {\r\n\t\t\t\tlistformat.push(parseInt(item.id));\r\n\t\t\t});\r\n\r\n\r\n\t\t\tvar index = listformat.indexOf(parseInt(this.props.id));\r\n\t\t\tif (index != -1) {\r\n\t\t\t\tthis.setState({ myTrip: true });\r\n\t\t\t}\r\n\r\n\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tconsole.log(\"Error when retrieve user id\");\r\n\t\t\t\tthrow err;\r\n\t\t\t});\r\n\t}\r\n\r\n\tloadDoc(parentVoyage) {\r\n\t\tvar xhttp = new XMLHttpRequest();\r\n\t\txhttp.onreadystatechange = function () {\r\n\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\tconst param = JSON.parse(this.responseText);\r\n\t\t\t\tparentVoyage.setState({ param: param });\r\n\t\t\t}\r\n\t\t};\r\n\t\txhttp.open(\r\n\t\t\t\"GET\",\r\n\t\t\t\"https://wtg.aymerik-diebold.fr/api/trips/\" + parentVoyage.props.id,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\txhttp.send();\r\n\t}\r\n\r\n\trender() {\r\n\t\tvar content = \"\";\r\n\t\tif (!this.state.param) {\r\n\t\t\tcontent = (\r\n\t\t\t\t<h1>Chargement en cours...</h1>\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tcontent = (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<NavigationBar\r\n\t\t\t\t\t\tconnected={this.props.connected}\r\n\t\t\t\t\t\tconnect={this.props.connect}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<div id=\"carteSide\">\r\n\t\t\t\t\t\t<Map id=\"ShowVoyageMap\" center={[40.0, 3.0]} zoom={1}>\r\n\t\t\t\t\t\t\t<TileLayer\r\n\t\t\t\t\t\t\t\tattribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n\t\t\t\t\t\t\t\turl=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t{this.state.param.stages.map((etape) => (\r\n\t\t\t\t\t\t\t\t<Marker position={[etape.lng, etape.lat]}>\r\n\t\t\t\t\t\t\t\t\t<Popup>\r\n\t\t\t\t\t\t\t\t\t\t<h1>{etape.description}</h1>\r\n\t\t\t\t\t\t\t\t\t</Popup>\r\n\t\t\t\t\t\t\t\t</Marker>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</Map>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div id=\"information\">\r\n\t\t\t\t\t\t<EnteteVoyage param={this.state.param} myTrip={this.state.myTrip} token={this.props.token} connect={this.props.connect} connected={this.props.connected} />\r\n\t\t\t\t\t\t{this.state.myTrip ?\r\n\t\t\t\t\t\t\t<AddStep reload={ true } tripId={this.state.param.id} key={\"firstAddStep\"} stepKey={\"firstAddStep\"} token={this.props.token} />\r\n\t\t\t\t\t\t\t//console.log(\"here\")\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t//console.log(\"not here\")\r\n\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<div id=\"etapes\">\r\n\t\t\t\t\t\t\t{this.state.param.stages.map((etape, i) => (\r\n\t\t\t\t\t\t\t\t<EtapeVoyage key={i} tripId={this.state.param.id} etape={etape} editStepKey={i} photos={etape.photos} myTrip={this.state.myTrip} token={this.props.token} />\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn content;\r\n\t}\r\n}\r\n\r\nexport default ShowVoyage;\r\n","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport { EnteteVoyage } from \"./ShowVoyage\";\r\nimport NavigationBar from \"./NavigationBar\";\r\nimport EditStep, { ButtonDeleteTrip } from \"./editStep.js\";\r\nimport AddStep from \"./addStep\";\r\n\r\nclass UneEtape extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tstep: JSON.parse(props.etape)\r\n\t\t};\r\n\t\tthis.state.step.departureTransport = { \"type\": props.transport };\r\n\t\t//console.log(this.state.step);\r\n\t\tthis.refLocation = React.createRef();\r\n\t\tthis.refName = React.createRef();\r\n\t\tthis.refDate = React.createRef();\r\n\t\tthis.refDescription = React.createRef();\r\n\t\tthis.refDateDepart = React.createRef();\r\n\t\tthis.refDepartureTransport = React.createRef();\r\n\r\n\t\tthis.editEtapeVoyage = this.editEtapeVoyage.bind(this);\r\n\t}\r\n\r\n\teditEtapeVoyage(parameters) {\r\n\t\t//console.log(parameters);\r\n\t\tthis.setState({\r\n\t\t\tstep: parameters.etape\r\n\t\t})\r\n\t\tthis.refLocation.current.innerHTML = parameters.city;\r\n\t\tthis.refName.current.innerHTML = parameters.title;\r\n\t\tthis.refDate.current.innerHTML = parameters.arrival;\r\n\t\tthis.refDescription.current.innerHTML = parameters.description;\r\n\t\tthis.refDateDepart.current.innerHTML = parameters.departure;\r\n\t\tthis.refDepartureTransport.current.innerHTML = parameters.departureTransport.type;\r\n\t\t//console.log(parameters.departureTransport.type);\r\n\t\t//console.log(this.refDepartureTransport.current.innerHTML);\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div class=\"etapevoyage\">\r\n\t\t\t\t<EditStep key={this.props.editStepKey} reload={false} callback={this.editEtapeVoyage} stepKey={this.state.editStepKey} step={this.state.step} token={this.props.token} />\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t<label>Location : </label>\r\n\t\t\t\t<label ref={this.refLocation}>{this.props.arguments.location}</label>\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t<label>Step name : </label>\r\n\t\t\t\t<label ref={this.refName}>{this.props.arguments.name}</label>\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t<label>Arrival date : </label>\r\n\t\t\t\t<label ref={this.refDate}>{this.props.arguments.date}</label>\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t<label>Departure date : </label>\r\n\t\t\t\t<label ref={this.refDateDepart}>{this.props.arguments.dateDepart}</label>\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t<label>Moyen de transport : </label>\r\n\t\t\t\t<label ref={this.refDepartureTransport}>{this.props.arguments.departureTransport}</label>\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t<label>Your story : </label>\r\n\t\t\t\t<label ref={this.refDescription}>{this.props.arguments.description}</label>\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t{this.props.arguments.files && [...this.props.arguments.files].map((file, i) => (\r\n\t\t\t\t\t<img key={this.props.editStepKey + i} width=\"200px\" height=\"200px\" src={URL.createObjectURL(file.image)} alt=\"Image\" />\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\n// seconde vue de la cration de voyage : permet d'ajouter des etapes\r\nclass CreationVoyageAjoutEtapes extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tname: props.name,\r\n\t\t\tdescription: props.description,\r\n\t\t\tvegan: props.vegan,\r\n\t\t\tecolo: props.ecolo,\r\n\t\t\tvoyageId: props.voyageId,\r\n\t\t\tfiles: [],\r\n\t\t\tallEtapes: []\r\n\t\t};\r\n\r\n\t\tthis.setTextInputRef = React.createRef();\r\n\r\n\t\tthis.inputphotoToReset = React.createRef();\r\n\t\tthis.imgcontainer = React.createRef();\r\n\r\n\t\tthis.changeEnteteBackground = this.changeEnteteBackground.bind(this);\r\n\t\tthis.addEtapeVoyage = this.addEtapeVoyage.bind(this);\r\n\r\n\t\tthis.newCity = React.createRef();\r\n\t\tthis.newName = React.createRef();\r\n\t\tthis.newDate = React.createRef();\r\n\t\tthis.newDateDepart = React.createRef();\r\n\t\tthis.newDepartureTransport = React.createRef();\r\n\t\tthis.newDescription = React.createRef();\r\n\r\n\t\tthis.newLat = React.createRef();\r\n\t\tthis.newLnt = React.createRef();\r\n\t\tthis.boutonOK = React.createRef();\r\n\r\n\t\tthis.refHead = React.createRef();\r\n\t}\r\n\r\n\t// TODO\r\n\t// A CHANGER ICI ! ET REFAIRE LE EDIT\r\n\taddEtapeVoyage(parameters) {\r\n\t\t//console.log(parameters);\r\n\t\tthis.setState({\r\n\t\t\tallEtapes: [...this.state.allEtapes, {\r\n\t\t\t\t\"files\": parameters.photos,\r\n\t\t\t\t\"description\": parameters.description,\r\n\t\t\t\t\"date\": parameters.arrival,\r\n\t\t\t\t\"dateDepart\": parameters.departure,\r\n\t\t\t\t\"location\": parameters.city,\r\n\t\t\t\t\"departureTransport\": parameters.transport,\r\n\t\t\t\t\"name\": parameters.title,\r\n\t\t\t\t\"etape\": parameters.etape\r\n\t\t\t}\r\n\t\t\t]\r\n\t\t})\r\n\t\t/*ReactDOM.render(<UneEtape arguments={\r\n\t\t\t{\r\n\t\t\t\t\"location\": parameters.city,\r\n\t\t\t\t\"files\": parameters.photos,\r\n\t\t\t\t\"description\": parameters.description,\r\n\t\t\t\t\"date\": parameters.arrival,\r\n\t\t\t\t\"dateDepart\": parameters.departure,\r\n\t\t\t\t\"departureTransport\": parameters.transport,\r\n\t\t\t\t\"name\": parameters.title\r\n\t\t\t}} editStepKey={\"addVoyage\"} etape={parameters.etape} token={this.props.token} />, this.setTextInputRef.current.appendChild(document.createElement('div')));\r\n\t\t\t*/\r\n\t}\r\n\r\n\tchangeEnteteBackground(event) {\r\n\t\t// linear black gradient to blacker the img\r\n\t\tthis.refHead.current.style.backgroundImage = \"linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('\" + URL.createObjectURL(event.target.files[0]) + \"')\";\r\n\t}\r\n\r\n\taddImgFile(img) {\r\n\t\tthis.setState({\r\n\t\t\tfiles: this.state.files.concat(img) // ajout des nouvelles images a ceux deja existantes\r\n\t\t});\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div id=\"information\">\r\n\t\t\t\t<EnteteVoyage param={{ changeCover: this.changeEnteteBackground, edit: true, refHead: this.refHead, title: this.state.name, description: this.state.description, vegan: this.state.vegan, ecolo: this.state.ecolo, stages: [], author: { firstName: \"Nicolas\", lastName: \"Dupond\" } }} />\r\n\r\n\t\t\t\t<div ref={this.setTextInputRef}></div>\r\n\t\t\t\t{this.state.allEtapes.map((etape, i) => (\r\n\t\t\t\t\t<UneEtape arguments={etape} key={\"UneEtape\" + i} transport={etape.departureTransport} editStepKey={\"addVoyage\" + i} etape={etape.etape} token={this.props.token} />\r\n\t\t\t\t))}\r\n\r\n\t\t\t\t<AddStep reload={false} callback={this.addEtapeVoyage} tripId={this.props.voyageId} key={\"addVoyage\"} stepKey={\"addVoyage\"} token={this.props.token} />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\nclass CreationVoyage extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.description = React.createRef();\r\n\t\tthis.name = React.createRef();\r\n\t\tthis.vegan = React.createRef();\r\n\t\tthis.ecolo = React.createRef();\r\n\t}\r\n\r\n\taddVoyageCheck() {\r\n\t\tif (this.description.current.validity.valid && this.name.current.validity.valid) {\r\n\t\t\tthis.props.addMyVoyage(this.name.current.value, this.description.current.value, this.vegan.current.checked, this.ecolo.current.checked)\r\n\t\t} else alert(\"Please complete the Details section\")\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"formulaire\">\r\n\t\t\t\t<h3>New trip</h3>\r\n\r\n\t\t\t\t<div className=\"partie\">\r\n\t\t\t\t\t<h4>Dtails</h4>\r\n\t\t\t\t\t<div className=\"partiedetails\">\r\n\t\t\t\t\t\t<p className=\"partieLabel\">Trip name:</p>\r\n\t\t\t\t\t\t<input required type=\"text\" ref={this.name} id=\"fname\" name=\"firstname\" placeholder=\"ex. A grand tour of France\"></input>\r\n\r\n\t\t\t\t\t\t<p className=\"partieLabel\">Trip summary:</p>\r\n\t\t\t\t\t\t<textarea required ref={this.description} id=\"lname\" name=\"lastname\" placeholder=\"ex. A bucolic journey through the French countryside: old relics and local specialities\"></textarea>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\r\n\t\t\t\t<div className=\"partie\">\r\n\t\t\t\t\t<h4>Parameters</h4>\r\n\t\t\t\t\t<div className=\"partiedetails\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<input ref={this.vegan} type=\"checkbox\" id=\"voyagevegan\" name=\"voyagevegan\" value=\"newsletter\"></input>\r\n\t\t\t\t\t\t\t<label htmlFor=\"voyagevegan\">Is this trip vegan?</label>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<input ref={this.ecolo} type=\"checkbox\" id=\"voyageecolo\" name=\"voyageecolo\" value=\"newsletter\"></input>\r\n\t\t\t\t\t\t\t<label htmlFor=\"voyageecolo\">Is this trip environmentally friendly?</label>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\r\n\t\t\t\t<button type=\"button\" className=\"boutonsend\" onClick={this.addVoyageCheck.bind(this)}>Add my trip</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default class AddVoyage extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\ttoken: props.token,\r\n\t\t\tstartNewVoyage: true,\r\n\t\t\tchargement: false,\r\n\r\n\t\t\tname: \"\",\r\n\t\t\tdescription: \"\",\r\n\t\t\tvegan: false,\r\n\t\t\tecolo: false\r\n\t\t};\r\n\r\n\t\tthis.addMyVoyage = this.addMyVoyage.bind(this)\r\n\t}\r\n\r\n\taddMyVoyage(newname, newdescription, newvegan, newecolo) {\r\n\t\tthis.setState({\r\n\t\t\tname: newname,\r\n\t\t\tdescription: newdescription,\r\n\t\t\tvegan: newvegan,\r\n\t\t\tecolo: newecolo,\r\n\t\t\tchargement: true\r\n\t\t})\r\n\t\tvar xhttp = new XMLHttpRequest();\r\n\t\tvar parentVoyage = this;\r\n\t\txhttp.onreadystatechange = function () {\r\n\t\t\t//console.log(this.responseText);\r\n\t\t\tif (this.readyState === 4 && this.status === 201) {\r\n\t\t\t\tvar res = JSON.parse(this.responseText);\r\n\t\t\t\tparentVoyage.setState({\r\n\t\t\t\t\tchargement: false,\r\n\t\t\t\t\tstartNewVoyage: false,\r\n\t\t\t\t\tvoyageId: res.id\r\n\t\t\t\t})\r\n\t\t\t} else if (this.readyState === 4 && this.status === 401) {\r\n\t\t\t\talert(\"Connection time out. Please reconnect\");\r\n\t\t\t\t//console.log(parentVoyage.state.token)\r\n\t\t\t\t//parentVoyage.renouvelerToken();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\txhttp.open(\"POST\", \"https://wtg.aymerik-diebold.fr/api/trips\", true);\r\n\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + parentVoyage.state.token);\r\n\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\txhttp.send(JSON.stringify({\r\n\t\t\t\"title\": newname,\r\n\t\t\t\"description\": newdescription,\r\n\t\t\t\"vegan\": newvegan,\r\n\t\t\t\"ecological\": newecolo,\r\n\t\t\t\"author\": \"api/users/\" + parentVoyage.props.connected,\r\n\t\t\t\"keywords\": \"paris plage\",\r\n\t\t}));\r\n\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<NavigationBar active={1} token={this.props.token} connected={this.props.connected} connect={this.props.connect} />\r\n\r\n\t\t\t\t{this.state.startNewVoyage ?\r\n\t\t\t\t\t!this.state.chargement ?\r\n\t\t\t\t\t\t<CreationVoyage token={this.state.token} addMyVoyage={this.addMyVoyage.bind(this)} />\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t<h2>Chargement</h2>\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<CreationVoyageAjoutEtapes token={this.state.token} voyageId={this.state.voyageId} name={this.state.name} vegan={this.state.vegan} ecolo={this.state.ecolo} description={this.state.description} />\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t);\r\n\r\n\t}\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { Map, TileLayer, Marker, Popup } from \"react-leaflet\";\r\nimport \"./App.css\";\r\nimport NavigationBar from \"./NavigationBar\";\r\n\r\nexport default class ShowCarte extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      voyages: [],\r\n\r\n      lat: 48.856614, // centr sur Paris\r\n      lng: 2.3522219,\r\n      zoom: 2,\r\n    };\r\n\r\n    this.loadTrips(this);\r\n  }\r\n\r\n  loadTrips(parentThis) {\r\n    //let liste = []\r\n    var xhttp = new XMLHttpRequest();\r\n    xhttp.onreadystatechange = function () {\r\n      if (this.readyState === 4 && this.status === 200) {\r\n        parentThis.setState({\r\n          voyages: JSON.parse(this.response)[\"hydra:member\"], // stock all trips\r\n        });\r\n        console.log(JSON.parse(this.response));\r\n      }\r\n    };\r\n    xhttp.open(\"GET\", \"https://wtg.aymerik-diebold.fr/api/trips\", true);\r\n    xhttp.send();\r\n\r\n   /* for (let i = 353; i < 440; i++) {\r\n\t\t\t// delete all\r\n\t\t\tvar xhttp2 = new XMLHttpRequest();\r\n\t\t\txhttp2.onreadystatechange = function () {\r\n\t\t\t\tconsole.log(this.response);\r\n\t\t\t};\r\n\t\t\txhttp2.open(\"DELETE\", \"https://wtg.aymerik-diebold.fr/api/trips/\"+i, true);\r\n\t\t\txhttp2.setRequestHeader('Authorization', 'Bearer ' + this.props.token);\r\n\t\t\txhttp2.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\txhttp2.send();\r\n\t\t}*/\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"App\">\r\n        <NavigationBar\r\n          active={0}\r\n          token={this.props.token}\r\n          connected={this.props.connected}\r\n          connect={this.props.connect}\r\n        />\r\n\r\n        <Map\r\n          id=\"principalMap\"\r\n          center={[this.state.lat, this.state.lng]}\r\n          zoom={this.state.zoom}\r\n        >\r\n          <TileLayer\r\n            attribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n            url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n          />\r\n\r\n          {this.state.voyages.map((voyage) =>\r\n            voyage.stages.map((etape) => (\r\n              <Marker position={[etape.lng, etape.lat]}>\r\n                <Popup>\r\n                  <h1>{voyage.title}</h1>\r\n                  <a href={\"?show=trip&id=\" + voyage.id}>Click here to discover</a>\r\n                </Popup>\r\n              </Marker>\r\n            ))\r\n          )}\r\n        </Map>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport NavigationBar from \"./NavigationBar\";\r\nimport Axios from \"axios\";\r\n\r\nexport class Profile extends Component {\r\n  state = {\r\n    email: \"\",\r\n    firstname: \"\",\r\n    lastname: \"\",\r\n    id: \"\",\r\n    trips: [],\r\n    recordedTrips: [],\r\n  };\r\n\r\n  getUserInfo = () => {\r\n    // GET /api/me\r\n    Axios.get(\"https://wtg.aymerik-diebold.fr/api/me\", {\r\n      headers: { Authorization: \"Bearer \" + this.props.token },\r\n    })\r\n      .then((res) => {\r\n        console.log(res);\r\n        this.setState({\r\n          email: res.data.email,\r\n          firstname: res.data.firstName,\r\n          lastname: res.data.lastName,\r\n          id: res.data.id,\r\n          trips: res.data.trips,\r\n          recordedTrips: res.data.recordedTrips,\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"Not connected\");\r\n        throw err;\r\n      });\r\n  };\r\n\r\n  getTrips = () => {\r\n    // GET /trips\r\n    console.log(\"get trips\");\r\n    console.log(this.state.trips);\r\n    for (let i = 0; i < this.state.trips.length; i++) {\r\n      Axios.get(\r\n        \"https://wtg.aymerik-diebold.fr/api/trips/\" +\r\n          this.state.trips[i].split(\"/\")[3]\r\n      )\r\n        .then((res) => {\r\n          console.log(res);\r\n          this.setState({\r\n            tripTitles: [\r\n              ...this.state.tripTitles,\r\n              { id: res.data.id, title: res.data.title },\r\n            ],\r\n          });\r\n        })\r\n        .catch((err) => {\r\n          throw err;\r\n        });\r\n    }\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.getUserInfo();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"profile\">\r\n        <NavigationBar\r\n          active=\"4\"\r\n          connected={this.props.connected}\r\n          connect={this.props.connect}\r\n        />\r\n        {this.props.connected ? (\r\n          <div className=\"profileContainer\" style={containerStyle}>\r\n            <h1>My Profile</h1>\r\n            <h3 style={{ backgroundColor: \"inherit\" }}>Personal Info</h3>\r\n            <div className=\"profileBox\" style={boxStyle}>\r\n              <div>\r\n                <p>Email</p>\r\n                <p>Firstname</p>\r\n                <p>Lastname</p>\r\n              </div>\r\n              <div>\r\n                <p>{this.state.email}</p>\r\n                <p>{this.state.firstname}</p>\r\n                <p>{this.state.lastname}</p>\r\n              </div>\r\n            </div>\r\n            <div style={trips}>\r\n              <div className=\"my-trips\">\r\n                <h3 style={{ backgroundColor: \"inherit\" }}>My trips</h3>\r\n                {this.state.trips.map((trip) => (\r\n                  <p>\r\n                    <a href={\"?show=trip&id=\" + trip.id}>{trip.title}</a>\r\n                  </p>\r\n                ))}\r\n                <a href=\"?show=save\" style={{ color: \"red\" }}>\r\n                  Add trip!\r\n                </a>\r\n              </div>\r\n              <div className=\"recorded-trips\">\r\n                <h3 style={{ backgroundColor: \"inherit\" }}>Favorite trips</h3>\r\n                {this.state.recordedTrips.length !== 0 ? (\r\n                  this.state.recordedTrips.map((trip) => (\r\n                    <p>\r\n                      <a href={\"?show=trip&id=\" + trip.id}>{trip.title}</a>\r\n                    </p>\r\n                  ))\r\n                ) : (\r\n                  <p>\r\n                    You don't have any favorite trip :(\r\n                    <a href=\"/WaysToGo\" style={{ display: \"block\" }}>\r\n                      Browse trips to save your favorite!\r\n                    </a>\r\n                  </p>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <p>Please log in</p>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst containerStyle = {\r\n  textAlign: \"center\",\r\n  backgroundColor: \"#f3f3f3\",\r\n  width: \"50%\",\r\n  margin: \"auto\",\r\n};\r\n\r\nconst boxStyle = {\r\n  display: \"flex\",\r\n  justifyContent: \"space-around\",\r\n};\r\n\r\nconst trips = {\r\n  display: \"flex\",\r\n  justifyContent: \"space-around\",\r\n};\r\n\r\nexport default Profile;\r\n","import React, { Component } from \"react\";\r\n//import ReactDom from 'react-dom'\r\n//import ObjectList from 'react-object-list'\r\n//import { List } from 'react-object-list/renderers'\r\nimport \"./App.css\";\r\nimport NavigationBar from './NavigationBar';\r\n\r\n\r\n\r\nclass SearchForm extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            city: props.city,\r\n            title: props.title,\r\n            keyword: props.keyword,\r\n            chercher: props.chercher,\r\n            vegan: props.vegan,\r\n            ecolo: props.ecolo,\r\n        };\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div class=\"formulaire\">\r\n\r\n                <div class=\"partiedetails\">\r\n                    <p class=\"partieLabel\">Title:</p>\r\n                    <input required type=\"text\" ref={this.state.title} id=\"title\" name=\"title\" placeholder=\"\"></input>\r\n                </div>\r\n\r\n                <div class=\"partiedetails\">\r\n                    <p class=\"partieLabel\">Keyword:</p>\r\n                    <input required type=\"text\" ref={this.state.keyword} id=\"keyword\" name=\"keyword\" placeholder=\"ex. Paris\"></input>\r\n                </div>\r\n\r\n                <div class=\"partiedetails\">\r\n                    <p class=\"partieLabel\">City:</p>\r\n                    <input required type=\"text\" ref={this.state.city} id=\"rcity\" name=\"city\" placeholder=\"ex. Rome\"></input>\r\n                </div>\r\n\r\n                <div class=\"partiedetails\">\r\n                    <div>\r\n                        <input ref={this.state.vegan} type=\"checkbox\" id=\"voyagevegan\" name=\"voyagevegan\" value=\"newsletter\"></input>\r\n                        <label htmlFor=\"voyagevegan\">Vegan?</label>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <input ref={this.state.ecolo} type=\"checkbox\" id=\"voyageecolo\" name=\"voyageecolo\" value=\"newsletter\"></input>\r\n                        <label htmlFor=\"voyageecolo\">Environmentally friendly?</label>\r\n                    </div>\r\n                </div>\r\n\r\n                <button type=\"button\" class=\"boutonsend\" onClick={this.state.chercher}>Chercher</button>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nclass ResultList extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            city: props.city,\r\n            keyword: props.keyword,\r\n            title: props.title,\r\n            vegan: props.vegan,\r\n            ecolo: props.ecolo,\r\n            voyages: [],\r\n        };\r\n        this.loadDoc(this);\r\n    }\r\n\r\n    loadDoc(parentThis) {\r\n        var xhttp = new XMLHttpRequest();\r\n        xhttp.onreadystatechange = function () {\r\n            if (this.readyState === 4 && this.status === 200) {\r\n                parentThis.setState({\r\n                    voyages: JSON.parse(this.response)['hydra:member'],\r\n                });\r\n                //console.log(parentThis.state.voyages);\r\n            }\r\n        };\r\n        \r\n        var url = \"https://wtg.aymerik-diebold.fr/api/trips?\";\r\n        var firstParam = true;\r\n        if (parentThis.state.title.length > 0) {\r\n            url = url.concat(\"title=\", parentThis.state.title);\r\n            firstParam = false;\r\n        };\r\n        if (parentThis.state.keyword.length > 0) {\r\n            if (!firstParam) {\r\n                url = url.concat(\"&\");\r\n            };\r\n            url = url.concat(\"keywords=\", parentThis.state.keyword);\r\n            firstParam = false;\r\n        };\r\n        if (parentThis.state.city.length > 0) {\r\n            if (!firstParam) {\r\n                url = url.concat(\"&\");\r\n            };\r\n            url = url.concat(\"stages.city=\", parentThis.state.city);\r\n            firstParam = false;\r\n        };\r\n\r\n        if (parentThis.state.vegan) {\r\n            console.log(parentThis.state.vegan, firstParam);\r\n            if (!firstParam) {\r\n                url = url.concat(\"&\");\r\n            };\r\n            url = url.concat(\"vegan=true\");\r\n            firstParam = false;\r\n        };\r\n\r\n        if (parentThis.state.ecolo) {\r\n            if (!firstParam) {\r\n                url = url.concat(\"&\");\r\n            };\r\n            url = url.concat(\"ecological=true\");\r\n        };\r\n\r\n        console.log(url)\r\n        xhttp.open(\"GET\",url, true);\r\n        xhttp.send();\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <div id=\"recherche\">\r\n                    <h4> Results of\r\n                    <ul>\r\n                            <li>Title: \"{this.state.title}\" </li>\r\n                            <li>Keyword: \"{this.state.keyword}\" </li>\r\n                            <li>City: \"{this.state.city}\" </li>\r\n                            <li>Vegan: \"{this.state.vegan ? 'True' : ''}\" </li>\r\n                            <li>Ecological: \"{this.state.ecolo ? 'True' : ''}\" </li>\r\n                        </ul>\r\n                    </h4>\r\n                </div>\r\n\r\n                <div id='table'>\r\n                    \r\n                    {this.state.voyages.length > 0 ? (\r\n                        <table>\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Title</th>\r\n                                    <th>Author</th>\r\n                                    <th>Description</th>\r\n                                    <th>Lien</th>\r\n                                </tr>\r\n                            </thead>\r\n\r\n                            <tbody>\r\n                                {this.state.voyages.map((voyage) => (\r\n                                    <tr>\r\n                                        <td>{voyage.title}</td>\r\n                                        <td>{voyage.author.firstName} {voyage.author.lastNqme}</td>\r\n                                        <td>{voyage.description}</td>\r\n                                        <td><a href={\"?show=trip&id=\" + voyage.id}>Cliquez</a></td>\r\n                                    </tr>\r\n\r\n                                ))}\r\n                            </tbody>\r\n                        </table>) : (\r\n                            <div>\r\n                                <p>Not found</p>\r\n                                <a href=\"?show=research\">Return</a>\r\n                            </div>)\r\n                    }\r\n                        \r\n\r\n                    \r\n                </div>\r\n\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n\r\nexport default class SearchResult extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            id: props.id,\r\n            startNewSearch: true,\r\n            vegan: false,\r\n            ecolo: false,\r\n            toRender: <h1>Chargement en cours...</h1>\r\n        };\r\n\r\n        this.city = React.createRef();\r\n        this.title = React.createRef();\r\n        this.keyword = React.createRef();\r\n        this.vegan = React.createRef();\r\n        this.ecolo = React.createRef();\r\n\r\n        // Cette liaison est ncssaire afin de permettre l'utilisation de `this` dans la fonction de rappel.\r\n        this.chercher = this.chercher.bind(this);\r\n    }\r\n\r\n    chercher() {\r\n        if (this.city.current.validity.valid || this.title.current.validity.valid ||\r\n            this.keyword.current.validity.valid) {\r\n            this.setState({\r\n                city: this.city.current.value,\r\n                keyword: this.keyword.current.value,\r\n                title: this.title.current.value,\r\n                vegan: this.vegan.current.checked,\r\n                ecolo: this.ecolo.current.checked,\r\n                startNewSearch: false,\r\n            });\r\n        }\r\n        else alert(\"Veillez completer au moins un champ pour chercher\")\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <NavigationBar active=\"5\" />\r\n\r\n                {this.state.startNewSearch ?\r\n                    <SearchForm city={this.city} title={this.title} keyword={this.keyword} vegan={this.vegan} ecolo={this.ecolo} chercher={this.chercher} />\r\n                    :\r\n                    <ResultList city={this.city.current.value} title={this.title.current.value} keyword={this.keyword.current.value} vegan={this.vegan.current.checked} ecolo={this.ecolo.current.checked} />\r\n\r\n                }\r\n            </div>\r\n        );\r\n\r\n    }\r\n}","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport NavigationBar from \"./NavigationBar\";\r\n\r\nexport default class About extends Component {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<NavigationBar\r\n\t\t\t\t\tactive={3}\r\n\t\t\t\t\ttoken={this.props.token}\r\n\t\t\t\t\tconnected={this.props.connected}\r\n\t\t\t\t\tconnect={this.props.connect}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t<h2>WaysToGo</h2>\r\n\t\t\t\t<h3>Explore. Share. Discover.</h3>\r\n\t\t\t\t<p>WaysToGo allows you to share your trips to everyone. <br></br>Search new trips, begin new adventures :)</p>\r\n\t\t\t\t<p>Founded by Caroline Texier and Arnaud Stoffel</p>\r\n\t\t\t\t<p>Developed by Aymerik Diebold, Jiacheng Zhou, Lon Davidovski, Youssef El Saadany with &#x2665;</p>\r\n\t\t\t\t<br></br>\r\n\t\t\t\t<p>Developed with React and Symfony (with the API Platform framework). Photos hosted by Imgur.com. Powered by Nominatim from OpenStreetMap.</p>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { unmountComponentAtNode } from \"react-dom\";\r\n\r\nexport class Popup extends Component {\r\n  state = {\r\n    showPopup: false,\r\n  };\r\n\r\n  getPopupStyle = () => {\r\n    return {\r\n      display: this.state.showPopup ? \"block\" : \"none\",\r\n      position: \"absolute\",\r\n      zIndex: \"1\",\r\n      top: \"35px\",\r\n      left: \"50%\",\r\n      width: \"30%\",\r\n    };\r\n  };\r\n\r\n  getInnerPopupStyle = () => {\r\n    return {\r\n      position: \"relative\",\r\n      left: \"-50%\",\r\n      backgroundColor: \"#F3F3F3\",\r\n      borderRadius: \"25px\",\r\n      padding: \"20px\",\r\n      fontWeight: \"bold\",\r\n      fontSize: \"1.2em\",\r\n    };\r\n  };\r\n\r\n  componentDidMount = () => {\r\n    this.setState({ showPopup: true });\r\n    setTimeout(() => this.setState({ showPopup: false }), 5000);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div style={this.getPopupStyle()}>\r\n          <div style={this.getInnerPopupStyle()}>\r\n            <p>{this.props.message}</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Popup;\r\n","import React, { Component } from \"react\";\r\nimport NavigationBar from \"./NavigationBar\";\r\nimport Axios from \"axios\";\r\nimport Popup from \"./Popup\";\r\n\r\nexport class Settings extends Component {\r\n  state = {\r\n    email: \"\",\r\n    firstname: \"\",\r\n    lastname: \"\",\r\n    currentPassword: \"\",\r\n    newPassword: \"\",\r\n    newPassword2: \"\",\r\n    id: \"\",\r\n    showPersonal: true,\r\n    showPrivacy: false,\r\n    message: \"\",\r\n  };\r\n\r\n  goPersonal = (e) => {\r\n    this.setState({ showPersonal: true, showPrivacy: false });\r\n  };\r\n\r\n  goPrivacy = (e) => {\r\n    this.setState({ showPersonal: false, showPrivacy: true });\r\n  };\r\n\r\n  onChange = (e) => {\r\n    this.setState({ [e.target.name]: e.target.value });\r\n  };\r\n\r\n  onSubmit = (e) => {\r\n    e.preventDefault();\r\n    console.log(\"Changing profile\");\r\n\r\n    if (this.state.currentPassword !== \"\") {\r\n      // TODO: check if current password is correct\r\n      Axios.post(\r\n        \"https://wtg.aymerik-diebold.fr/api/password\",\r\n        {\r\n          password: this.state.currentPassword,\r\n        },\r\n        {\r\n          headers: {\r\n            Authorization: \"Bearer \" + this.props.token,\r\n            \"Content-type\": \"application/json\",\r\n          },\r\n        }\r\n      )\r\n        .then((res) => {\r\n          console.log(res.data);\r\n          if (res.data.valid) {\r\n            console.log(\"Correct password\");\r\n            if (this.state.newPassword === this.state.newPassword2) {\r\n              Axios.patch(\r\n                \"https://wtg.aymerik-diebold.fr/api/users/\" +\r\n                  this.props.connected,\r\n                {\r\n                  password: this.state.newPassword,\r\n                  firstName: this.state.firstname,\r\n                  lastName: this.state.lastname,\r\n                },\r\n                {\r\n                  headers: {\r\n                    Authorization: \"Bearer \" + this.props.token,\r\n                    \"Content-Type\": \"application/merge-patch+json\",\r\n                  },\r\n                }\r\n              )\r\n                .then((res) => {\r\n                  console.log(\"Password changed successfully\");\r\n                })\r\n                .catch((err) => {\r\n                  console.log(\"Error while changing password\");\r\n                  throw err;\r\n                });\r\n            } else {\r\n              console.log(\"Not the same passwords\");\r\n              this.setState({ message: \"Not the same passwords\" });\r\n            }\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(\"Error while checking password\");\r\n          throw err;\r\n        });\r\n    } else {\r\n      console.log(\"Changing only first/last name\");\r\n      Axios.patch(\r\n        \"https://wtg.aymerik-diebold.fr/api/users/\" + this.props.connected,\r\n        {\r\n          firstName: this.state.firstname,\r\n          lastName: this.state.lastname,\r\n        },\r\n        {\r\n          headers: {\r\n            Authorization: \"Bearer \" + this.props.token,\r\n            \"Content-Type\": \"application/merge-patch+json\",\r\n          },\r\n        }\r\n      )\r\n        .then((res) => {\r\n          console.log(\"First/Last name changed successfully\");\r\n        })\r\n        .catch((err) => {\r\n          console.log(\"Error on chaging profile\");\r\n          throw err;\r\n        });\r\n    }\r\n  };\r\n\r\n  getUserInfo = () => {\r\n    // GET /api/me\r\n    Axios.get(\"https://wtg.aymerik-diebold.fr/api/me\", {\r\n      headers: { Authorization: \"Bearer \" + this.props.token },\r\n    })\r\n      .then((res) => {\r\n        console.log(res);\r\n        this.setState({\r\n          email: res.data.email,\r\n          firstname: res.data.firstName,\r\n          lastname: res.data.lastName,\r\n          id: res.data.id,\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"Not connected\");\r\n        throw err;\r\n      });\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.getUserInfo();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"settings\">\r\n        {this.state.message.length !== 0 ? (\r\n          <Popup message={this.state.message} />\r\n        ) : (\r\n          <span></span>\r\n        )}\r\n        <NavigationBar\r\n          active=\"6\"\r\n          connected={this.props.connected}\r\n          connect={this.props.connect}\r\n        />\r\n        <div style={mainStyle}>\r\n          <h1>Settings</h1>\r\n          <div style={containerStyle}>\r\n            <nav style={navStyle}>\r\n              <li style={navButton} onClick={this.goPersonal}>\r\n                Personnal\r\n              </li>\r\n              <li style={navButton} onClick={this.goPrivacy}>\r\n                Privacy\r\n              </li>\r\n            </nav>\r\n            {this.state.showPersonal ? (\r\n              <div style={boxStyle}>\r\n                <div>\r\n                  <p>Email</p>\r\n                  <p>Firstname</p>\r\n                  <p>Lastname</p>\r\n                  <p>Current password</p>\r\n                  <p>New password</p>\r\n                  <p>New password confirmation</p>\r\n                </div>\r\n                <div style={info}>\r\n                  <p>{this.state.email}</p>\r\n                  <input\r\n                    type=\"text\"\r\n                    name=\"firstname\"\r\n                    id=\"firstname\"\r\n                    onChange={this.onChange}\r\n                    value={this.state.firstname}\r\n                  />\r\n                  <input\r\n                    type=\"text\"\r\n                    name=\"lastname\"\r\n                    id=\"lastname\"\r\n                    onChange={this.onChange}\r\n                    value={this.state.lastname}\r\n                  />\r\n                  <input\r\n                    type=\"password\"\r\n                    name=\"currentPassword\"\r\n                    value={this.state.currentPassword}\r\n                    onChange={this.onChange}\r\n                  />\r\n                  <input\r\n                    type=\"password\"\r\n                    name=\"newPassword\"\r\n                    value={this.state.newPassword}\r\n                    onChange={this.onChange}\r\n                  />\r\n                  <input\r\n                    type=\"password\"\r\n                    name=\"newPassword2\"\r\n                    value={this.state.newPassword2}\r\n                    onChange={this.onChange}\r\n                  />\r\n                  <input\r\n                    style={{ width: \"30%\" }}\r\n                    type=\"submit\"\r\n                    value=\"Save profile\"\r\n                    onClick={this.onSubmit}\r\n                  />\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div style={boxStyle}>\r\n                <p>Privacy page in construction</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mainStyle = {\r\n  textAlign: \"center\",\r\n  width: \"80%\",\r\n  margin: \"auto\",\r\n};\r\n\r\nconst containerStyle = {\r\n  display: \"flex\",\r\n  justifyContent: \"space-around\",\r\n};\r\n\r\nconst navStyle = {\r\n  listStyle: \"none\",\r\n};\r\nconst navButton = {\r\n  padding: \"15px\",\r\n  border: \"solid 1px black\",\r\n  backgroundColor: \"#F3F3F3\",\r\n};\r\n\r\nconst boxStyle = {\r\n  display: \"flex\",\r\n  width: \"80%\",\r\n  justifyContent: \"space-around\",\r\n  border: \"solid 1px black\",\r\n  backgroundColor: \"#F3F3F3\",\r\n};\r\n\r\nconst info = {\r\n  width: \"40%\",\r\n};\r\n\r\nexport default Settings;\r\n","import React, { Component } from \"react\";\r\nimport Cookies from \"universal-cookie\";\r\nimport \"./App.css\";\r\nimport ShowVoyage from \"./ShowVoyage.js\";\r\nimport AddVoyage from \"./AddVoyage.js\";\r\nimport ShowCarte from \"./ShowCarte.js\";\r\nimport Profile from \"./Profile\";\r\nimport SearchResult from \"./SearchResult.js\";\r\nimport About from \"./About.js\";\r\nimport Axios from \"axios\";\r\nimport Settings from \"./Settings\";\r\n\r\nexport default class App extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const cookies = new Cookies();\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    let token = cookies.get(\"token\") ? cookies.get(\"token\") : false;\r\n\r\n    if (urlParams.get(\"logout\")) {\r\n      this.disconnect();\r\n      token = false;\r\n    }\r\n\r\n    this.state = {\r\n      pageActuelle: urlParams.get(\"show\"), // on recupere la page a afficher via les arguments de l'URL\r\n      trip: urlParams.get(\"id\"),\r\n      connected: token ? true : false,\r\n      token: token ? token : \"\",\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (this.state.token) {\r\n      console.log(\"Connected!\");\r\n      Axios.get(\"https://wtg.aymerik-diebold.fr/api/me\", {\r\n        headers: { Authorization: \"Bearer \" + this.state.token },\r\n      })\r\n        .then((res) => {\r\n          this.setState({ connected: res.data.id });\r\n          //console.log(document.cookie);\r\n        })\r\n        .catch((err) => {\r\n          console.log(\"wut\");\r\n          console.log(this.state.token);\r\n          this.setState({ connected: false, token: \"\" });\r\n          const cookies = new Cookies();\r\n          cookies.remove(\"token\", { path: \"/\" });\r\n          throw err;\r\n        });\r\n    }\r\n  }\r\n\r\n  connect = (token) => {\r\n    console.log(\"Connected!\");\r\n    this.setState({ connected: true, token });\r\n    const cookies = new Cookies();\r\n    cookies.set(\"token\", token, { path: \"/\" });\r\n  };\r\n\r\n  disconnect = () => {\r\n    const cookies = new Cookies();\r\n    cookies.remove(\"token\", { path: \"/\" });\r\n    this.setState({ connected: false, token: \"\" });\r\n    console.log(\"Disconnected\");\r\n  };\r\n\r\n  render() {\r\n    if (this.state.pageActuelle === \"trip\") {\r\n      return (\r\n        <ShowVoyage\r\n          id={this.state.trip}\r\n          connected={this.state.connected}\r\n          connect={this.connect}\r\n          token={this.state.token}\r\n        />\r\n      );\r\n    } else if (this.state.pageActuelle === \"save\") {\r\n      return (\r\n        <AddVoyage\r\n          token={this.state.token}\r\n          connected={this.state.connected}\r\n          connect={this.connect}\r\n        />\r\n      );\r\n    } else if (this.state.pageActuelle === \"profile\") {\r\n      return (\r\n        <Profile\r\n          connected={this.state.connected}\r\n          token={this.state.token}\r\n          connect={this.connect}\r\n        />\r\n      );\r\n    } else if (this.state.pageActuelle === \"research\") {\r\n      return <SearchResult />;\r\n    } else if (this.state.pageActuelle === \"about\") {\r\n      return (\r\n        <About\r\n          token={this.state.token}\r\n          connected={this.state.connected}\r\n          connect={this.connect}\r\n        />\r\n      );\r\n    } else if (this.state.pageActuelle === \"settings\") {\r\n      return (\r\n        <Settings connected={this.state.connected} token={this.state.token} />\r\n      );\r\n    } else {\r\n      return (\r\n\t\t  <ShowCarte connected={this.state.connected} connect={this.connect} token={this.state.token} />\r\n      );\r\n    }\r\n  }\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}