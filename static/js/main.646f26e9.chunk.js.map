{"version":3,"sources":["NavigationBar.js","Upload.js","ResearchBarCity.js","editStep.js","addStep.js","ShowVoyage.js","AddVoyage.js","ShowCarte.js","Profile.js","SearchResult.js","About.js","App.js","serviceWorker.js","index.js"],"names":["NavigationBar","state","showLogin","showRegister","email","password","password2","firstname","lastname","registerSuccess","registerMessage","e","setState","onChange","target","name","value","onSubmitLogin","preventDefault","console","log","Axios","post","username","headers","then","res","props","connect","data","token","get","Authorization","Cookies","set","id","path","catch","err","onSubmitRegister","success","getStyleLogin","display","getStyleRegister","class","this","active","href","connected","onClick","style","type","placeholder","Component","Upload","files","filesToShow","handleChange","bind","event","changeButtonState","parentUpload","totalEndUpload","images","map","file","xhttp","XMLHttpRequest","img","onreadystatechange","readyState","status","addImgFile","image","idAPI","JSON","parse","responseText","length","open","setRequestHeader","send","stringify","link","isCover","FormData","append","ref","imgcontainer","i","key","width","height","src","URL","createObjectURL","alt","uploadID","refInput","accept","multiple","for","React","ResearchBarCity","researchRef","createRef","getdataback","parentV","response","current","innerHTML","forEach","item","option","document","createElement","innerText","display_name","onclick","refCity","parseFloat","lat","lon","appendChild","onKeyPress","hinter","ButtonDeleteTrip","window","confirm","location","hostname","deleteTrip","EditStep","title","step","city","arrival","departure","description","photos","departureTransport","editFunction","getLatLnt","newCity","newName","newDate","newDateDepart","newDepartureTransport","newDescription","newLat","newLnt","boutonOK","modal","refHead","inputphotoToReset","toggleModal","listformat","push","parentVoyage","reload","stageFrom","distance","country","mark","lng","lnt","etat","disabled","textContent","classList","toggle","stepKey","boutonDelete","deleteFunction","AddStep","addFunction","boutonOK2","imgcontainer2","trip","tripId","alert","EnteteVoyage","param","saveTripButton","verifIfTripAlreadySaved","monthNames","etapes","d","Date","getMonth","Math","ceil","date1","date2","getDateDebut","getDateFin","a","cname","ca","decodeURIComponent","cookie","split","c","charAt","substring","indexOf","superThis","visibility","recordedTrips","getCookie","xhttp2","index","splice","startdate","getMonthsDate1","stages","vegan","ecological","author","firstName","lastName","getDureeVoyage2","enddate","getDureeVoyage1","edit","border","changeCover","myTrip","saveTrip","EtapeVoyage","etape","photo","editStepKey","toString","ShowVoyage","loadDoc","verifTripIsMine","trips","parseInt","Map","center","zoom","TileLayer","attribution","url","Marker","position","Popup","UneEtape","refLocation","refName","refDate","refDescription","refDateDepart","refDepartureTransport","editStepLink","arguments","date","dateDepart","CreationVoyageAjoutEtapes","ecolo","voyageId","editStepBool","setTextInputRef","editStep","changeEnteteBackground","stepDescription","stepName","stepDate","stepDateDepart","stepDepartureTransport","stepCity","querySelector","ReactDOM","render","stepId","stepLat","stepLnt","stepFiles","backgroundImage","concat","addEtapeVoyage","ModalChargement","CreationVoyage","validity","valid","addMyVoyage","checked","className","required","htmlFor","addVoyageCheck","AddVoyage","startNewVoyage","chargement","newname","newdescription","newvegan","newecolo","ShowCarte","voyages","loadTrips","parentThis","voyage","Profile","getUserInfo","getTrips","tripTitles","containerStyle","backgroundColor","boxStyle","color","textAlign","margin","justifyContent","SearchForm","keyword","chercher","ResultList","firstParam","lastNqme","SearchResult","startNewSearch","toRender","About","App","disconnect","remove","cookies","urlParams","URLSearchParams","search","pageActuelle","Boolean","match","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister","error","message"],"mappings":"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","file":"static/js/main.646f26e9.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport Axios from \"axios\";\r\nimport Cookies from \"universal-cookie\";\r\n\r\nexport default class NavigationBar extends Component {\r\n  state = {\r\n    showLogin: false,\r\n    showRegister: false,\r\n    email: \"\",\r\n    password: \"\",\r\n    password2: \"\",\r\n    firstname: \"\",\r\n    lastname: \"\",\r\n    registerSuccess: \"\",\r\n    registerMessage: \"\",\r\n  };\r\n\r\n  showLogin = (e) => {\r\n    this.setState({ showLogin: !this.state.showLogin, showRegister: false });\r\n  };\r\n\r\n  showRegister = (e) => {\r\n    this.setState({ showRegister: !this.state.showRegister, showLogin: false });\r\n  };\r\n\r\n  onChange = (e) => {\r\n    this.setState({ [e.target.name]: e.target.value });\r\n  };\r\n\r\n  onSubmitLogin = (e) => {\r\n    e.preventDefault();\r\n    console.log(\"Login attempt\");\r\n    //get token from api\r\n    const headers = {\r\n      \"Content-Type\": \"application/json\",\r\n    };\r\n    Axios.post(\r\n      \"https://wtg.aymerik-diebold.fr/login_check\",\r\n      {\r\n        username: this.state.email,\r\n        password: this.state.password,\r\n      },\r\n      { headers }\r\n    )\r\n      .then((res) => {\r\n        console.log(res);\r\n        this.props.connect(res.data.token);\r\n        this.setState({ showLogin: false });\r\n\r\n        Axios.get(\"https://wtg.aymerik-diebold.fr/api/me\", {\r\n          headers: { Authorization: \"Bearer \" + res.data.token },\r\n        })\r\n          .then((res) => {\r\n            console.log(res);\r\n            const cookies = new Cookies();\r\n\t\t\t  cookies.set(\"id\", res.data.id, { path: \"/\" });\r\n          })\r\n          .catch((err) => {\r\n            console.log(\"Error when retrieve user id\");\r\n            throw err;\r\n          });\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"Login failed\");\r\n        this.setState({\r\n          registerSuccess: \"Email/password combination not found :(\",\r\n        });\r\n        throw err;\r\n      });\r\n  };\r\n\r\n  onSubmitRegister = (e) => {\r\n    e.preventDefault();\r\n    console.log(\"Register attempt\");\r\n    //todo: register to api\r\n    const headers = {\r\n      \"Content-Type\": \"application/json\",\r\n    };\r\n    if (this.state.password !== this.state.password2) {\r\n      this.setState({ registerMessage: \"Your passwords do not match :(\" });\r\n    } else if (\r\n      this.state.email === \"\" ||\r\n      this.state.password === \"\" ||\r\n      this.state.password2 === \"\"\r\n    ) {\r\n      this.setState({ registerMessage: \"Email and Password are required\" });\r\n    } else {\r\n      Axios.post(\r\n        \"https://wtg.aymerik-diebold.fr/register\",\r\n        {\r\n          email: this.state.email,\r\n          password: this.state.password,\r\n          firstname: this.state.firstname,\r\n          lastname: this.state.lastname,\r\n        },\r\n        { headers }\r\n      )\r\n        .then((res) => {\r\n          if (res.data.success === true) {\r\n            console.log(\"Registration successful!\");\r\n            this.setState({\r\n              registerSuccess:\r\n                \"Your account has been created! You can now log in\",\r\n              email: \"\",\r\n              password: \"\",\r\n              password2: \"\",\r\n              firstname: \"\",\r\n              lastname: \"\",\r\n              showRegister: false,\r\n              showLogin: true,\r\n            });\r\n          } else {\r\n            console.log(\"Registration failed :(\");\r\n            this.setState({\r\n              registerMessage: \"This email address is already registered\",\r\n            });\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(\"error\");\r\n          throw err;\r\n        });\r\n    }\r\n  };\r\n\r\n\r\n  getStyleLogin = () => {\r\n    return {\r\n      display: this.state.showLogin ? \"block\" : \"none\",\r\n    };\r\n  };\r\n\r\n  getStyleRegister = () => {\r\n    return {\r\n      display: this.state.showRegister ? \"block\" : \"none\",\r\n    };\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div class=\"topnav\">\r\n        {this.props.active == 0 ? (\r\n          <a class=\"active\" href=\"/WaysToGo/\">\r\n            WaysToGo\r\n          </a>\r\n        ) : (\r\n          <a href=\"/WaysToGo/\">WaysToGo</a>\r\n        )}\r\n        {/*this.props.active == 2 ? (\r\n          <a class=\"active\" href=\"#contact\">\r\n            Contact\r\n          </a>\r\n        ) : (\r\n          <a href=\"#contact\">Contact</a>\r\n        )*/}\r\n        {this.props.active == 3 ? (\r\n          <a class=\"active\" href=\"?show=about\">\r\n            About\r\n          </a>\r\n        ) : (\r\n          <a href=\"?show=about\">About</a>\r\n        )}\r\n        {this.props.connected ? (\r\n          <a class={this.props.active == 1 ? \"active\" : \"\"} href=\"?show=save\">\r\n            Add a Trip\r\n          </a>\r\n        ) : (\r\n          <span></span>\r\n        )}\r\n        {this.props.connected ? (\r\n          <a\r\n            class={this.props.active == 4 ? \"active\" : \"\"}\r\n            href=\"?show=profile\"\r\n          >\r\n            Profile\r\n          </a>\r\n        ) : (\r\n          <div>\r\n            <a class=\"connection\" onClick={this.showLogin}>\r\n              Login\r\n            </a>\r\n\r\n            <a class=\"connection\" onClick={this.showRegister}>\r\n              Register\r\n            </a>\r\n          </div>\r\n        )}\r\n        {this.props.connected ? (\r\n          <a href=\"?logout=true\">Logout</a>\r\n        ) : (\r\n          <span></span>\r\n        )}\r\n        {this.props.active == 5 ? (\r\n          <a class=\"active\" href={\"?show=research\"}>\r\n            {\" \"}\r\n            Recherche{\" \"}\r\n          </a>\r\n        ) : (\r\n          <a href={\"?show=research\"}>Recherche</a>\r\n        )}\r\n\r\n        <div id=\"login\" style={this.getStyleLogin()}>\r\n          <p>{this.state.registerSuccess}</p>\r\n          <p>Email</p>\r\n          <input\r\n            type=\"text\"\r\n            name=\"email\"\r\n            onChange={this.onChange}\r\n            value={this.state.email}\r\n            placeholder=\"john.doe@mail.com\"\r\n          />\r\n\r\n          <p>Password</p>\r\n          <input\r\n            type=\"password\"\r\n            name=\"password\"\r\n            onChange={this.onChange}\r\n            value={this.state.password}\r\n          />\r\n\r\n          <input\r\n            type=\"submit\"\r\n            name=\"submit\"\r\n            value=\"Login\"\r\n            onClick={this.onSubmitLogin}\r\n          />\r\n        </div>\r\n\r\n        <div id=\"register\" style={this.getStyleRegister()}>\r\n          <p>{this.state.registerMessage}</p>\r\n          <p>Email</p>\r\n          <input\r\n            type=\"text\"\r\n            name=\"email\"\r\n            onChange={this.onChange}\r\n            value={this.state.email}\r\n            placeholder=\"ex. john.doe@mail.com\"\r\n          />\r\n\r\n          <p>Firstname</p>\r\n          <input\r\n            type=\"text\"\r\n            name=\"firstname\"\r\n            onChange={this.onChange}\r\n            value={this.state.firstname}\r\n            placeholder=\"ex. John\"\r\n          />\r\n\r\n          <p>Lastname</p>\r\n          <input\r\n            type=\"text\"\r\n            name=\"lastname\"\r\n            onChange={this.onChange}\r\n            value={this.state.lastname}\r\n            placeholder=\"ex. Doe\"\r\n          />\r\n\r\n          <p>Password</p>\r\n          <input\r\n            type=\"password\"\r\n            name=\"password\"\r\n            onChange={this.onChange}\r\n            value={this.state.password}\r\n          />\r\n\r\n          <p>Confirm Password</p>\r\n          <input\r\n            type=\"password\"\r\n            name=\"password2\"\r\n            onChange={this.onChange}\r\n            value={this.state.password2}\r\n          />\r\n\r\n          <input\r\n            type=\"submit\"\r\n            name=\"submit\"\r\n            value=\"Login\"\r\n            onClick={this.onSubmitRegister}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\n\r\n// Gere l'ajout d'image et l'affichage. https://stackoverflow.com/questions/38049966/get-image-preview-before-uploading-in-react\r\nexport default class Upload extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props)\r\n\t\tthis.state = {\r\n\t\t\tfiles: props.files, // contient l'ensemble des images. Vide initialement. On passe la rfrence\r\n\t\t\tfilesToShow: []\r\n\t\t}\r\n\r\n\t\tthis.handleChange = this.handleChange.bind(this);\r\n\t}\r\n\r\n\t// when we get images\r\n\thandleChange(event) {\r\n\t\tthis.props.changeButtonState(true);\r\n\t\tthis.setState({\r\n\t\t\tfilesToShow: [...this.state.filesToShow, ...event.target.files] // ajout des nouvelles images a ceux deja existantes\r\n\t\t});\r\n\t\tconsole.log(this.state.files);\r\n\r\n\t\t//console.log([...event.target.files]);\r\n\t\tvar parentUpload = this;\r\n\t\tvar totalEndUpload = 0;\r\n\t\tvar images = event.target.files;\r\n\t\t[...event.target.files].map(function (file) {\r\n\t\t\t// senf img to imgbb for saving\r\n\t\t\t//console.log('send...');\r\n\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\tvar img = file;\r\n\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\t\t//console.log(\"upload finit\");\r\n\r\n\r\n\r\n\r\n\t\t\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\t\t\tif (this.readyState === 4 && this.status === 201) {\r\n\t\t\t\t\t\t\tconsole.log(\"Upload photo in API success\");\r\n\r\n\t\t\t\t\t\t\t//parentUpload.state.urllist.push(JSON.parse(this.responseText).id); // ajout des nouvelles url d'images a ceux deja existantes\r\n\t\t\t\t\t\t\tparentUpload.props.addImgFile({ image: img, idAPI: JSON.parse(this.responseText).id });\r\n\t\t\t\t\t\t\t//parentUpload.setState({\r\n\t\t\t\t\t\t\t//\tfiles: parentUpload.props.files.concat({ image: img, idAPI: JSON.parse(this.responseText).id }) // ajout des nouvelles images a ceux deja existantes\r\n\t\t\t\t\t\t\t//});\r\n\t\t\t\t\t\t\ttotalEndUpload += 1;\r\n\t\t\t\t\t\t\t//console.log(parentUpload.state.files);\r\n\t\t\t\t\t\t\tif (totalEndUpload == images.length) {\r\n\t\t\t\t\t\t\t\tparentUpload.props.changeButtonState(false);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t//parentUpload.state.files = [];\r\n\t\t\t\t\t\t\t//parentUpload.state.urllist = [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\txhttp.open(\"POST\", \"https://wtg.aymerik-diebold.fr/api/photos\", true);\r\n\t\t\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + parentUpload.props.token);\r\n\t\t\t\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\t\t\txhttp.send(JSON.stringify({\r\n\t\t\t\t\t\tpath: JSON.parse(this.responseText).data.link,\r\n\t\t\t\t\t\t//stage: parentVoyage.newDepartureTransport.current.value,\r\n\t\t\t\t\t\tisCover: false\r\n\t\t\t\t\t}));\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\r\n\t\t\txhttp.open(\"POST\", \"https://api.imgur.com/3/image\", true);\r\n\t\t\txhttp.setRequestHeader('Authorization', 'Client-ID 140f137c33f88ac');\r\n\r\n\t\t\tvar data = new FormData();\r\n\t\t\tdata.append('image', file);\r\n\r\n\t\t\txhttp.send(data);\r\n\t\t})\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<div ref={this.props.imgcontainer}>\r\n\t\t\t\t\t{/* Display all selected images. */}\r\n\t\t\t\t\t{this.state.filesToShow && [...this.state.filesToShow].map((file, i) => (\r\n\t\t\t\t\t\t<img key={i} width=\"200px\" height=\"200px\" src={URL.createObjectURL(file)} alt=\"Image\" />\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t\t<input id={this.props.uploadID} style={{ display: \"none\"}} ref={this.props.refInput} type=\"file\" accept=\"image/*\" multiple onChange={this.handleChange} />\r\n\t\t\t\t<label for={this.props.uploadID} class=\"custom-file-upload\">\r\n\t\t\t\t\tAdd images to this step\r\n\t\t\t\t</label>\r\n\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\n\r\n// Gere la recherche des villes/adresses dans la popup add new Voyage\r\nexport default class ResearchBarCity extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props)\r\n\r\n\t\tthis.researchRef = React.createRef();\r\n\t}\r\n\r\n\t// Autocomplete for form\r\n\thinter(event) {\r\n\t\t// save change\r\n\t\tthis.props.getdataback(0, 0);\r\n\r\n\t\t// minimum number of characters before we start to generate suggestions\r\n\t\tif (event.target.value.length < 2) return;\r\n\t\telse {\r\n\r\n\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\tvar parentV = this;\r\n\r\n\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\r\n\t\t\t\t\t// We're expecting a json response so we convert it to an object\r\n\t\t\t\t\tvar response = JSON.parse(this.responseText);\r\n\r\n\t\t\t\t\t// clear any previously loaded options in the datalist\r\n\t\t\t\t\tparentV.researchRef.current.innerHTML = \"\";\r\n\r\n\t\t\t\t\tresponse.forEach(function (item) {\r\n\t\t\t\t\t\tvar option = document.createElement('div');\r\n\r\n\t\t\t\t\t\toption.innerText = item.display_name;\r\n\t\t\t\t\t\t// add onclick event : we fill the input\r\n\t\t\t\t\t\toption.onclick = function () {\r\n\t\t\t\t\t\t\tparentV.props.refCity.current.value = this.innerText;\r\n\t\t\t\t\t\t\tparentV.props.getdataback(parseFloat(item.lat), parseFloat(item.lon));\r\n\t\t\t\t\t\t\tparentV.researchRef.current.innerHTML = \"\";\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t// attach the div to the list div\r\n\t\t\t\t\t\tparentV.researchRef.current.appendChild(option);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// we use nominatim from openstreetmap to resolve adress\r\n\t\t\txhttp.open(\"GET\", \"https://nominatim.openstreetmap.org/?addressdetails=1&format=json&limit=3&q=\" + this.props.refCity.current.value, true);\r\n\t\t\txhttp.send()\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<input ref={this.props.refCity} type=\"text\" name=\"lville\" placeholder=\"Place..\" id=\"name_input\" onKeyPress={this.hinter.bind(this)} />\r\n\t\t\t\t<div ref={this.researchRef} id=\"huge_list\"></div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport Upload from \"./Upload\";\r\nimport ResearchBarCity from \"./ResearchBarCity\";\r\n\r\n\r\n// show a button : delete trip when clicked\r\n// parameters : id (the id of trip to be delete)\r\n// return to the main page after deletion\r\nexport class ButtonDeleteTrip extends Component {\r\n\tdeleteTrip() {\r\n\t\tvar response = window.confirm(\"Delete ?\");\r\n\t\tif (response == true) {\r\n\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\tif (this.readyState === 4 && this.status === 204) {\r\n\t\t\t\t\twindow.location = window.location.hostname; // return to hostpage\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\txhttp.open(\"DELETE\", \"https://wtg.aymerik-diebold.fr/api/trips/\" + this.props.id, true);\r\n\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + this.props.token);\r\n\t\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\txhttp.send();\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<button type=\"button\" onClick={this.deleteTrip.bind(this)}>Delete step</button>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nclass EditStep extends Component {\r\n\tconstructor(props) {\r\n        super(props);\r\n\t\tthis.state = {\r\n\t\t\tfiles: [],\r\n\t\t\ttitle: props.step.title,\r\n\t\t\tcity: props.step.city,\r\n\t\t\tarrival: props.step.arrival,\r\n\t\t\tdeparture: props.step.departure,\r\n\t\t\t//departureTransport: props.step.departureTransport.type,\r\n\t\t\tdescription: props.step.description,\r\n\t\t\tid: props.step.id,\r\n\t\t\tphotos: props.step.photos\r\n\t\t};\r\n\t\tif (props.step.departureTransport && props.step.departureTransport !== 'undefined')\r\n\t\t\tthis.state.departureTransport = props.step.departureTransport.type;\r\n\r\n\t\tthis.editFunction = this.editFunction.bind(this);\r\n\t\tthis.getLatLnt = this.getLatLnt.bind(this);\r\n\t\tthis.addImgFile = this.addImgFile.bind(this)\r\n\r\n\t\tthis.newCity = React.createRef();\r\n\t\tthis.newName = React.createRef();\r\n\t\tthis.newDate = React.createRef();\r\n\t\tthis.newDateDepart = React.createRef();\r\n\t\tthis.newDepartureTransport = React.createRef();\r\n\t\tthis.newDescription = React.createRef();\r\n\r\n\t\tthis.newLat = React.createRef();\r\n\t\tthis.newLnt = React.createRef();\r\n\t\tthis.boutonOK = React.createRef();\r\n\t\tthis.modal = React.createRef();\r\n\r\n\t\tthis.refHead = React.createRef();\r\n\r\n\t\tthis.imgcontainer = React.createRef();\r\n\t\tthis.inputphotoToReset = React.createRef();\r\n\r\n\t\tthis.toggleModal = this.toggleModal.bind(this);\r\n\t}\r\n\r\n\teditFunction() {\r\n\t\tvar listformat = [];\r\n\t\t//console.log(this.state.files);\r\n\t\tif (this.state.files.length > 0) {\r\n\t\t\tthis.state.files.forEach(function (item) {\r\n\t\t\t\tlistformat.push(\"/api/photos/\" + item.idAPI);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tlistformat = this.props.photos;\r\n\t\t}\r\n\r\n\t\tvar xhttp = new XMLHttpRequest();\r\n\t\tvar parentVoyage = this;\r\n\t\txhttp.onreadystatechange = function () {\r\n\t\t\tconsole.log(this.responseText);\r\n\t\t\tvar res = this.responseText;\r\n\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\t// maintenant on envoi le transport\r\n\t\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\t\tconsole.log(this.responseText);\r\n\t\t\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\t\t\t//console.log(\"Upload transport etape success\");\r\n\t\t\t\t\t\tparentVoyage.toggleModal();\r\n\t\t\t\t\t\tdocument.location.reload(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\txhttp.open(\"PATCH\", \"https://wtg.aymerik-diebold.fr\" + JSON.parse(res).departureTransport, true);\r\n\t\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + parentVoyage.props.token);\r\n\t\t\t\txhttp.setRequestHeader('Content-Type', 'application/merge-patch+json');\r\n\t\t\t\txhttp.send(JSON.stringify({\r\n\t\t\t\t\tstageFrom: \"/api/stages/\" + JSON.parse(res).id,\r\n\t\t\t\t\ttype: parentVoyage.newDepartureTransport.current.value,\r\n\t\t\t\t\tdistance: 0\r\n\t\t\t\t}));\r\n\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\txhttp.open(\"PATCH\", \"https://wtg.aymerik-diebold.fr/api/stages/\" + this.state.id, true);\r\n\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + this.props.token);\r\n\t\txhttp.setRequestHeader('Content-Type', 'application/merge-patch+json');\r\n\t\txhttp.send(JSON.stringify({\r\n\t\t\tcity: this.newCity.current.value,\r\n\t\t\tcountry: \"rien\",\r\n\t\t\tmark: 0,\r\n\t\t\tdescription: this.newDescription.current.value,\r\n\t\t\tarrival: this.newDate.current.value,\r\n\t\t\tdeparture: this.newDateDepart.current.value,\r\n\t\t\tlng: this.state.newLat,\r\n\t\t\tlat: this.state.newLnt,\r\n\t\t\ttitle: this.newName.current.value,\r\n\t\t\tphotos: listformat\r\n\t\t}));\r\n    }\r\n\r\n    deleteFunction() {\r\n        var xhttp = new XMLHttpRequest();\r\n        var parentVoyage = this;\r\n        xhttp.onreadystatechange = function() {\r\n            console.log(this.responseText);\r\n            //var res = this.responseText;\r\n            if (this.readyState === 4 && this.status === 204) {\r\n                parentVoyage.toggleModal();\r\n\t\t\t\tdocument.location.reload(true);\r\n\r\n            }\r\n        };\r\n\r\n        xhttp.open(\"DELETE\", \"https://wtg.aymerik-diebold.fr/api/stages/\" + this.state.id, true);\r\n        xhttp.setRequestHeader('Authorization', 'Bearer ' + this.props.token);\r\n        xhttp.setRequestHeader('Content-Type', 'application/json');\r\n        xhttp.send();\r\n    }\r\n\r\n\tgetLatLnt(lat, lnt) {\r\n\t\tthis.setState({\r\n\t\t\tnewLnt: lnt,\r\n\t\t\tnewLat: lat\r\n\t\t})\r\n\t}\r\n\r\n\r\n\r\n\t// to edit pictures\r\n\r\n\taddImgFile(img) {\r\n\t\t//console.log(this);\r\n\t\t//console.log(this.state);\r\n\t\t//console.log(img);\r\n\t\tthis.state.files.push(img);\r\n\t\t/*this.setState = {\r\n\t\t\tfiles: this.state.files.concat(img) // ajout des nouvelles images a ceux deja existantes\r\n\t\t};*/\r\n\t\tconsole.log(this.state);\r\n\t}\r\n\tchangeButtonState(etat) {\r\n\t\tconsole.log(\"chargement\");\r\n\t\tthis.boutonOK.current.disabled = etat;\r\n\t\tif (etat === true)\r\n\t\t\tthis.boutonOK.current.textContent = \"Image upload in progress...\"\r\n\t\telse\r\n\t\t\tthis.boutonOK.current.textContent = \"Add step\"\r\n\t\t//console.log(\"change etat avec : \", etat);\r\n\t}\r\n\r\n\ttoggleModal() {\r\n\t\tconsole.log(\"toggle modal edit\");\r\n\r\n\t\t// change values inside the modal\r\n\t\tthis.newName.current.value = this.state.title;\r\n\t\tthis.newCity.current.value = this.state.city;\r\n\t\tthis.newDate.current.value = this.state.arrival;\r\n        this.newDateDepart.current.value = this.state.departure;\r\n        console.log(this.state.departureTransport);\r\n        //if (this.newDepartureTransport.current.value != \"undefined\") this.newDepartureTransport.current.value = this.state.departureTransport;\r\n        //else this.newDepartureTransport.current.value = \"\";\r\n        this.newDepartureTransport.current.value = this.state.departureTransport;\r\n        this.newDescription.current.value = this.state.description;\r\n\r\n\t\t// toggle modal\r\n\t\tthis.modal.current.classList.toggle(\"show-modal\");\r\n\t}\r\n\r\n\trender() {\r\n\t\t//console.log(\"je suis dans editStep\");\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<div ref={this.modal} class=\"modal2\">\r\n\t\t\t\t\t<div class=\"modal-content\">\r\n\t\t\t\t\t\t<span class=\"close-button\" onClick={this.toggleModal}></span>\r\n\r\n\t\t\t\t\t\t<label for=\"lville\">Location</label>\r\n\t\t\t\t\t\t<ResearchBarCity refCity={this.newCity} getdataback={this.getLatLnt} newLat={this.newLat} newLnt={this.newLnt} />\r\n\r\n\t\t\t\t\t\t<label for=\"nometape\">Step name</label>\r\n\t\t\t\t\t\t<input ref={this.newName} type=\"text\" id=\"nometape\" name=\"nometape\" placeholder=\"ex. visit of the Eiffel tower\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"larrivee\">Arrival date</label>\r\n\t\t\t\t\t\t<input ref={this.newDate} type=\"text\" id=\"larrivee\" name=\"larrivee\" placeholder=\"Arrival.. (YYYY-MM-DD)\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ldepart\">Departure date</label>\r\n\t\t\t\t\t\t<input ref={this.newDateDepart} type=\"text\" id=\"ldepart\" name=\"ldepart\" placeholder=\"Departure.. (YYYY-MM-DD)\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ltransport\">Moyen de transport entre tapes</label>\r\n\t\t\t\t\t\t<input ref={this.newDepartureTransport} type=\"text\" id=\"ltransport\" name=\"ltransport\" placeholder=\"Train, car, tuk-tuk, on foot ..\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ldescription\">Your story</label>\r\n\t\t\t\t\t\t<textarea ref={this.newDescription} id=\"ldescription\" name=\"ldescription\" placeholder=\"What you want..\"></textarea>\r\n\r\n\t\t\t\t\t\t<Upload key={\"addStep\" + this.props.stepKey} uploadID={\"editStep\" + this.props.stepKey} token={this.props.token} addImgFile={this.addImgFile} files={this.state.files} changeButtonState={this.changeButtonState.bind(this)} imgcontainer={this.imgcontainer} refInput={this.inputphotoToReset} />\r\n\r\n\t\t\t\t\t\t<button type=\"button\" ref={this.boutonOK} onClick={this.editFunction.bind(this)}>Edit step</button>\r\n                        <button type=\"button\" ref={this.boutonDelete} onClick={this.deleteFunction.bind(this)}>Delete step</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<button type=\"button\" onClick={this.toggleModal}>Edit step</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default EditStep;\r\n","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport Upload from \"./Upload\";\r\nimport ResearchBarCity from \"./ResearchBarCity\";\r\n\r\n\r\nexport default class AddStep extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tfiles: []\r\n\t\t};\r\n\r\n\t\tthis.addFunction = this.addFunction.bind(this);\r\n\t\tthis.getLatLnt = this.getLatLnt.bind(this);\r\n\t\tthis.addImgFile = this.addImgFile.bind(this);\r\n\t\tthis.toggleModal = this.toggleModal.bind(this);\r\n\r\n\t\tthis.newCity = React.createRef();\r\n\t\tthis.newName = React.createRef();\r\n\t\tthis.newDate = React.createRef();\r\n\t\tthis.newDateDepart = React.createRef();\r\n\t\tthis.newDepartureTransport = React.createRef();\r\n\t\tthis.newDescription = React.createRef();\r\n\r\n\t\tthis.newLat = React.createRef();\r\n\t\tthis.newLnt = React.createRef();\r\n\t\tthis.boutonOK2 = React.createRef();\r\n\t\tthis.modal = React.createRef();\r\n\t\tthis.imgcontainer2 = React.createRef();\r\n\t\tthis.inputphotoToReset = React.createRef();\r\n\t}\r\n\r\n\taddFunction() {\r\n\t\tif (this.newName.current.value != \"\" && this.newDate.current.value != \"\"\r\n\t\t\t&& this.newDateDepart.current.value != \"\" && this.newCity.current.value != \"\") {\r\n\t\t\tvar listformat = [];\r\n\t\t\tif (this.state.files.length > 0) {\r\n\t\t\t\tthis.state.files.forEach(function (item) {\r\n\t\t\t\t\tlistformat.push(\"/api/photos/\" + item.idAPI);\r\n\t\t\t\t});\r\n\t\t\t} else listformat = this.props.photos;\r\n\r\n\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\tvar parentVoyage = this;\r\n\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\tconsole.log(this.responseText);\r\n\t\t\t\tvar res = this.responseText;\r\n\t\t\t\tif (this.readyState === 4 && this.status === 201) {\r\n\t\t\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\t\t\tif (this.readyState === 4 && this.status === 201) {\r\n\t\t\t\t\t\t\tparentVoyage.toggleModal();\r\n\t\t\t\t\t\t\tdocument.location.reload(true); //reload page to see modifications\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\txhttp.open(\"POST\", \"https://wtg.aymerik-diebold.fr/api/transports\", true);\r\n\t\t\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + parentVoyage.props.token);\r\n\t\t\t\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\t\t\txhttp.send(JSON.stringify({\r\n\t\t\t\t\t\tstageFrom: \"/api/stages/\" + JSON.parse(res).id,\r\n\t\t\t\t\t\ttype: parentVoyage.newDepartureTransport.current.value,\r\n\t\t\t\t\t\tdistance: 0\r\n\t\t\t\t\t}));\r\n\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\txhttp.open(\"POST\", \"https://wtg.aymerik-diebold.fr/api/stages\", true);\r\n\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + this.props.token);\r\n\t\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\txhttp.send(JSON.stringify({\r\n\t\t\t\tcity: this.newCity.current.value,\r\n\t\t\t\tcountry: \"rien\",\r\n\t\t\t\tmark: 0,\r\n\t\t\t\tdescription: this.newDescription.current.value,\r\n\t\t\t\tarrival: this.newDate.current.value,\r\n\t\t\t\tdeparture: this.newDateDepart.current.value,\r\n\t\t\t\ttrip: \"/api/trips/\" + this.props.tripId,\r\n\t\t\t\tlng: this.state.newLat,\r\n\t\t\t\tlat: this.state.newLnt,\r\n\t\t\t\ttitle: this.newName.current.value,\r\n\t\t\t\tphotos: listformat\r\n\t\t\t}));\r\n\t\t} else alert(\"Location, name, arrival and departure date required\");\r\n\t}\r\n\r\n\tgetLatLnt(lat, lnt) {\r\n\t\tthis.setState({\r\n\t\t\tnewLnt: lnt,\r\n\t\t\tnewLat: lat\r\n\t\t})\r\n\t}\r\n\r\n\t// to edit pictures\r\n\taddImgFile(img) {\r\n\t\tthis.state.files.push(img);\r\n\t}\r\n\tchangeButtonState(etat) {\r\n\t\tthis.boutonOK2.current.disabled = etat; // disable button when upload, prevent button to be push until we have the ling of the image\r\n\t\tif (etat === true) this.boutonOK2.current.textContent = \"Image upload in progress...\"\r\n\t\telse this.boutonOK2.current.textContent = \"Add step\"\r\n\t}\r\n\r\n\t// show or hide modal\r\n\ttoggleModal() {\r\n\t\tconsole.log(\"toggle modal edit\");\r\n\r\n\t\t// change values inside the modal\r\n\t\tthis.newName.current.value = \"\";\r\n\t\tthis.newCity.current.value = \"\";\r\n\t\tthis.newDate.current.value = \"\";\r\n\t\tthis.newDateDepart.current.value = \"\";\r\n\t\tthis.newDepartureTransport.current.value = \"\";\r\n\t\tthis.newDescription.current.value = \"\";\r\n\r\n\t\t// toggle modal\r\n\t\tthis.modal.current.classList.toggle(\"show-modal3\");\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<div ref={this.modal} class=\"modal3\">\r\n\t\t\t\t\t<div class=\"modal-content\">\r\n\t\t\t\t\t\t<h5>Add Step</h5>\r\n\t\t\t\t\t\t<span class=\"close-button\" onClick={this.toggleModal}></span>\r\n\r\n\t\t\t\t\t\t<label for=\"lville\">Location</label>\r\n\t\t\t\t\t\t<ResearchBarCity refCity={this.newCity} getdataback={this.getLatLnt} newLat={this.newLat} newLnt={this.newLnt} />\r\n\r\n\t\t\t\t\t\t<label for=\"nometape\">Step name</label>\r\n\t\t\t\t\t\t<input ref={this.newName} type=\"text\" id=\"nometape\" name=\"nometape\" placeholder=\"ex. visit of the Eiffel tower\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"larrivee\">Arrival date</label>\r\n\t\t\t\t\t\t<input ref={this.newDate} type=\"text\" id=\"larrivee\" name=\"larrivee\" placeholder=\"Arrival.. (YYYY-MM-DD)\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ldepart\">Departure date</label>\r\n\t\t\t\t\t\t<input ref={this.newDateDepart} type=\"text\" id=\"ldepart\" name=\"ldepart\" placeholder=\"Departure.. (YYYY-MM-DD)\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ltransport\">Moyen de transport entre tapes</label>\r\n\t\t\t\t\t\t<input ref={this.newDepartureTransport} type=\"text\" id=\"ltransport\" name=\"ltransport\" placeholder=\"Train, car, tuk-tuk, on foot ..\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ldescription\">Your story</label>\r\n\t\t\t\t\t\t<textarea ref={this.newDescription} id=\"ldescription\" name=\"ldescription\" placeholder=\"What you want..\"></textarea>\r\n\r\n\t\t\t\t\t\t<Upload key={\"addStep\" + this.props.stepKey} uploadID={\"addStep\"} token={this.props.token} addImgFile={this.addImgFile} files={this.state.files} changeButtonState={this.changeButtonState.bind(this)} imgcontainer={this.imgcontainer2} refInput={this.inputphotoToReset} />\r\n\r\n\t\t\t\t\t\t<button type=\"button\" ref={this.boutonOK2} onClick={this.addFunction.bind(this)}>Add step</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<button type=\"button\" onClick={this.toggleModal}>Add step</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport { Map, TileLayer, Marker, Popup } from \"react-leaflet\";\r\nimport NavigationBar from \"./NavigationBar\";\r\nimport Axios from \"axios\";\r\nimport EditStep, { ButtonDeleteTrip } from \"./editStep.js\";\r\nimport AddStep from \"./addStep.js\";\r\n\r\n// show the head of the trip\r\n/* Need a parameter param like :\r\n * param = {\r\n * title = string\r\n * ?startdate = string in a good date format (aaaa-mm-dd)\r\n * vegan = bool\r\n * ecological = bool\r\n * author {\r\n *\t\tfirstName = string\r\n *\t\tlastName = string\r\n *\t}\r\n *\tstages = list of stage\r\n * }\r\n */\r\nexport class EnteteVoyage extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tparam: props.param,\r\n\t\t};\r\n\r\n\t\tthis.saveTripButton = React.createRef();\r\n\t\tthis.verifIfTripAlreadySaved = this.verifIfTripAlreadySaved.bind(this);\r\n\r\n\t\tthis.monthNames = [\r\n\t\t\t\"January\",\r\n\t\t\t\"February\",\r\n\t\t\t\"March\",\r\n\t\t\t\"April\",\r\n\t\t\t\"May\",\r\n\t\t\t\"June\",\r\n\t\t\t\"July\",\r\n\t\t\t\"August\",\r\n\t\t\t\"September\",\r\n\t\t\t\"October\",\r\n\t\t\t\"November\",\r\n\t\t\t\"December\",\r\n\t\t];\r\n\r\n\t}\r\n\r\n\t/* TODO :\r\n\t * qui retourne le nombre de photos\r\n\t * qui retourne le nombre de pays ou passe le voyage\r\n\t */\r\n\r\n\tgetStageNumber(etapes) {\r\n\t\treturn etapes.length;\r\n\t}\r\n\r\n\t// retourne le mois de debut\r\n\tgetDateDebut(etapes) {\r\n\t\tif (etapes.length > 0) {\r\n\t\t\tvar d = new Date(etapes[0].departure);\r\n\t\t\treturn this.monthNames[d.getMonth()];\r\n\t\t} else return null;\r\n\t}\r\n\r\n\t// retourne le mois de fin\r\n\tgetDateFin(etapes) {\r\n\t\tif (etapes.length > 0) {\r\n\t\t\tvar d = new Date(etapes[etapes.length - 1].arrival);\r\n\t\t\treturn this.monthNames[d.getMonth()];\r\n\t\t} else return 0;\r\n\t}\r\n\r\n\t// retourne le nombre de jours\r\n\tgetDureeVoyage1(etapes) {\r\n\t\tif (etapes.length > 0) {\r\n\t\t\tvar d =\r\n\t\t\t\tnew Date(etapes[etapes.length - 1].arrival) -\r\n\t\t\t\tnew Date(etapes[0].departure);\r\n\t\t\tconst diffDays = Math.ceil(d / (1000 * 60 * 60 * 24)) + 1;\r\n\t\t\treturn diffDays;\r\n\t\t} else return 0;\r\n\t}\r\n\r\n\tgetDureeVoyage2(date1, date2) {\r\n\t\tvar d = new Date(date2) - new Date(date1);\r\n\t\tconst diffDays = Math.ceil(d / (1000 * 60 * 60 * 24)) + 1;\r\n\t\treturn diffDays;\r\n\t}\r\n\r\n\t// renvoi la date a afficher (mois - mois)\r\n\tgetMonthsDate1(etapes) {\r\n\t\tif (etapes.length > 0) {\r\n\t\t\tvar d = this.getDateDebut(etapes);\r\n\t\t\tvar a = this.getDateFin(etapes);\r\n\t\t\tif (d !== a)\r\n\t\t\t\treturn this.getDateDebut(etapes) + \" - \" + this.getDateFin(etapes);\r\n\t\t\telse return d;\r\n\t\t} else return \"\";\r\n\t}\r\n\r\n\tgetMonthsDate2(date1, date2) {\r\n\t\tvar d = new Date(date1);\r\n\t\tvar a = new Date(date2);\r\n\t\tif (d.getMonth() !== a.getMonth())\r\n\t\t\treturn (\r\n\t\t\t\tthis.monthNames[d.getMonth()] + \" - \" + this.monthNames[a.getMonth()]\r\n\t\t\t);\r\n\t\telse return this.monthNames[d.getMonth()];\r\n\t}\r\n\r\n\t// from StackOverflow\r\n\tgetCookie(cname) {\r\n\t\tvar name = cname + \"=\";\r\n\t\tvar decodedCookie = decodeURIComponent(document.cookie);\r\n\t\tvar ca = decodedCookie.split(';');\r\n\t\tfor (var i = 0; i < ca.length; i++) {\r\n\t\t\tvar c = ca[i];\r\n\t\t\twhile (c.charAt(0) == ' ') {\r\n\t\t\t\tc = c.substring(1);\r\n\t\t\t}\r\n\t\t\tif (c.indexOf(name) == 0) {\r\n\t\t\t\treturn c.substring(name.length, c.length);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tverifIfTripAlreadySaved() {\r\n\t\t// if I'm connected : show the button save/de-save.\r\n\t\tif (this.props.connected) {\r\n\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\tvar superThis = this;\r\n\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\t\tsuperThis.saveTripButton.current.style.visibility = \"visible\";\r\n\r\n\t\t\t\t\tvar listformat = [];\r\n\t\t\t\t\t//console.log(JSON.parse(this.responseText));\r\n\t\t\t\t\tJSON.parse(this.responseText).recordedTrips.forEach(function (item) {\r\n\t\t\t\t\t\tlistformat.push(item[\"@id\"]);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (listformat.indexOf(\"/api/trips/\" + superThis.props.param.id) === -1) {\r\n\t\t\t\t\t\tsuperThis.saveTripButton.current.innerHTML = \"Save this trip\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tsuperThis.saveTripButton.current.innerHTML = \"Trip already saved :) Click to cancel\";\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\t//else if (this.readyState === 4 && this.status === 401) {\r\n\t\t\t\t// renouvellement token automatiquement\r\n\t\t\t\t/*const headers = {\r\n\t\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t\t};\r\n\t\t\t\tAxios.post(\r\n\t\t\t\t\t\"https://wtg.aymerik-diebold.fr/login_check\",\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tusername: \"mailleon@gmail.com\",\r\n\t\t\t\t\t\tpassword: \"monmdp111A!\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{ headers }\r\n\t\t\t\t)\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\t//console.log(res);\r\n\t\t\t\t\t\tsuperThis.props.connect(res.data.token);\r\n\t\t\t\t\t\tsuperThis.verifIfTripAlreadySaved();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((err) => {\r\n\t\t\t\t\t\tthrow err;\r\n\t\t\t\t\t});*/\r\n\t\t\t\t//alert(\"Connection time out. Please reconnect\");\r\n\t\t\t\t//}\r\n\t\t\t};\r\n\t\t\txhttp.open(\"GET\", \"https://wtg.aymerik-diebold.fr/api/users/\" + superThis.getCookie(\"id\"), true);\r\n\t\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + superThis.props.token);\r\n\t\t\txhttp.send();\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.verifIfTripAlreadySaved();\r\n\t};\r\n\r\n\tsaveTrip() {\r\n\t\t//console.log(document.cookie);\r\n\r\n\t\t// we first retrieve user already saved Trips\r\n\t\tvar xhttp = new XMLHttpRequest();\r\n\t\tvar superThis = this;\r\n\t\txhttp.onreadystatechange = function () {\r\n\t\t\t//console.log(this.responseText);\r\n\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\t//console.log(\"SUCCESS\");\r\n\r\n\t\t\t\tvar res = JSON.parse(this.responseText);\r\n\t\t\t\tvar listformat = [];\r\n\t\t\t\tres.recordedTrips.forEach(function (item) {\r\n\t\t\t\t\tlistformat.push(item[\"@id\"]);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// if trip is already saved, we delete it, else we saved it\r\n\t\t\t\tvar index = listformat.indexOf(\"/api/trips/\" + superThis.props.param.id);\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\tif (index > -1) {\r\n\t\t\t\t\t\tlistformat.splice(index, 1);\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tvar xhttp2 = new XMLHttpRequest();\r\n\t\t\t\t\txhttp2.onreadystatechange = function () {\r\n\t\t\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\t\t\t\tsuperThis.saveTripButton.current.innerHTML = \"Save this trip\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\txhttp2.open(\"PATCH\", \"https://wtg.aymerik-diebold.fr/api/users/\" + superThis.getCookie(\"id\"), true);\r\n\t\t\t\t\txhttp2.setRequestHeader('Content-Type', 'application/merge-patch+json');\r\n\t\t\t\t\txhttp2.setRequestHeader('Authorization', 'Bearer ' + superThis.props.token);\r\n\r\n\t\t\t\t\t//console.log([...new Set(listformat)]);\r\n\t\t\t\t\txhttp2.send(JSON.stringify({\r\n\t\t\t\t\t\t\"recordedTrips\": listformat // to onsure each trip is saved only one time\r\n\t\t\t\t\t}));\r\n\r\n\r\n\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t// then we add the new trip to the olders\r\n\t\t\t\t\tvar xhttp2 = new XMLHttpRequest();\r\n\t\t\t\t\txhttp2.onreadystatechange = function () {\r\n\t\t\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\t\t\t\tsuperThis.saveTripButton.current.innerHTML = \"Trip saved :) Click to cancel\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\t//console.log(\"https://wtg.aymerik-diebold.fr/api/users/\" + superThis.getCookie(\"id\"));\r\n\t\t\t\t\txhttp2.open(\"PATCH\", \"https://wtg.aymerik-diebold.fr/api/users/\" + superThis.getCookie(\"id\"), true);\r\n\t\t\t\t\txhttp2.setRequestHeader('Content-Type', 'application/merge-patch+json');\r\n\t\t\t\t\txhttp2.setRequestHeader('Authorization', 'Bearer ' + superThis.props.token);\r\n\r\n\t\t\t\t\tlistformat.push(\"/api/trips/\" + superThis.props.param.id);\r\n\t\t\t\t\t//console.log([...new Set(listformat)]);\r\n\t\t\t\t\txhttp2.send(JSON.stringify({\r\n\t\t\t\t\t\t\"recordedTrips\": listformat // to onsure each trip is saved only one time\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\txhttp.open(\"GET\", \"https://wtg.aymerik-diebold.fr/api/users/\" + this.getCookie(\"id\"), true);\r\n\t\txhttp.setRequestHeader('Content-Type', 'application/merge-patch+json');\r\n\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + this.props.token);\r\n\t\txhttp.send();\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div ref={this.state.param.refHead} id=\"head\">\r\n\t\t\t\t<h2>{this.state.param.title}</h2>\r\n\t\t\t\t<h5>\r\n\t\t\t\t\t{this.state.param.startdate\r\n\t\t\t\t\t\t? \"\"\r\n\t\t\t\t\t\t: this.getMonthsDate1(this.state.param.stages)}\r\n\t\t\t\t</h5>\r\n\t\t\t\t<p class=\"ladescription\">{'\"' + this.state.param.description + '\"'}</p>\r\n\t\t\t\t<p>\r\n\t\t\t\t\t{this.state.param.vegan\r\n\t\t\t\t\t\t? \"This trip is vegan\"\r\n\t\t\t\t\t\t: \"This trip is non-vegan\"}\r\n\t\t\t\t</p>\r\n\t\t\t\t<p>\r\n\t\t\t\t\t{this.state.param.ecological\r\n\t\t\t\t\t\t? \"This trip is ecological\"\r\n\t\t\t\t\t\t: \"This trip is marked as non-ecological\"}\r\n\t\t\t\t</p>\r\n\t\t\t\t<p>\r\n\t\t\t\t\tauteur :{\" \"}\r\n\t\t\t\t\t{this.state.param.author.firstName +\r\n\t\t\t\t\t\t\" \" +\r\n\t\t\t\t\t\tthis.state.param.author.lastName}\r\n\t\t\t\t</p>\r\n\t\t\t\t<p>\r\n\t\t\t\t\tDure du voyage :{\" \"}\r\n\t\t\t\t\t{this.state.param.startdate\r\n\t\t\t\t\t\t? this.getDureeVoyage2(\r\n\t\t\t\t\t\t\tthis.state.param.startdate,\r\n\t\t\t\t\t\t\tthis.state.param.enddate\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t: this.getDureeVoyage1(this.state.param.stages)}{\" \"}\r\n\t\t\t\t\tjours\r\n        </p>\r\n\t\t\t\t{this.state.param.edit ? (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<label for=\"files2\" style={{ border: \"2px solid black\" }}>\r\n\t\t\t\t\t\t\tChange cover image\r\n            </label>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tid=\"files2\"\r\n\t\t\t\t\t\t\tstyle={{ visibility: \"hidden\" }}\r\n\t\t\t\t\t\t\tref={this.state.param.refHead}\r\n\t\t\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\t\t\taccept=\"image/*\"\r\n\t\t\t\t\t\t\tonChange={this.state.param.changeCover}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t{this.props.myTrip ?\r\n\t\t\t\t\t\t\t\t<ButtonDeleteTrip id={this.state.param.id} token={this.props.token} />\r\n\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t<button ref={this.saveTripButton} style={{ visibility: \"hidden\" }} type=\"button\" onClick={() => this.saveTrip()}>Save this trip</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n// render a step\r\nexport class EtapeVoyage extends React.Component {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<div class=\"etape\">\r\n\t\t\t\t\t<p class=\"nomEtape\">{this.props.etape.description}</p>\r\n\r\n\t\t\t\t\t<p class=\"villedate_etape\">\r\n\t\t\t\t\t\t{this.props.etape.city + \"  \" + new Date(this.props.etape.arrival)}\r\n\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t{this.props.etape.photos.map((photo, i) => (\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\tkey={this.props.editStepKey.toString() + i.toString()}\r\n\t\t\t\t\t\t\t\tsrc={photo.path}\r\n\t\t\t\t\t\t\t\talt={photo.title}\r\n\t\t\t\t\t\t\t\theight=\"150\"\r\n\t\t\t\t\t\t\t\twidth=\"200\"\r\n\t\t\t\t\t\t\t></img>\r\n\r\n\t\t\t\t\t\t\t<p key={i}>{photo.description}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\r\n\t\t\t\t\t{this.props.myTrip ?\r\n\t\t\t\t\t\t<EditStep key={this.props.editStepKey.toString + \"add\"} stepKey={this.props.editStepKey} step={this.props.etape} token={this.props.token} />\r\n\t\t\t\t\t\t//console.log(\"here\")\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{this.props.etape.departureTransport ? (\r\n\t\t\t\t\t<div class=\"transition_etape\">\r\n\t\t\t\t\t\t<p class=\"transitionTexte\">\r\n\t\t\t\t\t\t\t Moyen de transport : {this.props.etape.departureTransport.type}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t)}\r\n\t\t\t\t{/*this.props.myTrip ?\r\n\t\t\t\t\t<AddStep tripId={this.props.tripId} key={this.props.editStepKey} stepKey={this.props.editStepKey} token={this.props.token} />\r\n\t\t\t\t\t//console.log(\"here\")\r\n\t\t\t\t\t:\r\n\t\t\t\t\tconsole.log(\"not here\")\r\n\t\t\t\t*/}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nclass ShowVoyage extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.loadDoc(this); // on recupere le voyage souhaite avec une requete ajax\r\n\t\tthis.verifTripIsMine(this);\r\n\r\n\t\tthis.state = {\r\n\t\t\tparam: false,\r\n\t\t\tmyTrip: false\r\n\t\t};\r\n\t}\r\n\r\n\tverifTripIsMine() {\r\n\t\tAxios.get(\"https://wtg.aymerik-diebold.fr/api/me\", {\r\n\t\t\theaders: { Authorization: \"Bearer \" + this.props.token },\r\n\t\t}).then((res) => {\r\n\r\n\r\n\t\t\t//var res2 = res.data.trips;\r\n\t\t\t//console.log(res2);\r\n\t\t\tvar listformat = [];\r\n\t\t\tres.data.trips.forEach(function (item) {\r\n\t\t\t\tlistformat.push(parseInt(item.id));\r\n\t\t\t});\r\n\r\n\r\n\t\t\tvar index = listformat.indexOf(parseInt(this.props.id));\r\n\t\t\tif (index != -1) {\r\n\t\t\t\tthis.setState({ myTrip: true });\r\n\t\t\t}\r\n\r\n\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tconsole.log(\"Error when retrieve user id\");\r\n\t\t\t\tthrow err;\r\n\t\t\t});\r\n\t}\r\n\r\n\tloadDoc(parentVoyage) {\r\n\t\tvar xhttp = new XMLHttpRequest();\r\n\t\txhttp.onreadystatechange = function () {\r\n\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\tconst param = JSON.parse(this.responseText);\r\n\t\t\t\tparentVoyage.setState({ param: param });\r\n\t\t\t}\r\n\t\t};\r\n\t\txhttp.open(\r\n\t\t\t\"GET\",\r\n\t\t\t\"https://wtg.aymerik-diebold.fr/api/trips/\" + parentVoyage.props.id,\r\n\t\t\ttrue\r\n\t\t);\r\n\t\txhttp.send();\r\n\t}\r\n\r\n\trender() {\r\n\t\tvar content = \"\";\r\n\t\tif (!this.state.param) {\r\n\t\t\tcontent = (\r\n\t\t\t\t<h1>Chargement en cours...</h1>\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tcontent = (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<NavigationBar\r\n\t\t\t\t\t\tconnected={this.props.connected}\r\n\t\t\t\t\t\tconnect={this.props.connect}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<div id=\"carteSide\">\r\n\t\t\t\t\t\t<Map id=\"ShowVoyageMap\" center={[40.0, 3.0]} zoom={1}>\r\n\t\t\t\t\t\t\t<TileLayer\r\n\t\t\t\t\t\t\t\tattribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n\t\t\t\t\t\t\t\turl=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t{this.state.param.stages.map((etape) => (\r\n\t\t\t\t\t\t\t\t<Marker position={[etape.lng, etape.lat]}>\r\n\t\t\t\t\t\t\t\t\t<Popup>\r\n\t\t\t\t\t\t\t\t\t\t<h1>{etape.description}</h1>\r\n\t\t\t\t\t\t\t\t\t</Popup>\r\n\t\t\t\t\t\t\t\t</Marker>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</Map>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div id=\"information\">\r\n\t\t\t\t\t\t<EnteteVoyage param={this.state.param} myTrip={this.state.myTrip} token={this.props.token} connect={this.props.connect} connected={this.props.connected} />\r\n\t\t\t\t\t\t{this.state.myTrip ?\r\n\t\t\t\t\t\t\t<AddStep tripId={this.state.param.id} key={\"firstAddStep\"} stepKey={\"firstAddStep\"} token={this.props.token} />\r\n\t\t\t\t\t\t\t//console.log(\"here\")\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\tconsole.log(\"not here\")\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<div id=\"etapes\">\r\n\t\t\t\t\t\t\t{this.state.param.stages.map((etape, i) => (\r\n\t\t\t\t\t\t\t\t<EtapeVoyage key={i} tripId={this.state.param.id} etape={etape} editStepKey={i} photos={etape.photos} myTrip={this.state.myTrip} token={this.props.token} />\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn content;\r\n\t}\r\n}\r\n\r\nexport default ShowVoyage;\r\n","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport { EnteteVoyage } from \"./ShowVoyage\";\r\nimport ReactDOM from \"react-dom\";\r\nimport NavigationBar from \"./NavigationBar\";\r\nimport Upload from \"./Upload\";\r\nimport ResearchBarCity from \"./ResearchBarCity\";\r\n\r\n/* Parametre : \r\n * arguments {\r\n *\tname {\r\n *\t\tvalue\r\n *\t},\r\n *\tlocation {\r\n *\t\tvalue\r\n *\t},\r\n *\tdate {\r\n *\t\tvalue\r\n *\t},\r\n *\tstory {\r\n *\t\tvalue\r\n *\t},\r\n *\tfiles {\r\n *\t\tvalue\r\n *\t},\r\n * }\r\n */\r\nclass UneEtape extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.refLocation = React.createRef();\r\n\t\tthis.refName = React.createRef();\r\n\t\tthis.refDate = React.createRef();\r\n\t\tthis.refDescription = React.createRef();\r\n\t\tthis.refDateDepart = React.createRef();\r\n\t\tthis.refDepartureTransport = React.createRef();\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div class=\"etapevoyage\">\r\n\t\t\t\t<button type=\"button\" onClick={() => this.props.editStepLink(this.refName, this.refLocation, this.refDate, this.refDateDepart, this.refDepartureTransport, this.refDescription)}>Edit step</button>\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t<label>Location : </label>\r\n\t\t\t\t<label ref={this.refLocation}>{this.props.arguments.location}</label>\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t<label>Step name : </label>\r\n\t\t\t\t<label ref={this.refName}>{this.props.arguments.name}</label>\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t<label>Arrival date : </label>\r\n\t\t\t\t<label ref={this.refDate}>{this.props.arguments.date}</label>\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t<label>Departure date : </label>\r\n\t\t\t\t<label ref={this.refDateDepart}>{this.props.arguments.dateDepart}</label>\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t<label>Moyen de transport : </label>\r\n\t\t\t\t<label ref={this.refDepartureTransport}>{this.props.arguments.departureTransport}</label>\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t<label>Your story : </label>\r\n\t\t\t\t<label ref={this.refDescription}>{this.props.arguments.description}</label>\r\n\t\t\t\t<br></br>\r\n\r\n\t\t\t\t{this.props.arguments.files && [...this.props.arguments.files].map((file, i) => (\r\n\t\t\t\t\t<img key={i} width=\"200px\" height=\"200px\" src={URL.createObjectURL(file.image)} alt=\"Image\" />\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\n// seconde vue de la cration de voyage : permet d'ajouter des etapes\r\nclass CreationVoyageAjoutEtapes extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tname: props.name,\r\n\t\t\tdescription: props.description,\r\n\t\t\tvegan: props.vegan,\r\n\t\t\tecolo: props.ecolo,\r\n\t\t\tvoyageId: props.voyageId,\r\n\t\t\teditStepBool: false,\r\n\t\t\t//trips: props.trips,\r\n\r\n\t\t\tfiles: []\r\n\t\t};\r\n\r\n\t\tthis.setTextInputRef = React.createRef();\r\n\r\n\t\tthis.inputphotoToReset = React.createRef();\r\n\t\tthis.imgcontainer = React.createRef();\r\n\r\n\t\tthis.toggleModal = this.toggleModal.bind(this)\r\n\t\tthis.getLatLnt = this.getLatLnt.bind(this);\r\n\t\tthis.editStep = this.editStep.bind(this);\r\n\t\tthis.changeEnteteBackground = this.changeEnteteBackground.bind(this);\r\n\r\n\t\tthis.newCity = React.createRef();\r\n\t\tthis.newName = React.createRef();\r\n\t\tthis.newDate = React.createRef();\r\n\t\tthis.newDateDepart = React.createRef();\r\n\t\tthis.newDepartureTransport = React.createRef();\r\n\t\tthis.newDescription = React.createRef();\r\n\r\n\t\tthis.newLat = React.createRef();\r\n\t\tthis.newLnt = React.createRef();\r\n\t\tthis.boutonOK = React.createRef();\r\n\r\n\t\tthis.refHead = React.createRef();\r\n\t}\r\n\r\n\teditStep(refName, refLocation, refDate, refDateDepart, refDepartureTransport, refDescription) {\r\n\t\t//console.log(\"EDIT !\");\r\n\t\t// reset values of components in the modal\r\n\t\tthis.newDescription.current.value = this.state.stepDescription;\r\n\t\tthis.newName.current.value = this.state.stepName;\r\n\t\tthis.newDate.current.value = this.state.stepDate;\r\n\t\tthis.newDateDepart.current.value = this.state.stepDateDepart;\r\n\t\tthis.newDepartureTransport.current.value = this.state.stepDepartureTransport;\r\n\t\tthis.newCity.current.value = this.state.stepCity;\r\n\r\n\r\n\t\tthis.setState({\r\n\t\t\teditStepBool: true,\r\n\t\t\t//refLocation: refLocation,\r\n\t\t\tstepDate: refDate,\r\n\t\t\tstepDateDepart: refDateDepart,\r\n\t\t\tstepDepartureTransport: refDepartureTransport,\r\n\t\t\t//refDescription: refDescription,\r\n\t\t\trefName: refName,\r\n\t\t})\r\n\r\n\t\t//console.log(this.state.refLocation);\r\n\r\n\t\tdocument.querySelector(\".modal\").classList.toggle(\"show-modal\");\r\n\t}\r\n\r\n\taddEtapeVoyage() {\r\n\t\tif (this.newName.current.value != \"\" && this.newDate.current.value != \"\"\r\n\t\t\t&& this.newDateDepart.current.value != \"\" && this.newCity.current.value != \"\") {\r\n\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\tvar parentVoyage = this;\r\n\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\tvar res = this.responseText;\r\n\t\t\t\tif (this.readyState === 4 && this.status === 201) {\r\n\t\t\t\t\tif (parentVoyage.state.editStepBool == false) {\r\n\t\t\t\t\t\tReactDOM.render(<UneEtape arguments={\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\"location\": parentVoyage.newCity.current.value,\r\n\t\t\t\t\t\t\t\t\"files\": parentVoyage.state.files,\r\n\t\t\t\t\t\t\t\t\"description\": parentVoyage.newDescription.current.value,\r\n\t\t\t\t\t\t\t\t\"date\": parentVoyage.newDate.current.value,\r\n\t\t\t\t\t\t\t\t\"dateDepart\": parentVoyage.newDateDepart.current.value,\r\n\t\t\t\t\t\t\t\t\"departureTransport\": parentVoyage.newDepartureTransport.current.value,\r\n\t\t\t\t\t\t\t\t\"name\": parentVoyage.newName.current.value\r\n\t\t\t\t\t\t\t}} editStepLink={parentVoyage.editStep} />, parentVoyage.setTextInputRef.current.appendChild(document.createElement('div')))\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tparentVoyage.state.refLocation.current.textContent = parentVoyage.newCity.current.value;\r\n\t\t\t\t\t\tparentVoyage.state.refDate.current.textContent = parentVoyage.newDate.current.value;\r\n\t\t\t\t\t\tparentVoyage.state.refDateDepart.current.textContent = parentVoyage.newDateDepart.current.value;\r\n\t\t\t\t\t\tparentVoyage.state.refDepartureTransport.current.textContent = parentVoyage.newDepartureTransport.current.value;\r\n\t\t\t\t\t\tparentVoyage.state.refDescription.current.textContent = parentVoyage.newDescription.current.value;\r\n\t\t\t\t\t\tparentVoyage.state.refName.current.textContent = parentVoyage.newName.current.value;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// maintenant on envoi le transport\r\n\t\t\t\t\tvar xhttp = new XMLHttpRequest();\r\n\t\t\t\t\txhttp.onreadystatechange = function () {\r\n\t\t\t\t\t\t//console.log(this.responseText);\r\n\t\t\t\t\t\tif (this.readyState === 4 && this.status === 201) {\r\n\t\t\t\t\t\t\t//console.log(\"Upload transport etape success\");\r\n\t\t\t\t\t\t\tparentVoyage.state.editStepBool = false;\r\n\t\t\t\t\t\t\tparentVoyage.toggleModal();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\txhttp.open(\"POST\", \"https://wtg.aymerik-diebold.fr/api/transports\", true);\r\n\t\t\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + parentVoyage.props.token);\r\n\t\t\t\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\t\t\txhttp.send(JSON.stringify({\r\n\t\t\t\t\t\tstageFrom: \"/api/stages/\" + JSON.parse(res).id,\r\n\t\t\t\t\t\ttype: parentVoyage.newDepartureTransport.current.value,\r\n\t\t\t\t\t\tdistance: 0\r\n\t\t\t\t\t}));\r\n\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tstepDescription: this.newDescription.current.value,\r\n\t\t\t\tstepName: this.newName.current.value,\r\n\t\t\t\tstepDate: this.newDate.current.value,\r\n\t\t\t\tstepDateDepart: this.newDateDepart.current.value,\r\n\t\t\t\tstepDepartureTransport: this.newDepartureTransport.current.value,\r\n\t\t\t\tstepId: this.state.voyageId,\r\n\t\t\t\tstepLat: this.state.newLat,\r\n\t\t\t\tstepLnt: this.state.newLnt,\r\n\t\t\t\tstepCity: this.newCity.current.value,\r\n\t\t\t\tstepFiles: this.state.files\r\n\t\t\t})\r\n\r\n\t\t\tvar listformat = [];\r\n\t\t\t//console.log(this.state.files);\r\n\t\t\tthis.state.files.forEach(function (item) {\r\n\t\t\t\tlistformat.push(\"/api/photos/\" + item.idAPI);\r\n\t\t\t});\r\n\t\t\t//console.log(listformat);\r\n\r\n\t\t\txhttp.open(\"POST\", \"https://wtg.aymerik-diebold.fr/api/stages\", true);\r\n\t\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + this.props.token);\r\n\t\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\txhttp.send(JSON.stringify({\r\n\t\t\t\tcity: this.newCity.current.value,\r\n\t\t\t\tcountry: \"rien\",\r\n\t\t\t\tmark: 0,\r\n\t\t\t\tdescription: this.newDescription.current.value,\r\n\t\t\t\tarrival: this.newDate.current.value,\r\n\t\t\t\tdeparture: this.newDateDepart.current.value,\r\n\t\t\t\t//departureTransport: this.newDepartureTransport.current.value,\r\n\t\t\t\ttrip: \"/api/trips/\" + this.state.voyageId,\r\n\t\t\t\tlng: this.state.newLat,\r\n\t\t\t\tlat: this.state.newLnt,\r\n\t\t\t\ttitle: this.newName.current.value,\r\n\t\t\t\tphotos: listformat\r\n\t\t\t}));\r\n\t\t} else {\r\n\t\t\talert(\"Location, name, arrival and departure date required\");\r\n\t\t}\r\n\t}\r\n\r\n\ttoggleModal() {\r\n\t\tdocument.querySelector(\".modal\").classList.toggle(\"show-modal\");\r\n\r\n\t\t// reset values of components in the modal\r\n\t\tthis.newDescription.current.value = \"\";\r\n\t\tthis.newName.current.value = \"\";\r\n\t\tthis.newDate.current.value = \"\";\r\n\t\tthis.newDateDepart.current.value = \"\";\r\n\t\tthis.newDepartureTransport.current.value = \"\";\r\n\t\tthis.newCity.current.value = \"\";\r\n\t\tthis.inputphotoToReset.current.value = \"\";\r\n\t\tthis.imgcontainer.current.textContent = \"\"; // textContent is faster than innerHTML\r\n\r\n\t\tthis.setState({\r\n\t\t\tfiles: []\r\n\t\t})\r\n\t}\r\n\r\n\tchangeButtonState(etat) {\r\n\t\tthis.boutonOK.current.disabled = etat;\r\n\t\tif (etat == true)\r\n\t\t\tthis.boutonOK.current.textContent = \"Image upload in progress...\"\r\n\t\telse\r\n\t\t\tthis.boutonOK.current.textContent = \"Add step\"\r\n\t\t//console.log(\"change etat avec : \", etat);\r\n\t}\r\n\r\n\tgetLatLnt(lat, lnt) {\r\n\t\tthis.setState({\r\n\t\t\tnewLnt: lnt,\r\n\t\t\tnewLat: lat\r\n\t\t})\r\n\t}\r\n\r\n\tchangeEnteteBackground(event) {\r\n\t\t// linear black gradient to blacker the img\r\n\t\tthis.refHead.current.style.backgroundImage = \"linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('\" + URL.createObjectURL(event.target.files[0]) + \"')\";\r\n\t}\r\n\r\n\taddImgFile(img) {\r\n\t\tthis.setState({\r\n\t\t\tfiles: this.state.files.concat(img) // ajout des nouvelles images a ceux deja existantes\r\n\t\t});\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div id=\"information\">\r\n\t\t\t\t<EnteteVoyage param={{ changeCover: this.changeEnteteBackground, edit: true, refHead: this.refHead, title: this.state.name, description: this.state.description, vegan: this.state.vegan, ecolo: this.state.ecolo, stages: [], author: { firstName: \"Nicolas\", lastName: \"Dupond\" } }} />\r\n\r\n\t\t\t\t<div ref={this.setTextInputRef}></div>\r\n\r\n\t\t\t\t<div class=\"modal\">\r\n\t\t\t\t\t<div class=\"modal-content\">\r\n\t\t\t\t\t\t<span class=\"close-button\" onClick={this.toggleModal}></span>\r\n\t\t\t\t\t\t{/*https://community.algolia.com/places/documentation.html#getting-started */}\r\n\t\t\t\t\t\t<label for=\"lville\">Location</label>\r\n\t\t\t\t\t\t<ResearchBarCity refCity={this.newCity} getdataback={this.getLatLnt} newLat={this.newLat} newLnt={this.newLnt} />\r\n\r\n\t\t\t\t\t\t<label for=\"nometape\">Step name</label>\r\n\t\t\t\t\t\t<input ref={this.newName} type=\"text\" id=\"nometape\" name=\"nometape\" placeholder=\"ex. visit of the Eiffel tower\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"larrivee\">Arrival date</label>\r\n\t\t\t\t\t\t<input ref={this.newDate} type=\"text\" id=\"larrivee\" name=\"larrivee\" placeholder=\"Arrival.. (YYYY-MM-DD)\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ldepart\">Departure date</label>\r\n\t\t\t\t\t\t<input ref={this.newDateDepart} type=\"text\" id=\"ldepart\" name=\"ldepart\" placeholder=\"Departure.. (YYYY-MM-DD)\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ltransport\">Moyen de transport entre tapes</label>\r\n\t\t\t\t\t\t<input ref={this.newDepartureTransport} type=\"text\" id=\"ltransport\" name=\"ltransport\" placeholder=\"Train, car, tuk-tuk, on foot ..\"></input>\r\n\r\n\t\t\t\t\t\t<label for=\"ldescription\">Your story</label>\r\n\t\t\t\t\t\t<textarea ref={this.newDescription} id=\"ldescription\" name=\"ldescription\" placeholder=\"What you want..\"></textarea>\r\n\r\n\t\t\t\t\t\t<Upload token={this.props.token} uploadID={\"addVoyage\"} addImgFile={this.addImgFile.bind(this)} files={this.state.files} changeButtonState={this.changeButtonState.bind(this)} imgcontainer={this.imgcontainer} refInput={this.inputphotoToReset} />\r\n\r\n\t\t\t\t\t\t<button type=\"button\" ref={this.boutonOK} onClick={this.addEtapeVoyage.bind(this)}>Add step</button>\r\n\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<button class=\"trigger\" onClick={this.toggleModal}>Add a step</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\nclass ModalChargement extends React.Component {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div class=\"modal_chargement\">\r\n\t\t\t\t<div class=\"modal-content\">\r\n\t\t\t\t\t<p>Chargement</p>\r\n\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\n\r\nclass CreationVoyage extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.description = React.createRef();\r\n\t\tthis.name = React.createRef();\r\n\t\tthis.vegan = React.createRef();\r\n\t\tthis.ecolo = React.createRef();\r\n\t}\r\n\r\n\taddVoyageCheck() {\r\n\t\tif (this.description.current.validity.valid && this.name.current.validity.valid) {\r\n\t\t\tthis.props.addMyVoyage(this.name.current.value, this.description.current.value, this.vegan.current.checked, this.ecolo.current.checked)\r\n\t\t} else alert(\"Please complete the Details section\")\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"formulaire\">\r\n\t\t\t\t<h3>New trip</h3>\r\n\r\n\t\t\t\t<div className=\"partie\">\r\n\t\t\t\t\t<h4>Dtails</h4>\r\n\t\t\t\t\t<div className=\"partiedetails\">\r\n\t\t\t\t\t\t<p className=\"partieLabel\">Trip name:</p>\r\n\t\t\t\t\t\t<input required type=\"text\" ref={this.name} id=\"fname\" name=\"firstname\" placeholder=\"ex. A grand tour of France\"></input>\r\n\r\n\t\t\t\t\t\t<p className=\"partieLabel\">Trip summary:</p>\r\n\t\t\t\t\t\t<textarea required ref={this.description} id=\"lname\" name=\"lastname\" placeholder=\"ex. A bucolic journey through the French countryside: old relics and local specialities\"></textarea>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\r\n\t\t\t\t<div className=\"partie\">\r\n\t\t\t\t\t<h4>Parameters</h4>\r\n\t\t\t\t\t<div className=\"partiedetails\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<input ref={this.vegan} type=\"checkbox\" id=\"voyagevegan\" name=\"voyagevegan\" value=\"newsletter\"></input>\r\n\t\t\t\t\t\t\t<label htmlFor=\"voyagevegan\">Is this trip vegan?</label>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<input ref={this.ecolo} type=\"checkbox\" id=\"voyageecolo\" name=\"voyageecolo\" value=\"newsletter\"></input>\r\n\t\t\t\t\t\t\t<label htmlFor=\"voyageecolo\">Is this trip environmentally friendly?</label>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\r\n\t\t\t\t<button type=\"button\" className=\"boutonsend\" onClick={this.addVoyageCheck.bind(this)}>Add my trip</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default class AddVoyage extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\ttoken: props.token,\r\n\t\t\tstartNewVoyage: true,\r\n\t\t\tchargement: false,\r\n\r\n\t\t\tname: \"\",\r\n\t\t\tdescription: \"\",\r\n\t\t\tvegan: false,\r\n\t\t\tecolo: false\r\n\t\t};\r\n\r\n\t\t//this.renouvelerToken = this.renouvelerToken.bind(this);\r\n\t\tthis.addMyVoyage = this.addMyVoyage.bind(this)\r\n\t}\r\n\r\n\t/*renouvelerToken() {\r\n\t\tvar xhttp = new XMLHttpRequest();\r\n\t\tvar parentToken = this;\r\n\t\txhttp.onreadystatechange = function () {\r\n\t\t\tif (this.readyState === 4 && this.status === 200) {\r\n\t\t\t\tparentToken.state.token = JSON.parse(this.responseText).token;\r\n\t\t\t\tparentToken.props.updateToken(parentToken.state.token);\r\n\t\t\t\tparentToken.addMyVoyage(parentToken.state.name, parentToken.state.description, parentToken.state.vegan, parentToken.state.ecolo);\r\n\t\t\t}\r\n\t\t};\r\n\t\txhttp.open(\"POST\", \"https://wtg.aymerik-diebold.fr/login_check\", true);\r\n\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\txhttp.send(JSON.stringify({\r\n\t\t\t\"username\": \"mailleon@gmail.com\",\r\n\t\t\t\"password\": \"monmdp111A!\"\r\n\t\t}));\r\n\t}*/\r\n\r\n\taddMyVoyage(newname, newdescription, newvegan, newecolo) {\r\n\t\t//console.log(newname, newdescription, newvegan, newecolo);\r\n\t\tthis.setState({\r\n\t\t\tname: newname,\r\n\t\t\tdescription: newdescription,\r\n\t\t\tvegan: newvegan,\r\n\t\t\tecolo: newecolo,\r\n\t\t\tchargement: true\r\n\t\t})\r\n\t\tvar xhttp = new XMLHttpRequest();\r\n\t\tvar parentVoyage = this;\r\n\t\txhttp.onreadystatechange = function () {\r\n\t\t\t//console.log(this.responseText);\r\n\t\t\tif (this.readyState === 4 && this.status === 201) {\r\n\t\t\t\tvar res = JSON.parse(this.responseText);\r\n\t\t\t\tparentVoyage.setState({\r\n\t\t\t\t\tchargement: false,\r\n\t\t\t\t\tstartNewVoyage: false,\r\n\t\t\t\t\tvoyageId: res.id\r\n\t\t\t\t})\r\n\t\t\t} else if (this.readyState === 4 && this.status === 401) {\r\n\t\t\t\talert(\"Connection time out. Please reconnect\");\r\n\t\t\t\t//console.log(parentVoyage.state.token)\r\n\t\t\t\t//parentVoyage.renouvelerToken();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\txhttp.open(\"POST\", \"https://wtg.aymerik-diebold.fr/api/trips\", true);\r\n\t\txhttp.setRequestHeader('Authorization', 'Bearer ' + parentVoyage.state.token);\r\n\t\txhttp.setRequestHeader('Content-Type', 'application/json');\r\n\t\txhttp.send(JSON.stringify({\r\n\t\t\t\"title\": newname,\r\n\t\t\t\"description\": newdescription,\r\n\t\t\t\"vegan\": newvegan,\r\n\t\t\t\"ecological\": newecolo,\r\n\t\t\t\"author\": \"api/users/\" + parentVoyage.props.connected,\r\n\t\t\t\"keywords\": \"paris plage\",\r\n\t\t}));\r\n\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<NavigationBar active={1} token={this.props.token} connected={this.props.connected} connect={this.props.connect} />\r\n\r\n\t\t\t\t{this.state.startNewVoyage ?\r\n\t\t\t\t\t!this.state.chargement ?\r\n\t\t\t\t\t\t<CreationVoyage token={this.state.token} addMyVoyage={this.addMyVoyage.bind(this)} />\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t<ModalChargement />\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<CreationVoyageAjoutEtapes token={this.state.token} voyageId={this.state.voyageId} name={this.state.name} vegan={this.state.vegan} ecolo={this.state.ecolo} description={this.state.description} />\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t);\r\n\r\n\t}\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { Map, TileLayer, Marker, Popup } from \"react-leaflet\";\r\nimport \"./App.css\";\r\nimport NavigationBar from \"./NavigationBar\";\r\n\r\nexport default class ShowCarte extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      voyages: [],\r\n\r\n      lat: 48.856614, // centr sur Paris\r\n      lng: 2.3522219,\r\n      zoom: 2,\r\n    };\r\n\r\n    this.loadTrips(this);\r\n  }\r\n\r\n  loadTrips(parentThis) {\r\n    //let liste = []\r\n    var xhttp = new XMLHttpRequest();\r\n    xhttp.onreadystatechange = function () {\r\n      if (this.readyState === 4 && this.status === 200) {\r\n        parentThis.setState({\r\n          voyages: JSON.parse(this.response)[\"hydra:member\"], // stock all trips\r\n        });\r\n        console.log(JSON.parse(this.response));\r\n      }\r\n    };\r\n    xhttp.open(\"GET\", \"https://wtg.aymerik-diebold.fr/api/trips\", true);\r\n    xhttp.send();\r\n\r\n    /*for (let i = 333; i < 335; i++) {\r\n\t\t\t// delete all\r\n\t\t\tvar xhttp2 = new XMLHttpRequest();\r\n\t\t\txhttp2.onreadystatechange = function () {\r\n\t\t\t\tconsole.log(this.response);\r\n\t\t\t};\r\n\t\t\txhttp2.open(\"DELETE\", \"https://wtg.aymerik-diebold.fr/api/trips/\"+i, true);\r\n\t\t\txhttp2.setRequestHeader('Authorization', 'Bearer ' + this.props.token);\r\n\t\t\txhttp2.setRequestHeader('Content-Type', 'application/json');\r\n\t\t\txhttp2.send();\r\n\t\t}*/\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"App\">\r\n        <NavigationBar\r\n          active={0}\r\n          token={this.props.token}\r\n          connected={this.props.connected}\r\n          connect={this.props.connect}\r\n        />\r\n\r\n        <Map\r\n          id=\"principalMap\"\r\n          center={[this.state.lat, this.state.lng]}\r\n          zoom={this.state.zoom}\r\n        >\r\n          <TileLayer\r\n            attribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n            url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n          />\r\n\r\n          {this.state.voyages.map((voyage) =>\r\n            voyage.stages.map((etape) => (\r\n              <Marker position={[etape.lng, etape.lat]}>\r\n                <Popup>\r\n                  <h1>{voyage.title}</h1>\r\n                  <a href={\"?show=trip&id=\" + voyage.id}>Click here to discover</a>\r\n                </Popup>\r\n              </Marker>\r\n            ))\r\n          )}\r\n        </Map>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport NavigationBar from \"./NavigationBar\";\r\nimport Axios from \"axios\";\r\n\r\nexport class Profile extends Component {\r\n  state = {\r\n    email: \"\",\r\n    firstname: \"\",\r\n    lastname: \"\",\r\n    id: \"\",\r\n    trips: [],\r\n    recordedTrips: [],\r\n  };\r\n\r\n  getUserInfo = () => {\r\n    // GET /api/me\r\n    Axios.get(\"https://wtg.aymerik-diebold.fr/api/me\", {\r\n      headers: { Authorization: \"Bearer \" + this.props.token },\r\n    })\r\n      .then((res) => {\r\n        console.log(res);\r\n        this.setState({\r\n          email: res.data.email,\r\n          firstname: res.data.firstName,\r\n          lastname: res.data.lastName,\r\n          id: res.data.id,\r\n          trips: res.data.trips,\r\n          recordedTrips: res.data.recordedTrips,\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"Not connected\");\r\n        throw err;\r\n      });\r\n  };\r\n\r\n  getTrips = () => {\r\n    // GET /trips\r\n    console.log(\"get trips\");\r\n    console.log(this.state.trips);\r\n    for (let i = 0; i < this.state.trips.length; i++) {\r\n      Axios.get(\r\n        \"https://wtg.aymerik-diebold.fr/api/trips/\" +\r\n          this.state.trips[i].split(\"/\")[3]\r\n      )\r\n        .then((res) => {\r\n          console.log(res);\r\n          this.setState({\r\n            tripTitles: [\r\n              ...this.state.tripTitles,\r\n              { id: res.data.id, title: res.data.title },\r\n            ],\r\n          });\r\n        })\r\n        .catch((err) => {\r\n          throw err;\r\n        });\r\n    }\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.getUserInfo();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"profile\">\r\n        <NavigationBar\r\n          active=\"4\"\r\n          connected={this.props.connected}\r\n          connect={this.props.connect}\r\n        />\r\n        {this.props.connected ? (\r\n          <div className=\"profileContainer\" style={containerStyle}>\r\n            <h1>My Profile</h1>\r\n            <h3 style={{ backgroundColor: \"inherit\" }}>Personal Info</h3>\r\n            <div className=\"profileBox\" style={boxStyle}>\r\n              <div>\r\n                <p>Email</p>\r\n                <p>Firstname</p>\r\n                <p>Lastname</p>\r\n              </div>\r\n              <div>\r\n                <p>{this.state.email}</p>\r\n                <p>{this.state.firstname}</p>\r\n                <p>{this.state.lastname}</p>\r\n              </div>\r\n            </div>\r\n            <div style={trips}>\r\n              <div className=\"my-trips\">\r\n                <h3 style={{ backgroundColor: \"inherit\" }}>My trips</h3>\r\n                {this.state.trips.map((trip) => (\r\n                  <p>\r\n                    <a href={\"?show=trip&id=\" + trip.id}>{trip.title}</a>\r\n                  </p>\r\n                ))}\r\n                <a href=\"?show=save\" style={{ color: \"red\" }}>\r\n                  Add trip!\r\n                </a>\r\n              </div>\r\n              <div className=\"recorded-trips\">\r\n                <h3 style={{ backgroundColor: \"inherit\" }}>Favorite trips</h3>\r\n                {this.state.recordedTrips.length !== 0 ? (\r\n                  this.state.recordedTrips.map((trip) => (\r\n                    <p>\r\n                      <a href={\"?show=trip&id=\" + trip.id}>{trip.title}</a>\r\n                    </p>\r\n                  ))\r\n                ) : (\r\n                  <p>\r\n                    You don't have any favorite trip :(\r\n                    <a href=\"/WaysToGo\" style={{ display: \"block\" }}>\r\n                      Browse trips to save your favorite!\r\n                    </a>\r\n                  </p>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <p>Please log in</p>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst containerStyle = {\r\n  textAlign: \"center\",\r\n  backgroundColor: \"#f3f3f3\",\r\n  width: \"50%\",\r\n  margin: \"auto\",\r\n};\r\n\r\nconst boxStyle = {\r\n  display: \"flex\",\r\n  justifyContent: \"space-around\",\r\n};\r\n\r\nconst trips = {\r\n  display: \"flex\",\r\n  justifyContent: \"space-around\",\r\n};\r\n\r\nexport default Profile;\r\n","import React, { Component } from \"react\";\r\n//import ReactDom from 'react-dom'\r\n//import ObjectList from 'react-object-list'\r\n//import { List } from 'react-object-list/renderers'\r\nimport \"./App.css\";\r\nimport NavigationBar from './NavigationBar';\r\n\r\n\r\n\r\nclass SearchForm extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            city: props.city,\r\n            title: props.title,\r\n            keyword: props.keyword,\r\n            chercher: props.chercher,\r\n            vegan: props.vegan,\r\n            ecolo: props.ecolo,\r\n        };\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div class=\"formulaire\">\r\n\r\n                <div class=\"partiedetails\">\r\n                    <p class=\"partieLabel\">Title:</p>\r\n                    <input required type=\"text\" ref={this.state.title} id=\"title\" name=\"title\" placeholder=\"\"></input>\r\n                </div>\r\n\r\n                <div class=\"partiedetails\">\r\n                    <p class=\"partieLabel\">Keyword:</p>\r\n                    <input required type=\"text\" ref={this.state.keyword} id=\"keyword\" name=\"keyword\" placeholder=\"ex. Paris\"></input>\r\n                </div>\r\n\r\n                <div class=\"partiedetails\">\r\n                    <p class=\"partieLabel\">City:</p>\r\n                    <input required type=\"text\" ref={this.state.city} id=\"rcity\" name=\"city\" placeholder=\"ex. Rome\"></input>\r\n                </div>\r\n\r\n                <div class=\"partiedetails\">\r\n                    <div>\r\n                        <input ref={this.state.vegan} type=\"checkbox\" id=\"voyagevegan\" name=\"voyagevegan\" value=\"newsletter\"></input>\r\n                        <label htmlFor=\"voyagevegan\">Vegan?</label>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <input ref={this.state.ecolo} type=\"checkbox\" id=\"voyageecolo\" name=\"voyageecolo\" value=\"newsletter\"></input>\r\n                        <label htmlFor=\"voyageecolo\">Environmentally friendly?</label>\r\n                    </div>\r\n                </div>\r\n\r\n                <button type=\"button\" class=\"boutonsend\" onClick={this.state.chercher}>Chercher</button>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nclass ResultList extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            city: props.city,\r\n            keyword: props.keyword,\r\n            title: props.title,\r\n            vegan: props.vegan,\r\n            ecolo: props.ecolo,\r\n            voyages: [],\r\n        };\r\n        this.loadDoc(this);\r\n    }\r\n\r\n    loadDoc(parentThis) {\r\n        var xhttp = new XMLHttpRequest();\r\n        xhttp.onreadystatechange = function () {\r\n            if (this.readyState === 4 && this.status === 200) {\r\n                parentThis.setState({\r\n                    voyages: JSON.parse(this.response)['hydra:member'],\r\n                });\r\n                //console.log(parentThis.state.voyages);\r\n            }\r\n        };\r\n        \r\n        var url = \"https://wtg.aymerik-diebold.fr/api/trips?\";\r\n        var firstParam = true;\r\n        if (parentThis.state.title.length > 0) {\r\n            url = url.concat(\"title=\", parentThis.state.title);\r\n            firstParam = false;\r\n        };\r\n        if (parentThis.state.keyword.length > 0) {\r\n            if (!firstParam) {\r\n                url = url.concat(\"&\");\r\n            };\r\n            url = url.concat(\"keywords=\", parentThis.state.keyword);\r\n            firstParam = false;\r\n        };\r\n        if (parentThis.state.city.length > 0) {\r\n            if (!firstParam) {\r\n                url = url.concat(\"&\");\r\n            };\r\n            url = url.concat(\"stages.city=\", parentThis.state.city);\r\n            firstParam = false;\r\n        };\r\n\r\n        if (parentThis.state.vegan) {\r\n            console.log(parentThis.state.vegan, firstParam);\r\n            if (!firstParam) {\r\n                url = url.concat(\"&\");\r\n            };\r\n            url = url.concat(\"vegan=true\");\r\n            firstParam = false;\r\n        };\r\n\r\n        if (parentThis.state.ecolo) {\r\n            if (!firstParam) {\r\n                url = url.concat(\"&\");\r\n            };\r\n            url = url.concat(\"ecological=true\");\r\n        };\r\n\r\n        console.log(url)\r\n        xhttp.open(\"GET\",url, true);\r\n        xhttp.send();\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <div id=\"recherche\">\r\n                    <h4> Results of\r\n                    <ul>\r\n                            <li>Title: \"{this.state.title}\" </li>\r\n                            <li>Keyword: \"{this.state.keyword}\" </li>\r\n                            <li>City: \"{this.state.city}\" </li>\r\n                            <li>Vegan: \"{this.state.vegan ? 'True' : ''}\" </li>\r\n                            <li>Ecological: \"{this.state.ecolo ? 'True' : ''}\" </li>\r\n                        </ul>\r\n                    </h4>\r\n                </div>\r\n\r\n                <div id='table'>\r\n                    \r\n                    {this.state.voyages.length > 0 ? (\r\n                        <table>\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Title</th>\r\n                                    <th>Author</th>\r\n                                    <th>Description</th>\r\n                                    <th>Lien</th>\r\n                                </tr>\r\n                            </thead>\r\n\r\n                            <tbody>\r\n                                {this.state.voyages.map((voyage) => (\r\n                                    <tr>\r\n                                        <td>{voyage.title}</td>\r\n                                        <td>{voyage.author.firstName} {voyage.author.lastNqme}</td>\r\n                                        <td>{voyage.description}</td>\r\n                                        <td><a href={\"?show=trip&id=\" + voyage.id}>Cliquez</a></td>\r\n                                    </tr>\r\n\r\n                                ))}\r\n                            </tbody>\r\n                        </table>) : (\r\n                            <div>\r\n                                <p>Not found</p>\r\n                                <a href=\"?show=research\">Return</a>\r\n                            </div>)\r\n                    }\r\n                        \r\n\r\n                    \r\n                </div>\r\n\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n\r\nexport default class SearchResult extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            id: props.id,\r\n            startNewSearch: true,\r\n            vegan: false,\r\n            ecolo: false,\r\n            toRender: <h1>Chargement en cours...</h1>\r\n        };\r\n\r\n        this.city = React.createRef();\r\n        this.title = React.createRef();\r\n        this.keyword = React.createRef();\r\n        this.vegan = React.createRef();\r\n        this.ecolo = React.createRef();\r\n\r\n        // Cette liaison est ncssaire afin de permettre l'utilisation de `this` dans la fonction de rappel.\r\n        this.chercher = this.chercher.bind(this);\r\n    }\r\n\r\n    chercher() {\r\n        if (this.city.current.validity.valid || this.title.current.validity.valid ||\r\n            this.keyword.current.validity.valid) {\r\n            this.setState({\r\n                city: this.city.current.value,\r\n                keyword: this.keyword.current.value,\r\n                title: this.title.current.value,\r\n                vegan: this.vegan.current.checked,\r\n                ecolo: this.ecolo.current.checked,\r\n                startNewSearch: false,\r\n            });\r\n        }\r\n        else alert(\"Veillez completer au moins un champ pour chercher\")\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <NavigationBar active=\"5\" />\r\n\r\n                {this.state.startNewSearch ?\r\n                    <SearchForm city={this.city} title={this.title} keyword={this.keyword} vegan={this.vegan} ecolo={this.ecolo} chercher={this.chercher} />\r\n                    :\r\n                    <ResultList city={this.city.current.value} title={this.title.current.value} keyword={this.keyword.current.value} vegan={this.vegan.current.checked} ecolo={this.ecolo.current.checked} />\r\n\r\n                }\r\n            </div>\r\n        );\r\n\r\n    }\r\n}","import React, { Component } from \"react\";\r\nimport \"./App.css\";\r\nimport NavigationBar from \"./NavigationBar\";\r\n\r\nexport default class About extends Component {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<NavigationBar\r\n\t\t\t\t\tactive={3}\r\n\t\t\t\t\ttoken={this.props.token}\r\n\t\t\t\t\tconnected={this.props.connected}\r\n\t\t\t\t\tconnect={this.props.connect}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t<h2>WaysToGo</h2>\r\n\t\t\t\t<h3>Explore. Share. Discover.</h3>\r\n\t\t\t\t<p>WaysToGo allows you to share your trips to everyone. <br></br>Search new trips, begin new adventures :)</p>\r\n\t\t\t\t<p>Founded by Caroline Texier and Arnaud Stoffel</p>\r\n\t\t\t\t<p>Developed by Aymerik Diebold, Jiacheng Zhou, Lon Davidovski, Youssef El Saadany with &#x2665;</p>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React, { Component } from \"react\";\r\nimport Cookies from \"universal-cookie\";\r\nimport \"./App.css\";\r\nimport ShowVoyage from \"./ShowVoyage.js\";\r\nimport AddVoyage from \"./AddVoyage.js\";\r\nimport ShowCarte from \"./ShowCarte.js\";\r\nimport Profile from \"./Profile\";\r\nimport SearchResult from \"./SearchResult.js\";\r\nimport About from \"./About.js\";\r\nimport Axios from \"axios\";\r\n\r\nexport default class App extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tconst cookies = new Cookies();\r\n\t\tconst urlParams = new URLSearchParams(window.location.search);\r\n\t\tlet token = cookies.get(\"token\") ? cookies.get(\"token\") : false;\r\n\r\n\t\tif (urlParams.get(\"logout\")) {\r\n\t\t\tthis.disconnect();\r\n\t\t\ttoken = false;\r\n\t\t}\r\n\r\n\t\tthis.state = {\r\n\t\t\tpageActuelle: urlParams.get(\"show\"), // on recupere la page a afficher via les arguments de l'URL\r\n\t\t\ttrip: urlParams.get(\"id\"),\r\n\t\t\tconnected: token ? true : false,\r\n\t\t\ttoken: token ? token : \"\",\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tif (this.state.token) {\r\n\t\t\tconsole.log(\"Connected!\");\r\n\t\t\tAxios.get(\"https://wtg.aymerik-diebold.fr/api/me\", {\r\n\t\t\t\theaders: { Authorization: \"Bearer \" + this.state.token },\r\n\t\t\t})\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tthis.setState({ connected: res.data.id });\r\n\t\t\t\t\t//console.log(document.cookie);\r\n\t\t\t\t})\r\n\t\t\t\t.catch((err) => {\r\n\t\t\t\t\tconsole.log(\"wut\");\r\n\t\t\t\t\tconsole.log(this.state.token);\r\n\t\t\t\t\tthis.setState({ connected: false, token: \"\" });\r\n\t\t\t\t\tconst cookies = new Cookies();\r\n\t\t\t\t\tcookies.remove(\"token\", { path: \"/\" });\r\n\t\t\t\t\tthrow err;\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tconnect = (token) => {\r\n\t\tconsole.log(\"Connected!\");\r\n\t\tthis.setState({ connected: true, token });\r\n\t\tconst cookies = new Cookies();\r\n\t\tcookies.set(\"token\", token, { path: \"/\" });\r\n\t};\r\n\r\n\tdisconnect = () => {\r\n\t\tconst cookies = new Cookies();\r\n\t\tcookies.remove(\"token\", { path: \"/\" });\r\n\t\tthis.setState({ connected: false, token: \"\" });\r\n\t\tconsole.log(\"Disconnected\");\r\n\t};\r\n\r\n\trender() {\r\n\t\tif (this.state.pageActuelle === \"trip\") {\r\n\t\t\treturn (\r\n\t\t\t\t<ShowVoyage\r\n\t\t\t\t\tid={this.state.trip}\r\n\t\t\t\t\tconnected={this.state.connected}\r\n\t\t\t\t\tconnect={this.connect}\r\n\t\t\t\t\ttoken={this.state.token}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t} else if (this.state.pageActuelle === \"save\") {\r\n\t\t\treturn (\r\n\t\t\t\t<AddVoyage\r\n\t\t\t\t\ttoken={this.state.token}\r\n\t\t\t\t\tconnected={this.state.connected}\r\n\t\t\t\t\tconnect={this.connect}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t} else if (this.state.pageActuelle === \"profile\") {\r\n\t\t\treturn (\r\n\t\t\t\t<Profile\r\n\t\t\t\t\tconnected={this.state.connected}\r\n\t\t\t\t\ttoken={this.state.token}\r\n\t\t\t\t\tconnect={this.connect}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t} else if (this.state.pageActuelle === \"research\") {\r\n\t\t\treturn <SearchResult />;\r\n\t\t} else if (this.state.pageActuelle === \"about\") {\r\n\t\t\treturn (\r\n\t\t\t\t<About\r\n\t\t\t\t\ttoken={this.state.token}\r\n\t\t\t\t\tconnected={this.state.connected}\r\n\t\t\t\t\tconnect={this.connect}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\t<ShowCarte connected={this.state.connected} connect={this.connect} />\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}